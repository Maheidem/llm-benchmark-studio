import{u as d,p as h,o as _,c as s,d as l,t as f,i as m,j as k,C as p,r as b,q as v,a as y,b as n,k as g}from"./index-DJOpZm09.js";const x={class:"min-h-screen flex items-center justify-center",style:{background:"var(--bg-base, #09090b)"}},w={class:"text-center"},A={key:0,class:"modal-box",style:{"max-width":"380px",width:"100%"}},S={class:"error-banner mb-4"},B={key:1,class:"text-zinc-400 text-sm"},q={__name:"OAuthCallback",setup(C){const r=p(),c=v(),i=d(),u=h(),e=b("");return _(async()=>{const o=r.query.token,t=r.query.error;if(t){e.value=`Google login failed: ${t.replace(/_/g," ")}`;return}if(!o){e.value="Authentication failed: no token received.";return}try{i.setTokensFromOAuth(o),await i.fetchUser(),u.connect();try{const a=await fetch("/api/onboarding/status",{headers:{Authorization:"Bearer "+o}});if(a.ok&&!(await a.json()).completed){c.replace("/benchmark");return}}catch{}c.replace("/benchmark")}catch{e.value="Authentication failed. Please try again."}}),(o,t)=>{const a=y("router-link");return n(),s("div",x,[l("div",w,[e.value?(n(),s("div",A,[l("div",S,f(e.value),1),m(a,{to:"/login",class:"modal-btn modal-btn-confirm block w-full text-center"},{default:k(()=>[...t[0]||(t[0]=[g(" Back to login ",-1)])]),_:1})])):(n(),s("div",B," Signing you in... "))])])}}};export{q as default};

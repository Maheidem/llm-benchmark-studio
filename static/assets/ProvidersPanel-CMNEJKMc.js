import{Q as E,r as S,w as R,b as a,c as r,d as e,t as b,h as k,v as g,F as U,A as O,f as P,k as K,l as B,s as M,M as q,K as J,P as Q,y as L,e as Y,B as N,D as W,a3 as X,g as Z,a0 as G,o as H,i as ee}from"./index-DPrAhrhg.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as te}from"./useDirectBenchmark-B2Eo7wpQ.js";const oe={class:"px-5 py-4"},se={class:"flex items-center justify-between mb-4"},le={class:"flex items-center gap-3"},ie={class:"text-[13px] font-medium text-zinc-200 font-body"},ne={class:"text-[9px] font-mono text-zinc-700"},de={class:"flex gap-2"},ae={key:0},re={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},pe={id:"dl-model-edit"},ue=["value"],ce={class:"flex gap-1.5 mt-2 flex-wrap"},me=["onClick"],ve={class:"mt-3"},_e={key:0,class:"text-[10px] text-zinc-700 font-body"},ye=["onClick"],fe={class:"mt-3"},xe={class:"space-y-1"},be={key:0,class:"text-[10px] text-zinc-700 font-body"},ke={class:"text-[10px] font-mono text-zinc-500"},ge=["onUpdate:modelValue"],we=["onClick"],he={class:"mt-4 pt-3",style:{"border-top":"1px solid var(--border-subtle)"}},$e={__name:"ModelCardSettings",props:{model:{type:Object,required:!0},providerKey:{type:String,required:!0},prefix:{type:String,default:""},discoveredModels:{type:Array,default:()=>[]}},emits:["save","delete"],setup(_,{emit:h}){const f=[4096,8192,16384,32768,65536,131072,2e5],u=["4K","8K","16K","32K","64K","128K","200K"],D=new Set(["model_id","display_name","context_window","max_output_tokens","skip_params","input_cost_per_mtok","output_cost_per_mtok","system_prompt"]),d=_,y=h,{showToast:n}=J(),{inputModal:w,multiFieldModal:z}=q(),F=S(!1),$=S(""),C=S(!0),s=E({model_id:d.model.model_id,display_name:d.model.display_name,context_window:d.model.context_window||128e3,max_output_tokens:d.model.max_output_tokens||null,input_cost_per_mtok:d.model.input_cost_per_mtok??null,output_cost_per_mtok:d.model.output_cost_per_mtok??null,skip_params:[...d.model.skip_params||[]],system_prompt:d.model.system_prompt||""}),c=S(Object.entries(d.model).filter(([t])=>!D.has(t)).map(([t,o])=>({key:t,value:o})));R(()=>d.model,t=>{s.model_id=t.model_id,s.display_name=t.display_name,s.context_window=t.context_window||128e3,s.max_output_tokens=t.max_output_tokens||null,s.input_cost_per_mtok=t.input_cost_per_mtok??null,s.output_cost_per_mtok=t.output_cost_per_mtok??null,s.skip_params=[...t.skip_params||[]],s.system_prompt=t.system_prompt||"",c.value=Object.entries(t).filter(([o])=>!D.has(o)).map(([o,i])=>({key:o,value:i}))},{deep:!0});async function T(){const t={};c.value.forEach(I=>{t[I.key]=I.value});const o={};s.input_cost_per_mtok!=null&&s.input_cost_per_mtok!==""&&(o.input_cost_per_mtok=parseFloat(s.input_cost_per_mtok)),s.output_cost_per_mtok!=null&&s.output_cost_per_mtok!==""&&(o.output_cost_per_mtok=parseFloat(s.output_cost_per_mtok));const i={provider_key:d.providerKey,model_id:d.model.model_id,new_model_id:s.model_id||d.model.model_id,display_name:s.display_name||"",context_window:parseInt(s.context_window)||null,max_output_tokens:parseInt(s.max_output_tokens)||null,skip_params:s.skip_params,system_prompt:s.system_prompt||null},v={...t,...o};Object.keys(v).length&&(i.custom_fields=v);try{const I=await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(I.ok)$.value="Saved",C.value=!0,setTimeout(()=>{$.value=""},3e3),y("save");else{const j=await I.json();$.value=j.error||"Save failed",C.value=!1}}catch{$.value="Network error",C.value=!1}}async function A(){const t=await w("Add Skip Param","Parameter name (e.g., temperature)"),o=typeof t=="object"?t==null?void 0:t.value:t;!o||!o.trim()||(s.skip_params.includes(o.trim())||s.skip_params.push(o.trim()),await p())}function x(t){s.skip_params=s.skip_params.filter(o=>o!==t),p()}async function p(){try{await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:d.providerKey,model_id:d.model.model_id,skip_params:s.skip_params})}),y("save")}catch{n("Failed to save skip params","error")}}async function m(){var v;const t=await z("Add Custom Field",[{key:"name",label:"Field Name",placeholder:"e.g., pricing_tier"},{key:"value",label:"Value",placeholder:"e.g., standard"}]);if(!t)return;const o=(v=t.name)==null?void 0:v.trim(),i=t.value;if(o){c.value.push({key:o,value:i});try{await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:d.providerKey,model_id:d.model.model_id,custom_fields:{[o]:i}})}),y("save")}catch{n("Failed to add field","error")}}}async function l(t){c.value=c.value.filter(o=>o.key!==t);try{await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:d.providerKey,model_id:d.model.model_id,custom_fields:{[t]:null}})}),y("save")}catch{n("Failed to remove field","error")}}return(t,o)=>(a(),r("div",oe,[e("div",se,[e("div",le,[e("div",ie,b(s.display_name||_.model.display_name),1),e("span",ne,b(_.model.model_id),1)]),e("div",de,[e("button",{onClick:o[0]||(o[0]=i=>F.value=!F.value),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 transition-colors"},b(F.value?"Collapse":"Edit"),1),e("button",{onClick:T,class:"lime-btn"},"Save"),e("button",{onClick:o[1]||(o[1]=i=>t.$emit("delete",_.model)),class:"text-[11px] font-display tracking-wider uppercase px-2 py-1.5 rounded-sm text-zinc-600 hover:text-red-400 transition-colors",style:{border:"1px solid var(--border-subtle)"}},"×")])]),F.value?(a(),r("div",ae,[e("div",re,[e("div",null,[o[10]||(o[10]=e("label",{class:"field-label"},"Model ID",-1)),k(e("input",{"onUpdate:modelValue":o[2]||(o[2]=i=>s.model_id=i),class:"settings-input",list:"dl-model-edit",onFocus:o[3]||(o[3]=i=>{var v,I;return(I=(v=t.$parent)==null?void 0:v.$emit)==null?void 0:I.call(v,"loadDiscovery",_.providerKey)})},null,544),[[g,s.model_id]]),e("datalist",pe,[(a(!0),r(U,null,O(_.discoveredModels,i=>(a(),r("option",{key:i.id,value:i.id},b(i.display_name),9,ue))),128))])]),e("div",null,[o[11]||(o[11]=e("label",{class:"field-label"},"Display Name",-1)),k(e("input",{"onUpdate:modelValue":o[4]||(o[4]=i=>s.display_name=i),class:"settings-input"},null,512),[[g,s.display_name]])]),e("div",null,[o[12]||(o[12]=e("label",{class:"field-label"},"Context Window",-1)),k(e("input",{"onUpdate:modelValue":o[5]||(o[5]=i=>s.context_window=i),type:"number",class:"settings-input"},null,512),[[g,s.context_window,void 0,{number:!0}]]),e("div",ce,[(a(),r(U,null,O(f,(i,v)=>e("button",{key:i,onClick:I=>s.context_window=i,class:"text-[9px] font-mono px-2 py-0.5 rounded-sm text-zinc-600 hover:text-zinc-400 transition-colors",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)"}},b(u[v]),9,me)),64))])]),e("div",null,[o[13]||(o[13]=e("label",{class:"field-label"},"Max Output Tokens",-1)),k(e("input",{"onUpdate:modelValue":o[6]||(o[6]=i=>s.max_output_tokens=i),type:"number",placeholder:"Default",class:"settings-input"},null,512),[[g,s.max_output_tokens,void 0,{number:!0}]])]),e("div",null,[o[14]||(o[14]=e("label",{class:"field-label"},"Input $/1M tokens",-1)),k(e("input",{"onUpdate:modelValue":o[7]||(o[7]=i=>s.input_cost_per_mtok=i),type:"number",step:"0.001",placeholder:"e.g. 2.00",class:"settings-input"},null,512),[[g,s.input_cost_per_mtok,void 0,{number:!0}]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"field-label"},"Output $/1M tokens",-1)),k(e("input",{"onUpdate:modelValue":o[8]||(o[8]=i=>s.output_cost_per_mtok=i),type:"number",step:"0.001",placeholder:"e.g. 8.00",class:"settings-input"},null,512),[[g,s.output_cost_per_mtok,void 0,{number:!0}]])])]),e("div",ve,[o[16]||(o[16]=e("span",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase"},"Skip Params: ",-1)),s.skip_params.length===0?(a(),r("span",_e,"none")):P("",!0),(a(!0),r(U,null,O(s.skip_params,i=>(a(),r("span",{key:i,class:"text-[10px] font-mono text-zinc-400 px-1.5 py-0.5 rounded-sm inline-flex items-center gap-1 mr-1",style:{background:"rgba(255,255,255,0.04)"}},[K(b(i)+" ",1),e("button",{onClick:v=>x(i),class:"text-zinc-600 hover:text-red-400"},"×",8,ye)]))),128)),e("button",{onClick:A,class:"text-[10px] font-mono text-zinc-500 hover:text-zinc-300 ml-2 px-1.5 py-0.5 rounded-sm",style:{border:"1px solid var(--border-subtle)"}},"+ add")]),e("div",fe,[o[17]||(o[17]=e("span",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Custom Fields",-1)),e("div",xe,[c.value.length===0?(a(),r("div",be,"none")):P("",!0),(a(!0),r(U,null,O(c.value,i=>(a(),r("div",{key:i.key,class:"flex items-center gap-2"},[e("span",ke,b(i.key)+":",1),k(e("input",{"onUpdate:modelValue":v=>i.value=v,class:"px-2 py-1 rounded-sm text-[11px] font-mono text-zinc-300 flex-1",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,8,ge),[[g,i.value]]),e("button",{onClick:v=>l(i.key),class:"text-zinc-600 hover:text-red-400 text-xs"},"×",8,we)]))),128))]),e("button",{onClick:m,class:"text-[10px] font-mono text-zinc-500 hover:text-zinc-300 mt-1 px-1.5 py-0.5 rounded-sm",style:{border:"1px solid var(--border-subtle)"}},"+ add field")]),e("div",he,[o[18]||(o[18]=e("label",{class:"field-label"},"System Prompt",-1)),o[19]||(o[19]=e("p",{class:"text-[10px] text-zinc-700 font-body mb-2"},"Custom system prompt prepended to all benchmarks and evals for this model. Leave empty for default behavior.",-1)),k(e("textarea",{"onUpdate:modelValue":o[9]||(o[9]=i=>s.system_prompt=i),rows:"3",class:"w-full px-3 py-2 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none",resize:"vertical"},placeholder:"e.g. You are a helpful assistant. Always respond in JSON format."},null,512),[[g,s.system_prompt]])])])):P("",!0),$.value?(a(),r("div",{key:1,class:"mt-2 text-[11px] font-body",style:B(`color:${C.value?"var(--lime)":"var(--coral)"}`)},b($.value),5)):P("",!0)]))}},Ce=V($e,[["__scopeId","data-v-051ba591"]]),Se={class:"card rounded-md overflow-hidden"},ze={class:"px-5 py-3 flex items-center justify-between",style:{"border-bottom":"1px solid var(--border-subtle)"}},Pe={class:"flex items-center gap-3"},De={class:"text-zinc-600 text-xs font-body"},Me={class:"text-[9px] font-mono text-zinc-700"},Fe={key:0,class:"text-[9px] font-mono px-1.5 py-0.5 rounded-sm",style:{background:"rgba(56,189,248,0.08)",color:"#38BDF8",border:"1px solid rgba(56,189,248,0.2)"}},Ie={class:"flex gap-2"},Ae={key:0,class:"px-5 py-3",style:{"border-bottom":"1px solid var(--border-subtle)",background:"rgba(191,255,0,0.02)"}},Te={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-2"},Ue={key:0,class:"mb-2"},Oe={class:"flex items-center gap-2 cursor-pointer"},Ne={class:"flex items-center gap-3"},je={class:"divide-y",style:{"border-color":"var(--border-subtle)"}},Ve={class:"px-5 py-3",style:{"border-top":"1px solid var(--border-subtle)"}},Ke={key:0,class:"mt-3"},Ee={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-2"},Le={class:"flex items-center gap-0"},Be={key:0,class:"text-[11px] font-mono px-2 py-2 rounded-l-sm flex-shrink-0",style:{background:"rgba(56,189,248,0.08)",color:"#38BDF8",border:"1px solid rgba(56,189,248,0.2)","border-right":"none"}},Je=["placeholder"],Re={id:"dl-add-model"},qe=["value"],Ye={__name:"ProviderCard",props:{provider:{type:Object,required:!0},discoveredModels:{type:Array,default:()=>[]}},emits:["refresh","delete","deleteModel","fetch","loadDiscovery"],setup(_,{emit:h}){const f=_,u=h,{showToast:D}=J(),d=N(()=>f.provider.models||[]),y=N(()=>W(f.provider.display_name)),n=N(()=>{const l=f.provider.model_id_prefix;return l||$(d.value)}),{supportsDirectLocalAccess:w,isLocalProvider:z}=te(),F=N(()=>w()&&z(f.provider));function $(l){if(!l||l.length===0)return"";const t=l.map(v=>v.model_id||v.id||""),o=t[0].indexOf("/");if(o<1)return"";const i=t[0].substring(0,o);return t.every(v=>v.startsWith(i+"/"))?i:""}const C=S(!1),s=E({display_name:f.provider.display_name,model_id_prefix:f.provider.model_id_prefix||"",api_base:f.provider.api_base||"",api_key_env:f.provider.api_key_env||"",direct_local:f.provider.direct_local||!1}),c=S(null);R(()=>f.provider,l=>{s.display_name=l.display_name,s.model_id_prefix=l.model_id_prefix||"",s.api_base=l.api_base||"",s.api_key_env=l.api_key_env||"",s.direct_local=l.direct_local||!1},{deep:!0});async function T(){try{const l=await M("/api/config/provider",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:f.provider.provider_key,display_name:s.display_name,api_base:s.api_base,api_key_env:s.api_key_env,model_id_prefix:s.model_id_prefix,direct_local:s.direct_local})});if(l.ok)c.value={ok:!0,msg:"Saved"},setTimeout(()=>{c.value=null},3e3),u("refresh");else{const t=await l.json();c.value={ok:!1,msg:t.error||"Failed"}}}catch{c.value={ok:!1,msg:"Network error"}}}const A=S(!1),x=E({id:"",display_name:"",context_window:128e3});function p(){if(!x.display_name){const t=x.id;x.display_name=t.includes("/")?t.split("/").pop():t}const l=f.discoveredModels.find(t=>t.id===x.id);l&&(x.display_name=l.display_name)}async function m(){const l=x.id.trim();if(l)try{const t=await M("/api/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:f.provider.provider_key,id:l,display_name:x.display_name.trim()||"",context_window:x.context_window||128e3})});if(t.ok)x.id="",x.display_name="",x.context_window=128e3,A.value=!1,u("refresh");else{const o=await t.json();D(o.error||"Failed to add model","error")}}catch{D("Network error","error")}}return(l,t)=>(a(),r("div",Se,[e("div",ze,[e("div",Pe,[e("span",{class:"badge",style:B(`background:${y.value.bg};color:${y.value.text};border:1px solid ${y.value.border}`)},b(_.provider.display_name),5),e("span",De,b(d.value.length)+" model"+b(d.value.length!==1?"s":""),1),e("span",Me,b(_.provider.provider_key),1),n.value?(a(),r("span",Fe,"prefix: "+b(n.value)+"/",1)):P("",!0)]),e("div",Ie,[e("button",{onClick:t[0]||(t[0]=o=>l.$emit("fetch",_.provider.provider_key)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 transition-colors"},"Fetch"),e("button",{onClick:t[1]||(t[1]=o=>C.value=!C.value),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 transition-colors"},"Edit"),e("button",{onClick:t[2]||(t[2]=o=>l.$emit("delete",_.provider)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 hover:text-red-400 transition-colors"},"Del")])]),C.value?(a(),r("div",Ae,[e("div",Te,[e("div",null,[t[15]||(t[15]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Display Name",-1)),k(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.display_name=o),class:"settings-input"},null,512),[[g,s.display_name]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Model ID Prefix",-1)),k(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.model_id_prefix=o),placeholder:"Optional",class:"settings-input"},null,512),[[g,s.model_id_prefix]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"API Base",-1)),k(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>s.api_base=o),placeholder:"https://...",class:"settings-input"},null,512),[[g,s.api_base]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"API Key Name",-1)),k(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>s.api_key_env=o),placeholder:"e.g. OPENAI_API_KEY",class:"settings-input"},null,512),[[g,s.api_key_env]])])]),F.value?(a(),r("div",Ue,[e("label",Oe,[k(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=o=>s.direct_local=o),class:"accent-[#BFFF00]"},null,512),[[Q,s.direct_local]]),t[19]||(t[19]=e("span",{class:"text-[11px] text-zinc-400 font-body"}," Direct Local Access — Benchmark from browser (skip server hop) ",-1))]),t[20]||(t[20]=e("p",{class:"text-[10px] text-zinc-600 mt-1 ml-5 font-body"}," Requires CORS enabled in LM Studio: Developer > Local Server > Enable CORS ",-1))])):P("",!0),e("div",Ne,[e("button",{onClick:T,class:"lime-btn"},"Save Provider"),c.value?(a(),r("span",{key:0,class:"text-[11px] font-body",style:B(`color:${c.value.ok?"var(--lime)":"var(--coral)"}`)},b(c.value.msg),5)):P("",!0)])])):P("",!0),e("div",je,[(a(!0),r(U,null,O(d.value,o=>(a(),L(Ce,{key:o.model_id,model:o,"provider-key":_.provider.provider_key,prefix:n.value,"discovered-models":_.discoveredModels,onSave:t[8]||(t[8]=i=>l.$emit("refresh")),onDelete:t[9]||(t[9]=i=>l.$emit("deleteModel",{providerKey:_.provider.provider_key,model:i}))},null,8,["model","provider-key","prefix","discovered-models"]))),128))]),e("div",Ve,[e("button",{onClick:t[10]||(t[10]=o=>A.value=!A.value),class:"lime-btn"},"+ Add Model"),A.value?(a(),r("div",Ke,[e("div",Ee,[e("div",null,[t[21]||(t[21]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Model ID",-1)),e("div",Le,[n.value?(a(),r("span",Be,b(n.value)+"/",1)):P("",!0),k(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>x.id=o),placeholder:n.value?"model-name":"provider/model-name",class:Y(["settings-input",n.value?"rounded-l-none":""]),list:"dl-add-model",onFocus:t[12]||(t[12]=o=>l.$emit("loadDiscovery",_.provider.provider_key)),onInput:p},null,42,Je),[[g,x.id]]),e("datalist",Re,[(a(!0),r(U,null,O(_.discoveredModels,o=>(a(),r("option",{key:o.id,value:o.id},b(o.display_name),9,qe))),128))])])]),e("div",null,[t[22]||(t[22]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Display Name",-1)),k(e("input",{"onUpdate:modelValue":t[13]||(t[13]=o=>x.display_name=o),placeholder:"Auto from ID",class:"settings-input"},null,512),[[g,x.display_name]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Context Window",-1)),k(e("input",{"onUpdate:modelValue":t[14]||(t[14]=o=>x.context_window=o),type:"number",class:"settings-input"},null,512),[[g,x.context_window,void 0,{number:!0}]])])]),e("button",{onClick:m,class:"lime-btn"},"Add")])):P("",!0)])]))}},Qe=V(Ye,[["__scopeId","data-v-f6fb6d3f"]]),We={class:"card rounded-md p-5 mt-3"},Xe={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3"},Ze={class:"flex gap-3"},Ge={__name:"AddProviderForm",emits:["submit","cancel"],setup(_,{emit:h}){const f=h,u=E({display_name:"",provider_key:"",model_id_prefix:"",api_base:"",api_key_env:""});function D(){const y=X(u.display_name);u.provider_key=y,u.api_key_env=y.toUpperCase().replace(/-/g,"_")+"_API_KEY"}function d(){f("submit",{...u}),u.display_name="",u.provider_key="",u.model_id_prefix="",u.api_base="",u.api_key_env=""}return(y,n)=>(a(),r("div",We,[e("div",Xe,[e("div",null,[n[6]||(n[6]=e("label",{class:"field-label"},"Display Name",-1)),k(e("input",{"onUpdate:modelValue":n[0]||(n[0]=w=>u.display_name=w),onInput:D,placeholder:"My Provider",class:"settings-input"},null,544),[[g,u.display_name]])]),e("div",null,[n[7]||(n[7]=e("label",{class:"field-label"},[K("Provider Key "),e("span",{class:"text-zinc-700 normal-case"},"(auto-derived, editable)")],-1)),k(e("input",{"onUpdate:modelValue":n[1]||(n[1]=w=>u.provider_key=w),placeholder:"auto_generated",class:"settings-input"},null,512),[[g,u.provider_key]])]),e("div",null,[n[8]||(n[8]=e("label",{class:"field-label"},[K("Model ID Prefix "),e("span",{class:"text-zinc-700 normal-case"},"(e.g. lm_studio)")],-1)),k(e("input",{"onUpdate:modelValue":n[2]||(n[2]=w=>u.model_id_prefix=w),placeholder:"Optional -- prepended to model IDs",class:"settings-input"},null,512),[[g,u.model_id_prefix]])]),e("div",null,[n[9]||(n[9]=e("label",{class:"field-label"},"API Base",-1)),k(e("input",{"onUpdate:modelValue":n[3]||(n[3]=w=>u.api_base=w),placeholder:"https://api.example.com/v1",class:"settings-input"},null,512),[[g,u.api_base]])]),e("div",null,[n[10]||(n[10]=e("label",{class:"field-label"},[K("API Key Name "),e("span",{class:"text-zinc-700 normal-case"},"(auto-derived)")],-1)),k(e("input",{"onUpdate:modelValue":n[4]||(n[4]=w=>u.api_key_env=w),placeholder:"e.g. OPENAI_API_KEY",class:"settings-input"},null,512),[[g,u.api_key_env]])])]),e("div",Ze,[e("button",{onClick:d,class:"lime-btn"},"Create Provider"),e("button",{onClick:n[5]||(n[5]=w=>y.$emit("cancel")),class:"text-[11px] font-display tracking-wider uppercase text-zinc-600 hover:text-zinc-400 px-3 py-1.5 transition-colors"},"Cancel")])]))}},He=V(Ge,[["__scopeId","data-v-6fb76034"]]),et={class:"card rounded-md p-5 w-full max-w-lg max-h-[70vh] flex flex-col",style:{border:"1px solid var(--border-subtle)"}},tt={class:"flex items-center justify-between mb-3"},ot={class:"font-display text-sm tracking-wide text-zinc-200"},st={class:"overflow-y-auto flex-1 mb-3"},lt=["value","checked","disabled","onChange"],it={class:"text-xs font-mono text-zinc-300"},nt={key:0,class:"text-[10px] text-zinc-500"},dt={key:1,class:"text-[9px] text-zinc-600 ml-auto"},at=["disabled"],rt={__name:"DiscoveredModelsDialog",props:{visible:{type:Boolean,default:!1},models:{type:Array,default:()=>[]},existingModelIds:{type:Array,default:()=>[]}},emits:["close","add"],setup(_,{expose:h,emit:f}){const u=_,D=f,d=S(new Set),y=S(!1),n=N(()=>new Set(u.existingModelIds));function w(C,s){s.target.checked?d.value.add(C):d.value.delete(C),d.value=new Set(d.value)}function z(){d.value=new Set,D("close")}async function F(){const C=Array.from(d.value).map(s=>u.models[s]);C.length!==0&&(y.value=!0,D("add",C))}function $(){d.value=new Set,y.value=!1}return h({reset:$}),(C,s)=>(a(),L(G,{to:"body"},[_.visible?(a(),r("div",{key:0,class:"modal-overlay",onClick:Z(z,["self"])},[e("div",et,[e("div",tt,[e("span",ot,b(_.models.length)+" models available",1),e("button",{onClick:z,class:"text-zinc-500 hover:text-zinc-300 text-xs cursor-pointer"},"Close")]),e("div",st,[(a(!0),r(U,null,O(_.models,(c,T)=>(a(),r("label",{key:c.id,class:Y(["flex items-center gap-2 py-1.5 px-2 rounded hover:bg-white/5 cursor-pointer",n.value.has(c.id)?"opacity-40":""])},[e("input",{type:"checkbox",value:T,checked:n.value.has(c.id)||d.value.has(T),disabled:n.value.has(c.id),onChange:A=>w(T,A),class:"accent-lime-400"},null,40,lt),e("span",it,b(c.id),1),c.display_name!==c.id?(a(),r("span",nt,b(c.display_name),1)):P("",!0),n.value.has(c.id)?(a(),r("span",dt,"already added")):P("",!0)],2))),128))]),e("button",{onClick:F,disabled:y.value,class:"lime-btn self-end"},b(y.value?"Adding...":"Add Selected"),9,at)])])):P("",!0)]))}},pt=V(rt,[["__scopeId","data-v-9eb79053"]]),ut={key:0,class:"text-zinc-600 text-sm font-body"},ct={key:1,class:"text-red-400 text-xs font-body"},mt={key:2,class:"space-y-4"},vt={__name:"ProvidersPanel",setup(_){const{showToast:h}=J(),{confirm:f}=q(),u=S(null),D=S(!0),d=S(""),y=S(!1),n=S({}),w=S(null),z=S({visible:!1,models:[],existingIds:[],providerKey:""}),F=N(()=>{var p;return(p=u.value)!=null&&p.providers?Object.entries(u.value.providers).map(([m,l])=>({display_name:m,provider_key:l.provider_key,models:l.models||[],api_base:l.api_base||"",api_key_env:l.api_key_env||"",model_id_prefix:l.model_id_prefix||""})):[]});async function $(){try{const p=await M("/api/config");u.value=await p.json(),d.value=""}catch{d.value="Failed to load config."}finally{D.value=!1}}async function C(p){if(await f("Delete Provider",`Delete <strong>${p.display_name}</strong> and its ${p.models.length} model(s)?`,{danger:!0,confirmLabel:"Delete"}))try{await M("/api/config/provider",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:p.provider_key})}),await $()}catch{h("Failed to delete provider","error")}}async function s({providerKey:p,model:m}){if(await f("Remove Model",`Remove model <strong>${m.display_name}</strong>?`,{danger:!0,confirmLabel:"Remove"}))try{await M("/api/config/model",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:p,model_id:m.model_id})}),await $()}catch{h("Failed to delete model","error")}}async function c(p){if(!p.provider_key){h("Provider key is required","error");return}try{const m=await M("/api/config/provider",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(m.ok)y.value=!1,await $();else{const l=await m.json();h(l.error||"Failed to add provider","error")}}catch{h("Network error","error")}}async function T(p){if(!n.value[p])try{const l=await(await M(`/api/models/discover?provider_key=${encodeURIComponent(p)}`)).json();l.models&&(n.value[p]=l.models)}catch{}}async function A(p){var m,l;try{const o=await(await M(`/api/models/discover?provider_key=${encodeURIComponent(p)}`)).json();if(o.error){h(o.error,"error");return}const i=o.models||[];if(i.length===0){h("No models found","error");return}n.value[p]=i;const v=F.value.find(j=>j.provider_key===p),I=((v==null?void 0:v.models)||[]).map(j=>j.model_id);z.value={visible:!0,models:i,existingIds:I,providerKey:p},(l=(m=w.value)==null?void 0:m.reset)==null||l.call(m)}catch(t){h("Failed to fetch models: "+t.message,"error")}}async function x(p){const m=z.value.providerKey;for(const l of p)await M("/api/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:m,id:l.id,display_name:l.display_name})});z.value.visible=!1,await $(),h(`Added ${p.length} model(s)`,"success")}return H($),(p,m)=>(a(),r("div",null,[D.value?(a(),r("div",ut,"Loading config...")):d.value?(a(),r("div",ct,b(d.value),1)):(a(),r("div",mt,[(a(!0),r(U,null,O(F.value,l=>(a(),L(Qe,{key:l.provider_key,provider:l,"discovered-models":n.value[l.provider_key]||[],onRefresh:$,onDelete:C,onDeleteModel:s,onFetch:A,onLoadDiscovery:T},null,8,["provider","discovered-models"]))),128)),e("div",null,[e("button",{onClick:m[0]||(m[0]=l=>y.value=!y.value),class:"lime-btn"},"+ Add Provider"),y.value?(a(),L(He,{key:0,onSubmit:c,onCancel:m[1]||(m[1]=l=>y.value=!1)})):P("",!0)])])),ee(pt,{ref_key:"discoveryDialogRef",ref:w,visible:z.value.visible,models:z.value.models,"existing-model-ids":z.value.existingIds,onClose:m[2]||(m[2]=l=>z.value.visible=!1),onAdd:x},null,8,["visible","models","existing-model-ids"])]))}},xt=V(vt,[["__scopeId","data-v-ee52447d"]]);export{xt as default};

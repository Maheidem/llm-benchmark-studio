import{w as ue,o as r,c as i,a as e,d as _,e as V,b as L,f as A,R as X,F as z,p as S,g as w,t as a,r as g,y as P,k as I,i as pe,K as G,s as ve,H as me,A as U,q as $,v as xe,O as fe,B as H,l as ye,G as _e,E as be}from"./index-BxbfhC3f.js";import{a as ge,u as ke}from"./useSharedContext-DRtY8wlt.js";import{u as he}from"./profiles-BVcR1NyN.js";const we={class:"card rounded-md p-5","data-section":"system-prompt"},$e={class:"flex items-center gap-2"},Ce={key:0,class:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"rgba(34,197,94,0.15)",color:"#22C55E"}},ze={class:"flex items-center gap-2"},Se={key:0,class:"flex flex-wrap gap-1.5 mb-2"},Ee=["onClick"],je=["value"],Pe={__name:"SystemPromptEditor",props:{models:{type:Array,default:()=>[]},systemPrompts:{type:Object,default:()=>({})}},emits:["update:systemPrompts"],setup(C,{emit:c}){const b=C,f=c,m=g(!1),k=g("_global"),E=P(()=>{const d=[{key:"_global",label:"Default (All)"}];for(const u of b.models){const x=typeof u=="string"?u:u.model_id||u.id||"";if(!x)continue;const T=typeof u=="string"?u.split("/").pop():u.display_name||u.model_id||u.id||"Model";d.push({key:x,label:T})}return d}),M=P(()=>b.systemPrompts[k.value]||""),p=P(()=>b.systemPrompts?Object.values(b.systemPrompts).some(d=>d&&d.trim()):!1);function l(d){const u={...b.systemPrompts,[k.value]:d};f("update:systemPrompts",u)}function o(){f("update:systemPrompts",{}),k.value="_global"}return ue(()=>b.systemPrompts,d=>{d&&Object.values(d).some(u=>u&&u.trim())&&(m.value=!0)},{immediate:!0}),(d,u)=>(r(),i("div",we,[e("div",{class:"flex items-center justify-between mb-3 cursor-pointer",onClick:u[0]||(u[0]=x=>m.value=!m.value)},[e("div",$e,[u[2]||(u[2]=e("span",{class:"section-label",style:{cursor:"pointer"}},"System Prompt",-1)),p.value?(r(),i("span",Ce,"Active")):_("",!0)]),e("div",ze,[p.value?(r(),i("button",{key:0,onClick:V(o,["stop"]),class:"text-[10px] font-display tracking-wider uppercase px-2 py-0.5 rounded-sm",style:{color:"var(--coral)",border:"1px solid rgba(255,59,92,0.2)",background:"none",cursor:"pointer"}},"Clear")):_("",!0),(r(),i("svg",{class:L(["w-4 h-4 text-zinc-600 transition-transform",{"rotate-180":m.value}]),fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[...u[3]||(u[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 9l-7 7-7-7"},null,-1)])],2))])]),A(e("div",null,[C.models.length>1?(r(),i("div",Se,[(r(!0),i(z,null,S(E.value,x=>(r(),i("button",{key:x.key,onClick:T=>k.value=x.key,class:L(["text-[10px] font-display tracking-wider uppercase px-2 py-1 rounded-sm transition-colors",k.value===x.key?"text-zinc-200":"text-zinc-600 hover:text-zinc-400"]),style:w(k.value===x.key?"background:rgba(255,255,255,0.06);border:1px solid var(--border);":"background:transparent;border:1px solid transparent;")},a(x.label),15,Ee))),128))])):_("",!0),e("textarea",{value:M.value,onInput:u[1]||(u[1]=x=>l(x.target.value)),rows:"5",class:"w-full px-3 py-2 rounded-sm text-sm text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace","font-size":"12px",resize:"vertical"},placeholder:"Enter a system prompt to prepend to eval calls..."},null,40,je)],512),[[X,m.value]])]))}},Me={class:"card rounded-md overflow-hidden"},Ae={class:"flex items-center justify-between px-5 py-3",style:{"border-bottom":"1px solid var(--border-subtle)"}},Ie={class:"text-xs text-zinc-600 font-body"},Fe={class:"w-full text-sm results-table"},Te={style:{"border-bottom":"1px solid var(--border-subtle)"}},Re={key:0},Be=["onClick"],Oe={class:"px-5 py-3 text-sm font-body text-zinc-200"},Ve={class:"px-5 py-3 text-right text-xs font-mono text-zinc-500"},Ne={__name:"EvalResultsTable",props:{results:{type:Array,required:!0}},emits:["showDetail"],setup(C){const c=C,b=g("overall_pct"),f=g(!1);function m(l){b.value===l?f.value=!f.value:(b.value=l,f.value=l==="model_name")}function k(l){return b.value!==l?"":f.value?"▲":"▼"}const E=P(()=>{const l=[...c.results];return l.sort((o,d)=>{const u=o[b.value]??0,x=d[b.value]??0;return typeof u=="string"?f.value?u.localeCompare(x):x.localeCompare(u):f.value?u-x:x-u}),l}),M=P(()=>{const l=c.results.length;return`${c.results.reduce((d,u)=>d+(u.cases_run||0),0)} evaluations across ${l} model${l>1?"s":""}`});function p(l){return l>=80?"var(--lime)":l>=50?"#FBBF24":"var(--coral)"}return(l,o)=>(r(),i("div",Me,[e("div",Ae,[o[4]||(o[4]=e("span",{class:"section-label"},"Summary",-1)),e("span",Ie,a(M.value),1)]),e("table",Fe,[e("thead",null,[e("tr",Te,[e("th",{class:"px-5 py-3 text-left section-label cursor-pointer",onClick:o[0]||(o[0]=d=>m("model_name"))}," Model "+a(k("model_name")),1),e("th",{class:"px-5 py-3 text-right section-label cursor-pointer",onClick:o[1]||(o[1]=d=>m("tool_accuracy_pct"))}," Tool % "+a(k("tool_accuracy_pct")),1),e("th",{class:"px-5 py-3 text-right section-label cursor-pointer",onClick:o[2]||(o[2]=d=>m("param_accuracy_pct"))}," Param % "+a(k("param_accuracy_pct")),1),e("th",{class:"px-5 py-3 text-right section-label cursor-pointer",onClick:o[3]||(o[3]=d=>m("overall_pct"))}," Overall % "+a(k("overall_pct")),1),o[5]||(o[5]=e("th",{class:"px-5 py-3 text-right section-label"},"Cases",-1))])]),e("tbody",null,[C.results.length?_("",!0):(r(),i("tr",Re,[...o[6]||(o[6]=[e("td",{colspan:"5",class:"px-5 py-8 text-center text-zinc-600 text-sm font-body"}," No results yet. ",-1)])])),(r(!0),i(z,null,S(E.value,d=>(r(),i("tr",{key:d.model_id,class:"cursor-pointer",onClick:u=>l.$emit("showDetail",d.model_id)},[e("td",Oe,a(d.model_name||d.model_id),1),e("td",{class:"px-5 py-3 text-right text-sm font-mono font-bold",style:w({color:p(d.tool_accuracy_pct)})},a((d.tool_accuracy_pct??0).toFixed(1))+"% ",5),e("td",{class:"px-5 py-3 text-right text-sm font-mono font-bold",style:w({color:p(d.param_accuracy_pct??0)})},a(d.param_accuracy_pct!=null?d.param_accuracy_pct.toFixed(1)+"%":"-"),5),e("td",{class:"px-5 py-3 text-right text-sm font-mono font-bold",style:w({color:p(d.overall_pct??0)})},a((d.overall_pct??0).toFixed(1))+"% ",5),e("td",Ve,a(d.cases_run||0),1)],8,Be))),128))])])]))}},De={class:"modal-box",style:{"max-width":"720px","max-height":"80vh","overflow-y":"auto"}},Je={class:"flex items-center justify-between mb-4"},qe={class:"modal-title"},Ue={class:"space-y-3"},Le={class:"flex items-center gap-2 mb-1"},We={key:0,class:"text-[10px] text-zinc-700 font-mono ml-auto"},Ke={class:"text-sm text-zinc-300 font-body mb-1"},Ge={class:"grid grid-cols-2 gap-4 text-xs font-mono"},He={class:"text-zinc-400"},Xe={key:0,class:"text-zinc-600 mt-0.5 break-all"},Qe={key:0,class:"text-zinc-600 mt-0.5 break-all"},Ye={class:"flex gap-4 mt-2 text-[10px] font-mono text-zinc-600"},Ze={key:0},et={key:0,class:"mt-2"},tt={class:"text-[10px] font-mono"},st={style:{color:"var(--lime)"}},ot={class:"text-zinc-600 ml-1"},lt={class:"mt-1 grid grid-cols-4 gap-2 text-[10px] font-mono"},nt={class:"text-zinc-500"},at={style:{color:"var(--lime)"}},rt={class:"text-zinc-500"},it={style:{color:"var(--lime)"}},dt={class:"text-zinc-500"},ct={style:{color:"var(--coral)"}},ut={class:"text-zinc-500"},pt={style:{color:"var(--coral)"}},vt={key:1,class:"mt-2 text-xs",style:{color:"var(--coral)"}},mt={key:2,class:"mt-2"},xt=["onClick"],ft={key:0,class:"mt-2 space-y-2",style:{"max-height":"300px","overflow-y":"auto"}},yt={key:0},_t={class:"text-[10px] font-mono text-zinc-400 p-2 rounded-sm overflow-x-auto",style:{background:"rgba(0,0,0,0.3)",border:"1px solid var(--border-subtle)","white-space":"pre-wrap","word-break":"break-all"}},bt={key:1},gt={class:"text-[10px] font-mono text-zinc-400 p-2 rounded-sm overflow-x-auto",style:{background:"rgba(0,0,0,0.3)",border:"1px solid var(--border-subtle)","white-space":"pre-wrap","word-break":"break-all"}},kt={class:"flex justify-end mt-4"},ht={__name:"ModelDetailModal",props:{visible:{type:Boolean,default:!1},modelId:{type:String,default:""},allResults:{type:Array,default:()=>[]}},emits:["close"],setup(C){const c=C,b=g({}),f=P(()=>c.allResults.filter(p=>p.model_id===c.modelId)),m=P(()=>{const p=f.value[0];return(p==null?void 0:p.model_name)||(p==null?void 0:p.model_id)||c.modelId});function k(p){return p>=80?"var(--lime)":p>=50?"#FBBF24":"var(--coral)"}function E(p){return p==null?"(no tool call)":Array.isArray(p)?p.join(" | "):p}function M(p){b.value[p]=!b.value[p]}return(p,l)=>C.visible?(r(),i("div",{key:0,class:"modal-overlay",onClick:l[2]||(l[2]=V(o=>p.$emit("close"),["self"]))},[e("div",De,[e("div",Je,[e("div",qe,a(m.value),1),e("button",{onClick:l[0]||(l[0]=o=>p.$emit("close")),class:"text-zinc-600 hover:text-zinc-400 text-lg"},"×")]),e("div",Ue,[(r(!0),i(z,null,S(f.value,(o,d)=>{var u;return r(),i("div",{key:o.test_case_id||d,class:"rounded-sm p-3",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)"}},[e("div",Le,[e("span",{style:w({color:o.tool_selection_score===1?"var(--lime)":"var(--coral)"}),class:"text-xs font-mono font-bold"},a(o.tool_selection_score===1?"OK":"X"),5),e("span",{class:"text-xs font-mono font-bold",style:w({color:k(o.overall_score*100)})},a((o.overall_score*100).toFixed(0))+"% ",5),o.latency_ms?(r(),i("span",We,a(o.latency_ms)+"ms",1)):_("",!0)]),e("div",Ke,'"'+a(o.prompt||"")+'"',1),e("div",Ge,[e("div",null,[l[3]||(l[3]=e("div",{class:"text-[10px] font-display tracking-wider text-zinc-500 uppercase mb-0.5"},"Expected",-1)),e("div",He,a(E(o.expected_tool)),1),o.expected_params?(r(),i("div",Xe,a(JSON.stringify(o.expected_params)),1)):_("",!0)]),e("div",null,[l[4]||(l[4]=e("div",{class:"text-[10px] font-display tracking-wider text-zinc-500 uppercase mb-0.5"},"Actual",-1)),e("div",{style:w({color:o.tool_selection_score>0?"var(--lime)":"var(--coral)"})},a(o.actual_tool||"(no tool call)"),5),o.actual_params?(r(),i("div",Qe,a(JSON.stringify(o.actual_params)),1)):_("",!0)])]),e("div",Ye,[e("span",null,[l[5]||(l[5]=I("Tool: ",-1)),e("span",{style:w({color:k(o.tool_selection_score*100)})},a((o.tool_selection_score*100).toFixed(0))+"%",5)]),o.param_accuracy!=null?(r(),i("span",Ze,[l[6]||(l[6]=I("Param: ",-1)),e("span",{style:w({color:k(o.param_accuracy*100)})},a((o.param_accuracy*100).toFixed(0))+"%",5)])):_("",!0)]),o.multi_turn&&((u=o.tool_chain)!=null&&u.length)?(r(),i("div",et,[e("div",tt,[l[7]||(l[7]=e("span",{class:"text-zinc-600"},"Chain:",-1)),e("span",st,a(o.tool_chain.map(x=>x.tool_name).join(" → ")),1),e("span",ot,"("+a(o.rounds_used||o.tool_chain.length)+" round"+a((o.rounds_used||o.tool_chain.length)>1?"s":"")+")",1)]),e("div",lt,[e("span",nt,[l[8]||(l[8]=I("Completion: ",-1)),e("span",at,a(((o.completion_score||0)*100).toFixed(0))+"%",1)]),e("span",rt,[l[9]||(l[9]=I("Efficiency: ",-1)),e("span",it,a(((o.efficiency_score||0)*100).toFixed(0))+"%",1)]),e("span",dt,[l[10]||(l[10]=I("Redundancy: ",-1)),e("span",ct,"-"+a(((o.redundancy_penalty||0)*100).toFixed(0))+"%",1)]),e("span",ut,[l[11]||(l[11]=I("Detour: ",-1)),e("span",pt,"-"+a(((o.detour_penalty||0)*100).toFixed(0))+"%",1)])])])):_("",!0),o.error?(r(),i("div",vt,a(o.error),1)):_("",!0),o.raw_request||o.raw_response?(r(),i("div",mt,[e("button",{onClick:x=>M(d),class:"text-[10px] font-display tracking-wider uppercase px-2 py-0.5 rounded-sm",style:{color:"var(--lime)",border:"1px solid rgba(191,255,0,0.15)"}},a(b.value[d]?"HIDE RAW":"VIEW RAW"),9,xt),b.value[d]?(r(),i("div",ft,[o.raw_request?(r(),i("div",yt,[l[12]||(l[12]=e("div",{class:"text-[10px] font-display tracking-wider text-zinc-500 uppercase mb-1"},"Request",-1)),e("pre",_t,a(JSON.stringify(o.raw_request,null,2)),1)])):_("",!0),o.raw_response?(r(),i("div",bt,[l[13]||(l[13]=e("div",{class:"text-[10px] font-display tracking-wider text-zinc-500 uppercase mb-1"},"Response",-1)),e("pre",gt,a(JSON.stringify(o.raw_response,null,2)),1)])):_("",!0)])):_("",!0)])):_("",!0)])}),128))]),e("div",kt,[e("button",{onClick:l[1]||(l[1]=o=>p.$emit("close")),class:"modal-btn modal-btn-cancel"},"Close")])])])):_("",!0)}},wt={class:"card rounded-md p-5 mb-6"},$t=["value"],Ct={class:"card rounded-md p-5 mb-6"},zt={class:"flex items-center justify-between mb-3"},St={class:"text-xs font-mono text-zinc-600"},Et={key:0,class:"text-xs text-zinc-600 font-body"},jt={key:1,class:"text-xs text-zinc-600 font-body"},Pt={key:2,class:"flex flex-col gap-1"},Mt=["onClick"],At={class:"provider-group-count"},It=["onClick"],Ft={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 pl-4 pb-2"},Tt=["onClick"],Rt={class:"flex-1 min-w-0"},Bt={class:"text-xs font-mono text-zinc-200 truncate"},Ot={key:0,class:"card rounded-md p-5 mb-6"},Vt={class:"flex flex-col gap-2"},Nt=["title"],Dt=["onUpdate:modelValue"],Jt=["value"],qt={class:"card rounded-md p-5 mb-6"},Ut={class:"flex items-center gap-4 flex-wrap"},Lt={class:"flex items-center gap-2 cursor-pointer",title:"Automatically run judge analysis after eval completes"},Wt={class:"ml-auto flex gap-2"},Kt=["disabled"],Gt={key:0,class:"w-3.5 h-3.5 animate-spin",fill:"none",viewBox:"0 0 24 24"},Ht={key:1,class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor","stroke-width":"2.5",viewBox:"0 0 24 24"},Xt={key:2,class:"mb-6 fade-in"},Qt={class:"card rounded-md p-5"},Yt={class:"flex items-center justify-between mb-3"},Zt={class:"flex items-center gap-3"},es={class:"text-sm text-zinc-400 font-body"},ts={class:"text-xs font-mono text-zinc-600"},ss={class:"progress-track rounded-full overflow-hidden"},os={key:0,class:"error-banner mt-3"},ls={key:3,class:"card rounded-md overflow-hidden mb-6"},ns={style:{"max-height":"400px","overflow-y":"auto"}},as={class:"w-full text-sm results-table"},rs={class:"px-5 py-2 text-xs font-mono text-zinc-300"},is={class:"px-5 py-2 text-xs font-body text-zinc-400"},ds={class:"px-5 py-2 text-xs font-mono text-zinc-500"},cs=["title"],ms={__name:"EvaluateView",setup(C){const c=ge(),b=he(),{showToast:f}=_e(),{context:m,setSuite:k,setModels:E,setConfig:M}=ke(),p=g(""),l=g(new Set),o=g(0),d=g("required"),u=g(!1),x=g({}),T=g(!0),N=g([]),j=g("Initializing..."),R=g("0/0"),F=g(0),B=g(""),D=g(!1),W=g(""),J=g({}),q=P(()=>Array.from(l.value).filter(n=>n&&n.includes("::")).map(n=>{const t=n.indexOf("::"),s=n.substring(t+2);return{id:n,model_id:s,display_name:s.split("/").pop()||s}}));pe(async()=>{var t;if(c.suites.length===0)try{await c.loadSuites()}catch{}try{const s=await G("/api/config");if(s.ok){const v=await s.json();Q(v)}}catch{f("Failed to load model config","error")}finally{T.value=!1}m.suiteId&&(p.value=m.suiteId),(t=m.selectedModels)!=null&&t.length&&(l.value=new Set(m.selectedModels)),m.temperature!=null&&(o.value=m.temperature),m.toolChoice&&(d.value=m.toolChoice),m.systemPrompts&&(x.value={...m.systemPrompts});try{await b.fetchProfiles()}catch{}try{const s=await G("/api/settings/judge");if(s.ok){const v=await s.json();u.value=!!v.auto_judge_after_eval}}catch{}const n=sessionStorage.getItem("_teJobId");n&&(c.activeJobId=n,c.isEvaluating=!0),se()});function Q(n){const t=[],s=n.providers||{};for(const[v,y]of Object.entries(s)){const h=y.provider_key||v,K=(y.models||[]).map(O=>({key:`${h}::${O.model_id}`,model_id:O.model_id,display_name:O.display_name||O.model_id,provider_key:h}));if(K.length===0)continue;const ce=ve(y.display_name||v);t.push({provider:y.display_name||v,color:ce.text,models:K,collapsed:!1})}N.value=t}function Y(n){const t=new Set(l.value);t.has(n)?t.delete(n):t.add(n),l.value=t,E(Array.from(t))}function Z(n){return n.models.every(t=>l.value.has(t.key))}function ee(n){const t=new Set(l.value),s=n.models.every(v=>t.has(v.key));for(const v of n.models)s?t.delete(v.key):t.add(v.key);l.value=t,E(Array.from(t))}function te(){const n=c.suites.find(t=>t.id===p.value);n&&k(n.id,n.name)}function se(){const n=me();if(!n)return;const s=`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/ws?token=${n}`,{connect:v}=be(s,{onMessage:oe});v()}function oe(n){if(c.activeJobId&&n.job_id===c.activeJobId)switch(c.handleEvalProgress(n),n.type){case"tool_eval_init":{const t=n.data||n;j.value=`Evaluating ${t.suite_name||""}...`,R.value=`0/${c.evalTotalCases}`;break}case"tool_eval_progress":{const t=n.data||n,s=t.total>0?Math.round(t.current/t.total*100):0;if(F.value=s,R.value=`${t.current}/${t.total}`,j.value=`Testing ${t.model||""}...`,c.evalStartTime&&s>0&&s<100){const y=(Date.now()-c.evalStartTime)/1e3/s*(100-s),h=y>60?Math.ceil(y/60)+"m left":Math.ceil(y)+"s left";j.value+=" — "+h}break}case"tool_eval_result":{c.evalTotalCases>0&&(F.value=Math.round(c.evalResults.length/c.evalTotalCases*100),R.value=`${c.evalResults.length}/${c.evalTotalCases}`);break}case"tool_eval_complete":j.value="Complete!",F.value=100,f("Eval complete!","success");break;case"job_completed":j.value="Complete!",F.value=100;break;case"job_failed":B.value=n.error||n.error_msg||"Eval failed";break;case"job_cancelled":j.value="Cancelled",f("Eval cancelled","");break}}async function le(){if(l.value.size===0){f("Select at least one model","error");return}if(!p.value){f("No suite selected","error");return}c.resetEval(),j.value="Initializing...",F.value=0,R.value="0/0",B.value="";const n=Array.from(l.value).map(y=>{const h=y.indexOf("::");return{provider_key:y.substring(0,h),model_id:y.substring(h+2)}}),t={suite_id:p.value,targets:n,temperature:o.value,tool_choice:d.value,auto_judge:u.value},s={};for(const[y,h]of Object.entries(x.value))h&&h.trim()&&(s[y]=h);Object.keys(s).length>0&&(t.system_prompt=s);const v={};for(const[y,h]of Object.entries(J.value))h&&(v[y]=h);Object.keys(v).length>0&&(t.profiles=v),m.experimentId&&(t.experiment_id=m.experimentId),M({temperature:o.value,toolChoice:d.value,systemPrompts:s,lastUpdatedBy:null});try{await c.runEval(t),f("Eval submitted","success")}catch(y){f(y.message||"Failed to start eval","error"),c.isEvaluating=!1}}async function ne(){try{await c.cancelEval(),f("Cancellation requested","")}catch{f("Failed to cancel","error")}}function ae(n,t){return n?n.length>t?n.slice(0,t)+"...":n:""}function re(n){return n==null?"(none)":Array.isArray(n)?n.join(" | "):typeof n=="object"?JSON.stringify(n):n}function ie(n){return n>=80?"var(--lime)":n>=50?"#FBBF24":"var(--coral)"}function de(n){W.value=n,D.value=!0}return(n,t)=>(r(),i("div",null,[t[22]||(t[22]=e("div",{class:"flex items-center justify-between mb-6"},[e("div",null,[e("h2",{class:"font-display font-bold text-lg text-zinc-100 mb-1"},"Evaluate"),e("p",{class:"text-sm text-zinc-600 font-body"},"Select models, configure settings, and run tool calling evaluations.")])],-1)),e("div",wt,[t[7]||(t[7]=e("label",{class:"section-label mb-2 block"},"Suite",-1)),A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),onChange:te,class:"text-sm font-mono px-3 py-2 rounded-sm w-full",style:{background:"var(--surface)",border:"1px solid var(--border-subtle)",color:"#E4E4E7",outline:"none"}},[t[6]||(t[6]=e("option",{value:""},"-- Select a suite --",-1)),(r(!0),i(z,null,S($(c).suites,s=>(r(),i("option",{key:s.id,value:s.id},a(s.name)+" ("+a(s.tool_count||0)+" tools, "+a(s.test_case_count||0)+" cases) ",9,$t))),128))],544),[[U,p.value]])]),e("div",Ct,[e("div",zt,[t[8]||(t[8]=e("span",{class:"section-label"},"Models",-1)),e("span",St,a(l.value.size)+" selected",1)]),T.value?(r(),i("div",Et,"Loading models...")):N.value.length===0?(r(),i("div",jt," No models available. Configure providers in Settings. ")):(r(),i("div",Pt,[(r(!0),i(z,null,S(N.value,s=>(r(),i("div",{key:s.provider,class:"provider-group"},[e("div",{class:"provider-group-header",onClick:v=>s.collapsed=!s.collapsed},[e("div",{class:"provider-group-dot",style:w({background:s.color})},null,4),e("span",{class:"provider-group-label",style:w({color:s.color})},a(s.provider),5),e("span",At,a(s.models.length),1),e("button",{onClick:V(v=>ee(s),["stop"]),class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 hover:text-zinc-400 ml-2"},a(Z(s)?"None":"All"),9,It)],8,Mt),A(e("div",Ft,[(r(!0),i(z,null,S(s.models,v=>(r(),i("div",{key:v.key,class:L(["model-card rounded-sm px-3 py-2 flex items-center gap-2",{selected:l.value.has(v.key)}]),onClick:V(y=>Y(v.key),["stop"])},[t[9]||(t[9]=e("div",{class:"check-dot"},null,-1)),e("div",Rt,[e("div",Bt,a(v.display_name||v.model_id),1)])],10,Tt))),128))],512),[[X,!s.collapsed]])]))),128))]))]),q.value.length>0&&$(b).profiles.length>0?(r(),i("div",Ot,[t[11]||(t[11]=e("span",{class:"section-label block mb-3"},"Profiles (optional)",-1)),e("div",Vt,[(r(!0),i(z,null,S(q.value,s=>(r(),i("div",{key:s.id,class:"flex items-center gap-3"},[e("span",{class:"text-xs font-mono text-zinc-400 w-40 truncate",title:s.model_id},a(s.display_name),9,Nt),A(e("select",{"onUpdate:modelValue":v=>J.value[s.model_id]=v,class:"text-xs font-mono px-2 py-1 rounded-sm flex-1",style:{background:"var(--surface)",border:"1px solid var(--border-subtle)",color:"var(--zinc-200)",outline:"none"}},[t[10]||(t[10]=e("option",{value:""},"No Profile",-1)),(r(!0),i(z,null,S($(b).profilesByModel[s.model_id]||[],v=>(r(),i("option",{key:v.id,value:v.id},a(v.name)+a(v.is_default?" (default)":""),9,Jt))),128))],8,Dt),[[U,J.value[s.model_id]]])]))),128))])])):_("",!0),e("div",qt,[t[18]||(t[18]=e("div",{class:"flex items-center justify-between mb-4"},[e("span",{class:"section-label"},"Eval Settings")],-1)),e("div",Ut,[e("div",null,[t[12]||(t[12]=e("span",{class:"text-zinc-500 font-body text-xs"},"Temperature",-1)),A(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value=s),type:"number",min:"0",max:"2",step:"0.1",class:"ml-2 w-16 px-2 py-1 rounded-sm text-sm font-mono text-zinc-200 text-center",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,512),[[xe,o.value,void 0,{number:!0}]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"text-xs font-display tracking-wider text-zinc-500 uppercase"},"Tool Choice",-1)),A(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),class:"text-xs font-mono px-3 py-1.5 rounded-sm ml-2",style:{background:"var(--surface)",border:"1px solid var(--border-subtle)",color:"var(--zinc-200)",width:"120px"}},[...t[13]||(t[13]=[e("option",{value:"required"},"Required",-1),e("option",{value:"auto"},"Auto",-1),e("option",{value:"none"},"None",-1)])],512),[[U,d.value]])]),e("label",Lt,[A(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>u.value=s),class:"accent-amber-400"},null,512),[[fe,u.value]]),t[15]||(t[15]=e("span",{class:"text-xs font-body text-zinc-400"},"Auto-run Judge",-1))]),e("div",Wt,[$(c).isEvaluating?(r(),i("button",{key:0,onClick:ne,class:"text-[11px] font-display font-medium tracking-wider uppercase px-3 py-1 rounded-sm transition-colors",style:{color:"var(--coral)",border:"1px solid rgba(255,59,92,0.3)"}},"Cancel")):_("",!0),e("button",{onClick:le,disabled:$(c).isEvaluating||l.value.size===0||!p.value,class:"run-btn px-6 py-2 rounded-sm text-xs flex items-center gap-2"},[$(c).isEvaluating?(r(),i("svg",Gt,[...t[16]||(t[16]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(r(),i("svg",Ht,[...t[17]||(t[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)])])),I(" "+a($(c).isEvaluating?"Running...":"Start Eval"),1)],8,Kt)])])]),l.value.size>0?(r(),H(Pe,{key:1,models:q.value,"system-prompts":x.value,"onUpdate:systemPrompts":t[4]||(t[4]=s=>x.value=s)},null,8,["models","system-prompts"])):_("",!0),$(c).isEvaluating?(r(),i("div",Xt,[e("div",Qt,[e("div",Yt,[e("div",Zt,[t[19]||(t[19]=e("div",{class:"pulse-dot"},null,-1)),e("span",es,a(j.value),1)]),e("span",ts,a(R.value),1)]),e("div",ss,[e("div",{class:"progress-fill",style:w({width:F.value+"%"})},null,4)])]),B.value?(r(),i("div",os,[e("span",null,a(B.value),1)])):_("",!0)])):_("",!0),$(c).evalResults.length>0?(r(),i("div",ls,[t[21]||(t[21]=e("div",{class:"px-5 py-3",style:{"border-bottom":"1px solid var(--border-subtle)"}},[e("span",{class:"section-label"},"Live Results")],-1)),e("div",ns,[e("table",as,[t[20]||(t[20]=e("thead",null,[e("tr",{style:{"border-bottom":"1px solid var(--border-subtle)"}},[e("th",{class:"px-5 py-2 text-left section-label"},"Model"),e("th",{class:"px-5 py-2 text-left section-label"},"Prompt"),e("th",{class:"px-5 py-2 text-left section-label"},"Expected"),e("th",{class:"px-5 py-2 text-left section-label"},"Actual"),e("th",{class:"px-5 py-2 text-right section-label"},"Hops"),e("th",{class:"px-5 py-2 text-right section-label"},"Score")])],-1)),e("tbody",null,[(r(!0),i(z,null,S($(c).evalResults,(s,v)=>{var y;return r(),i("tr",{key:v},[e("td",rs,a(s.model_name||s.model_id||""),1),e("td",is,a(ae(s.prompt||s.test_case_id||"",40)),1),e("td",ds,a(re(s.expected_tool)),1),e("td",{class:"px-5 py-2 text-xs font-mono",style:w({color:s.tool_selection_score>0?"var(--lime)":"var(--coral)"})},a(s.actual_tool||"(none)"),5),e("td",{class:"px-5 py-2 text-right text-xs font-mono text-zinc-500",title:s.tool_chain?s.tool_chain.map(h=>h.tool_name).join(" → "):""},a(s.multi_turn?((y=s.tool_chain)==null?void 0:y.length)||1:""),9,cs),e("td",{class:"px-5 py-2 text-right text-xs font-mono font-bold",style:w({color:ie(s.overall_score*100)})},a((s.overall_score*100).toFixed(0))+"% ",5)])}),128))])])])])):_("",!0),$(c).evalSummaries.length>0?(r(),H(Ne,{key:4,results:$(c).evalSummaries,onShowDetail:de},null,8,["results"])):_("",!0),ye(ht,{visible:D.value,"model-id":W.value,"all-results":$(c).evalResults,onClose:t[5]||(t[5]=s=>D.value=!1)},null,8,["visible","model-id","all-results"])]))}};export{ms as default};

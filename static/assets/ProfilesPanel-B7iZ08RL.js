import{o as K,c as n,x,d as s,f as c,F as _,A as g,g as H,t as d,h as f,z as M,v as k,l as D,P as Q,r as h,Q as W,K as G,b as i,M as I}from"./index-B7jY00Un.js";import{u as R}from"./profiles-CpxsFuoU.js";import{u as X}from"./config-D3Ijy1w7.js";import{u as Y}from"./promptLibrary-DEdGJ11d.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={key:0,class:"text-zinc-600 text-sm font-body"},te={key:1,class:"space-y-6"},se={class:"flex items-center justify-between"},oe={key:0,class:"card rounded-md px-5 py-8 text-center text-zinc-600 text-xs font-body"},re={class:"px-5 py-3 flex items-center justify-between",style:{"border-bottom":"1px solid var(--border-subtle)"}},ne=["title"],ie=["onClick"],le={class:"divide-y",style:{"border-color":"var(--border-subtle)"}},ae={class:"flex-1 min-w-0"},de={class:"flex items-center gap-2 flex-wrap"},pe={class:"text-xs font-body text-zinc-200"},ue={key:0,class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm",style:{background:"rgba(191,255,0,0.08)",color:"var(--lime)",border:"1px solid rgba(191,255,0,0.2)"}},ce={key:1,class:"text-[9px] font-body px-1.5 py-0.5 rounded-sm",style:{background:"rgba(168,85,247,0.08)",color:"#A855F7",border:"1px solid rgba(168,85,247,0.2)"},title:"Linked to prompt library version"},me={key:0,class:"text-[10px] text-zinc-600 font-body mt-0.5 truncate"},ye={key:1,class:"text-[10px] font-mono text-zinc-700 mt-0.5 truncate"},be={class:"text-[9px] text-zinc-700 font-body mt-0.5"},fe={class:"flex items-center gap-2 shrink-0"},ve=["onClick"],xe=["onClick"],_e=["onClick"],ge={class:"w-full max-w-lg rounded-md overflow-hidden",style:{background:"var(--surface)",border:"1px solid var(--border-subtle)"}},ke={class:"px-5 py-4",style:{"border-bottom":"1px solid var(--border-subtle)"}},he={class:"section-label"},we={class:"px-5 py-4 space-y-4 max-h-[70vh] overflow-y-auto"},Pe={key:0},ze=["value"],Ce={class:"flex items-center justify-between mb-1.5"},Se={class:"flex items-center gap-0",style:{border:"1px solid var(--border-subtle)","border-radius":"2px",overflow:"hidden"}},je={key:0,class:"space-y-2"},De=["value"],$e={key:0,class:"px-3 py-2 rounded-sm text-[10px] font-mono text-zinc-500 whitespace-pre-wrap break-all",style:{background:"rgba(0,0,0,0.2)",border:"1px solid var(--border-subtle)","max-height":"80px","overflow-y":"auto"}},Le={class:"flex items-center justify-between mb-2"},Me={class:"space-y-2"},Ve=["onUpdate:modelValue"],Ne=["onUpdate:modelValue"],Ae=["onClick"],Ue={key:0,class:"text-[10px] text-zinc-700 font-body"},Be={class:"flex items-center gap-2"},Fe={class:"px-5 py-4 flex items-center justify-end gap-3",style:{"border-top":"1px solid var(--border-subtle)"}},Oe=["disabled"],Ee={__name:"ProfilesPanel",setup(Te){const p=R(),z=X(),C=Y(),{showToast:m}=G(),{confirm:V}=I(),w=h(!1),b=h(null),P=h(!1),y=h("inline"),r=W({model_id:"",name:"",description:"",system_prompt:"",prompt_version_id:null,is_default:!1}),v=h([]);function S(o){if(!o)return{};if(typeof o=="object")return o;try{return JSON.parse(o)}catch{return{}}}function N(o){const e=S(o);return Object.entries(e).map(([a,t])=>`${a}=${t}`).join(", ")}function A(o){if(!o)return"";try{return new Date(o).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}catch{return o}}function U(o){const e={manual:"background:rgba(113,113,122,0.12);color:#71717A;border:1px solid rgba(113,113,122,0.2)",param_tuner:"background:rgba(56,189,248,0.08);color:#38BDF8;border:1px solid rgba(56,189,248,0.2)",prompt_tuner:"background:rgba(168,85,247,0.08);color:#A855F7;border:1px solid rgba(168,85,247,0.2)",import:"background:rgba(251,146,60,0.08);color:#FB923C;border:1px solid rgba(251,146,60,0.2)"};return e[o]||e.manual}function B(){v.value.push({key:"",value:""})}function F(o){v.value.splice(o,1)}function $(o=""){b.value=null,r.model_id=o,r.name="",r.description="",r.system_prompt="",r.prompt_version_id=null,r.is_default=!1,y.value="inline",v.value=[],w.value=!0}function O(o){b.value=o,r.name=o.name,r.description=o.description||"",r.is_default=!!o.is_default,r.prompt_version_id=o.prompt_version_id||null,o.prompt_version_id?(y.value="library",r.system_prompt=""):(y.value="inline",r.system_prompt=o.system_prompt||"");const e=S(o.params_json);v.value=Object.entries(e).map(([a,t])=>({key:a,value:String(t)})),w.value=!0}function j(){w.value=!1,b.value=null}function E(){const o={};for(const e of v.value){const a=e.key.trim();if(!a)continue;const t=e.value.trim();t==="true"?o[a]=!0:t==="false"?o[a]=!1:t!==""&&!isNaN(Number(t))?o[a]=Number(t):o[a]=t}return o}async function T(){if(!b.value&&!r.model_id.trim()){m("Model ID is required","error");return}if(!r.name.trim()){m("Name is required","error");return}P.value=!0;try{const o=E(),a=y.value==="library"?{prompt_version_id:r.prompt_version_id||null,system_prompt:null}:{system_prompt:r.system_prompt.trim()||null,prompt_version_id:null};b.value?(await p.updateProfile(b.value.id,{name:r.name.trim(),description:r.description.trim()||null,is_default:r.is_default,params_json:o,...a}),m("Profile updated","success")):(await p.createProfile({model_id:r.model_id.trim(),name:r.name.trim(),description:r.description.trim()||"",is_default:r.is_default,params_json:o,origin_type:"manual",...a}),m("Profile created","success")),j(),await p.fetchProfiles()}catch(o){m(o.message,"error")}finally{P.value=!1}}async function q(o){try{await p.setDefault(o.id),m("Default updated","success")}catch(e){m(e.message,"error")}}async function J(o){if(await V("Delete Profile",`Delete profile <strong>${o.name}</strong>? This cannot be undone.`,{danger:!0,confirmLabel:"Delete"}))try{await p.deleteProfile(o.id),m("Profile deleted","success")}catch(a){m(a.message,"error")}}return K(()=>{p.fetchProfiles(),z.config||z.loadConfig(),C.loadVersions()}),(o,e)=>{var a;return i(),n("div",null,[x(p).loading&&x(p).profiles.length===0?(i(),n("div",ee," Loading profiles... ")):(i(),n("div",te,[s("div",se,[e[13]||(e[13]=s("p",{class:"text-[11px] text-zinc-600 font-body"}," Profiles store saved parameter sets and system prompts for a model. ",-1)),s("button",{onClick:e[0]||(e[0]=t=>$()),class:"text-[10px] font-display tracking-wider uppercase px-3 py-1.5 rounded-sm transition-colors",style:{color:"var(--lime)",border:"1px solid rgba(191,255,0,0.2)"}}," + New Profile ")]),Object.keys(x(p).profilesByModel).length===0?(i(),n("div",oe," No profiles yet. Create one to save parameter sets and system prompts for a model. ")):c("",!0),(i(!0),n(_,null,g(x(p).profilesByModel,(t,u)=>(i(),n("div",{key:u,class:"card rounded-md overflow-hidden"},[s("div",re,[s("span",{class:"section-label truncate",title:u},d(u),9,ne),s("button",{onClick:l=>$(u),class:"text-[9px] font-display tracking-wider uppercase px-2 py-0.5 rounded-sm transition-colors text-zinc-500 hover:text-zinc-300",style:{border:"1px solid var(--border-subtle)"}},"+ Add",8,ie)]),s("div",le,[(i(!0),n(_,null,g(t,l=>(i(),n("div",{key:l.id,class:"px-5 py-3 flex items-start justify-between gap-4 group"},[s("div",ae,[s("div",de,[s("span",pe,d(l.name),1),l.is_default?(i(),n("span",ue,"DEFAULT")):c("",!0),s("span",{class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm",style:D(U(l.origin_type))},d(l.origin_type),5),l.prompt_version_id?(i(),n("span",ce,"Linked: "+d(l.prompt_version_label||"Library"),1)):c("",!0)]),l.description?(i(),n("p",me,d(l.description),1)):c("",!0),l.params_json&&Object.keys(S(l.params_json)).length>0?(i(),n("p",ye,d(N(l.params_json)),1)):c("",!0),s("p",be,d(A(l.created_at)),1)]),s("div",fe,[l.is_default?c("",!0):(i(),n("button",{key:0,onClick:L=>q(l),class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 hover:text-zinc-300 transition-colors"},"Set Default",8,ve)),s("button",{onClick:L=>O(l),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-200 transition-colors"},"Edit",8,xe),s("button",{onClick:L=>J(l),class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 hover:text-red-400 transition-colors"},"Delete",8,_e)])]))),128))])]))),128))])),w.value?(i(),n("div",{key:2,class:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{background:"rgba(0,0,0,0.6)"},onClick:e[12]||(e[12]=H(t=>j(),["self"]))},[s("div",ge,[s("div",ke,[s("span",he,d(b.value?"Edit Profile":"New Profile"),1)]),s("div",we,[b.value?c("",!0):(i(),n("div",Pe,[e[15]||(e[15]=s("label",{class:"field-label"},"Model *",-1)),f(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.model_id=t),class:"settings-input"},[e[14]||(e[14]=s("option",{value:"",disabled:""},"Select a model...",-1)),(i(!0),n(_,null,g(x(z).allModels,t=>(i(),n("option",{key:t.compoundKey,value:t.model_id},d(t.display_name||t.model_id)+" ("+d(t.provider)+") ",9,ze))),128))],512),[[M,r.model_id]])])),s("div",null,[e[16]||(e[16]=s("label",{class:"field-label"},"Name *",-1)),f(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.name=t),type:"text",placeholder:"e.g. High Accuracy",class:"settings-input"},null,512),[[k,r.name]])]),s("div",null,[e[17]||(e[17]=s("label",{class:"field-label"},"Description",-1)),f(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>r.description=t),type:"text",placeholder:"Optional description",class:"settings-input"},null,512),[[k,r.description]])]),s("div",null,[s("div",Ce,[e[18]||(e[18]=s("label",{class:"field-label",style:{"margin-bottom":"0"}},"System Prompt",-1)),s("div",Se,[s("button",{onClick:e[4]||(e[4]=t=>{y.value="library",r.system_prompt=""}),class:"text-[9px] font-display tracking-wider uppercase px-2 py-1 transition-colors",style:D(y.value==="library"?"background:rgba(168,85,247,0.15);color:#A855F7;":"background:transparent;color:#71717A;")},"Link from Library",4),s("button",{onClick:e[5]||(e[5]=t=>{y.value="inline",r.prompt_version_id=null}),class:"text-[9px] font-display tracking-wider uppercase px-2 py-1 transition-colors",style:D(y.value==="inline"?"background:rgba(191,255,0,0.08);color:var(--lime);":"background:transparent;color:#71717A;")},"Write Inline",4)])]),y.value==="library"?(i(),n("div",je,[f(s("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>r.prompt_version_id=t),class:"settings-input"},[e[19]||(e[19]=s("option",{value:null},"-- Select a prompt version --",-1)),(i(!0),n(_,null,g(x(C).versions,t=>{var u;return i(),n("option",{key:t.id,value:t.id},d(t.label||`#${t.version_number||((u=t.id)==null?void 0:u.slice(0,6))}`)+" ("+d(t.source||"manual")+")",9,De)}),128))],512),[[M,r.prompt_version_id]]),r.prompt_version_id?(i(),n("div",$e,d(((a=x(C).versions.find(t=>t.id===r.prompt_version_id))==null?void 0:a.prompt_text)||""),1)):c("",!0)])):f((i(),n("textarea",{key:1,"onUpdate:modelValue":e[7]||(e[7]=t=>r.system_prompt=t),rows:"3",placeholder:"Optional system prompt override",class:"w-full px-3 py-2 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none",resize:"vertical"}},null,512)),[[k,r.system_prompt]])]),s("div",null,[s("div",Le,[e[20]||(e[20]=s("label",{class:"field-label"},"Parameters",-1)),s("button",{onClick:e[8]||(e[8]=t=>B()),class:"text-[9px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 transition-colors"},"+ Add")]),s("div",Me,[(i(!0),n(_,null,g(v.value,(t,u)=>(i(),n("div",{key:u,class:"flex gap-2 items-center"},[f(s("input",{"onUpdate:modelValue":l=>t.key=l,type:"text",placeholder:"key",class:"settings-input flex-1"},null,8,Ve),[[k,t.key]]),f(s("input",{"onUpdate:modelValue":l=>t.value=l,type:"text",placeholder:"value",class:"settings-input flex-1"},null,8,Ne),[[k,t.value]]),s("button",{onClick:l=>F(u),class:"text-[10px] text-zinc-600 hover:text-red-400 transition-colors shrink-0"},"x",8,Ae)]))),128)),v.value.length===0?(i(),n("p",Ue,' No parameters. Click "+ Add" to add key-value pairs. ')):c("",!0)])]),s("div",Be,[f(s("input",{id:"is-default","onUpdate:modelValue":e[9]||(e[9]=t=>r.is_default=t),type:"checkbox",class:"accent-lime-400"},null,512),[[Q,r.is_default]]),e[21]||(e[21]=s("label",{for:"is-default",class:"text-xs font-body text-zinc-400 cursor-pointer"}," Set as default for this model ",-1))])]),s("div",Fe,[s("button",{onClick:e[10]||(e[10]=t=>j()),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 px-3 py-1.5 transition-colors"},"Cancel"),s("button",{onClick:e[11]||(e[11]=t=>T()),disabled:P.value,class:"text-[10px] font-display tracking-wider uppercase px-3 py-1.5 rounded-sm transition-colors disabled:opacity-50",style:{color:"var(--lime)",border:"1px solid rgba(191,255,0,0.2)"}},d(P.value?"Saving...":"Save"),9,Oe)])])])):c("",!0)])}}},We=Z(Ee,[["__scopeId","data-v-acb617c9"]]);export{We as default};

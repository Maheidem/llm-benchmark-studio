import{o as u,c as p,a as e,t as v,d as C,F as j,p as U,r as f,M as A,y as F,f as I,v as D,N as J,g as K,O,k as N,e as R,P as H,G as L,i as G,B as Q,q as W,l as X,m as Y,L as Z}from"./index-BxbfhC3f.js";import{a as P,u as ee}from"./useSharedContext-DRtY8wlt.js";const te={class:"card rounded-md overflow-hidden"},se={class:"w-full text-sm results-table"},oe={style:{"border-bottom":"1px solid var(--border-subtle)"}},ne={key:0},le={class:"px-5 py-3"},ae=["onClick"],ie={class:"px-5 py-3 text-center font-mono text-xs text-zinc-500"},re={class:"px-5 py-3 text-center font-mono text-xs text-zinc-500"},ce={class:"px-5 py-3 text-right text-xs text-zinc-600 font-body"},ue={class:"px-5 py-3 text-right"},de={class:"flex items-center justify-end gap-3"},pe=["onClick"],me=["onClick"],ve={__name:"SuiteTable",props:{suites:{type:Array,required:!0}},emits:["select","clone","delete","export"],setup(B){const x=B,b=f("name"),a=f(!0);function k(n){b.value===n?a.value=!a.value:(b.value=n,a.value=n==="name")}const w=F(()=>{const n=[...x.suites];return n.sort((i,r)=>{const c=i[b.value]??"",m=r[b.value]??"";return typeof c=="string"?a.value?c.localeCompare(m):m.localeCompare(c):a.value?c-m:m-c}),n});function _(n){return n?A(n):""}return(n,i)=>(u(),p("div",te,[e("table",se,[e("thead",null,[e("tr",oe,[e("th",{class:"px-5 py-3 text-left section-label cursor-pointer",onClick:i[0]||(i[0]=r=>k("name"))}," Name "+v(b.value==="name"?a.value?"▲":"▼":""),1),e("th",{class:"px-5 py-3 text-center section-label cursor-pointer",onClick:i[1]||(i[1]=r=>k("tool_count"))}," Tools "+v(b.value==="tool_count"?a.value?"▲":"▼":""),1),e("th",{class:"px-5 py-3 text-center section-label cursor-pointer",onClick:i[2]||(i[2]=r=>k("test_case_count"))}," Cases "+v(b.value==="test_case_count"?a.value?"▲":"▼":""),1),i[3]||(i[3]=e("th",{class:"px-5 py-3 text-right section-label"},"Last Updated",-1)),i[4]||(i[4]=e("th",{class:"px-5 py-3 text-right section-label"},null,-1))])]),e("tbody",null,[B.suites.length?C("",!0):(u(),p("tr",ne,[...i[5]||(i[5]=[e("td",{colspan:"5",class:"px-5 py-8 text-center text-zinc-600 text-sm font-body"},' No tool suites yet. Click "New Suite" to create one. ',-1)])])),(u(!0),p(j,null,U(w.value,r=>(u(),p("tr",{key:r.id},[e("td",le,[e("button",{onClick:c=>n.$emit("select",r.id),class:"text-zinc-200 hover:text-white font-body text-sm underline decoration-zinc-700 hover:decoration-zinc-400 transition-colors"},v(r.name||"Untitled"),9,ae)]),e("td",ie,v(r.tool_count||0),1),e("td",re,v(r.test_case_count||0),1),e("td",ce,v(_(r.updated_at)),1),e("td",ue,[e("div",de,[e("button",{onClick:c=>n.$emit("export",r.id),class:"text-zinc-700 hover:text-emerald-400 transition-colors text-xs font-display tracking-wider uppercase"},"Export",8,pe),e("button",{onClick:c=>n.$emit("delete",r.id,r.name),class:"text-zinc-700 hover:text-red-400 transition-colors text-xs font-display tracking-wider uppercase"},"Delete",8,me)])])]))),128))])])]))}},xe={class:"modal-box",style:{"max-width":"640px","max-height":"80vh","overflow-y":"auto"}},fe={class:"flex items-center justify-between mb-4"},be={key:0},ye={class:"mb-3"},he={key:0,class:"text-xs mb-3",style:{color:"var(--coral)"}},ke={key:1,class:"text-xs text-zinc-500 mb-3"},we={class:"modal-buttons"},_e=["disabled"],ge={key:1},$e={class:"text-xs text-zinc-500 mb-3 font-body"},Ce={class:"mb-3"},ze={class:"mb-3"},Se={class:"flex items-center gap-2 mb-3"},Me={class:"space-y-2 mb-4",style:{"max-height":"300px","overflow-y":"auto"}},Be=["onUpdate:modelValue"],Ee={class:"flex-1 min-w-0"},Ie={class:"text-sm text-zinc-200 font-mono"},Ne={class:"text-xs text-zinc-500 mt-0.5"},Ve={key:0,class:"text-xs text-zinc-600 mt-1"},Te={class:"text-zinc-500"},De={class:"text-zinc-700"},je={key:0},Ue={class:"flex items-center gap-2 mb-4 text-xs text-zinc-500 cursor-pointer"},Oe={class:"modal-buttons"},Fe=["disabled"],Le={__name:"McpImportModal",props:{visible:{type:Boolean,default:!1}},emits:["close","imported"],setup(B,{emit:x}){const b=x,a=P(),{showToast:k}=L(),w=f(1),_=f(""),n=f(""),i=f(!1),r=f(""),c=f([]),m=H({}),z=f(""),S=f(""),E=f(!0),l=f(!1),o=F(()=>Object.values(m).filter(Boolean).length);async function y(){const d=_.value.trim();if(!d){n.value="Enter a server URL";return}n.value="",i.value=!0;try{const t=await a.mcpDiscover(d);c.value=t.tools||[],r.value=`Connected to: ${t.server_name} (${t.tool_count} tool${t.tool_count!==1?"s":""} found)`,c.value.forEach((h,T)=>{m[T]=!0});const s=c.value.slice(0,3).map(h=>h.name),g=c.value.length>3?"...":"";z.value=`MCP: ${s.join(", ")}${g}`,S.value=`Imported from MCP server: ${d}`,w.value=2}catch(t){n.value=t.message||"Connection failed"}finally{i.value=!1}}function M(d){c.value.forEach((t,s)=>{m[s]=d})}function $(d){const t=(d.inputSchema||{}).properties||{},s=(d.inputSchema||{}).required||[];return Object.entries(t).map(([g,h])=>({name:g,type:h.type||"?",required:s.includes(g)}))}async function V(){const d=c.value.filter((t,s)=>m[s]);if(!d.length){k("Select at least one tool","error");return}l.value=!0;try{const t=await a.mcpImport({suite_name:z.value.trim(),suite_description:S.value.trim(),tools:d,generate_test_cases:E.value});k(`Imported ${t.tools_imported} tool(s)${t.test_cases_generated?` with ${t.test_cases_generated} test case(s)`:""}`,"success"),b("imported",t.suite_id),b("close"),q()}catch(t){k("Import failed: "+t.message,"error")}finally{l.value=!1}}function q(){w.value=1,_.value="",n.value="",c.value=[],Object.keys(m).forEach(d=>delete m[d]),z.value="",S.value=""}return(d,t)=>B.visible?(u(),p("div",{key:0,class:"modal-overlay",onClick:t[9]||(t[9]=R(s=>d.$emit("close"),["self"]))},[e("div",xe,[e("div",fe,[t[10]||(t[10]=e("div",{class:"modal-title"},"Import from MCP Server",-1)),e("button",{onClick:t[0]||(t[0]=s=>d.$emit("close")),class:"text-zinc-600 hover:text-zinc-400 text-lg"},"×")]),w.value===1?(u(),p("div",be,[t[11]||(t[11]=e("div",{class:"modal-message"},"Enter the URL of an MCP-compatible server to discover available tools.",-1)),e("div",ye,[I(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>_.value=s),class:"modal-input",placeholder:"https://your-server.com/mcp",onKeydown:J(y,["enter"])},null,544),[[D,_.value]])]),n.value?(u(),p("div",he,v(n.value),1)):C("",!0),i.value?(u(),p("div",ke,"Connecting...")):C("",!0),e("div",we,[e("button",{onClick:t[2]||(t[2]=s=>d.$emit("close")),class:"modal-btn modal-btn-cancel"},"Cancel"),e("button",{onClick:y,disabled:i.value,class:"modal-btn modal-btn-confirm"},v(i.value?"Connecting...":"Connect"),9,_e)])])):C("",!0),w.value===2?(u(),p("div",ge,[e("div",$e,v(r.value),1),e("div",Ce,[t[12]||(t[12]=e("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Suite Name",-1)),I(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>z.value=s),class:"modal-input",style:{"margin-bottom":"8px"}},null,512),[[D,z.value]])]),e("div",ze,[t[13]||(t[13]=e("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Description",-1)),I(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>S.value=s),class:"modal-input",style:{"margin-bottom":"8px"}},null,512),[[D,S.value]])]),e("div",Se,[e("button",{onClick:t[5]||(t[5]=s=>M(!0)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Select All"),e("button",{onClick:t[6]||(t[6]=s=>M(!1)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Deselect All")]),e("div",Me,[(u(!0),p(j,null,U(c.value,(s,g)=>(u(),p("label",{key:g,class:"flex gap-3 p-3 rounded cursor-pointer",style:K([{border:"1px solid var(--border-subtle)"},{background:m[g]?"rgba(191,255,0,0.04)":"transparent"}])},[I(e("input",{type:"checkbox","onUpdate:modelValue":h=>m[g]=h,class:"mt-1 accent-lime-400"},null,8,Be),[[O,m[g]]]),e("div",Ee,[e("div",Ie,v(s.name),1),e("div",Ne,v(s.description),1),$(s).length?(u(),p("div",Ve,[t[14]||(t[14]=N(" Params: ",-1)),(u(!0),p(j,null,U($(s),(h,T)=>(u(),p("span",{key:T},[e("span",Te,v(h.name),1),e("span",De," ("+v(h.type)+v(h.required?", required":", optional")+")",1),T<$(s).length-1?(u(),p("span",je,", ")):C("",!0)]))),128))])):C("",!0)])],4))),128))]),e("label",Ue,[I(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=s=>E.value=s),class:"accent-lime-400"},null,512),[[O,E.value]]),t[15]||(t[15]=e("span",null,"Auto-generate test cases",-1))]),e("div",Oe,[e("button",{onClick:t[8]||(t[8]=s=>w.value=1),class:"modal-btn modal-btn-cancel"},"Back"),e("button",{onClick:V,disabled:l.value||o.value===0,class:"modal-btn modal-btn-confirm"},v(l.value?"Importing...":`Import ${o.value} Tool${o.value!==1?"s":""}`),9,Fe)])])):C("",!0)])])):C("",!0)}},Pe={class:"flex items-center justify-between mb-6"},qe={class:"flex items-center gap-2 flex-wrap"},Ae={key:0,class:"text-center text-zinc-600 text-sm font-body py-8"},Re={__name:"SuitesView",setup(B){const x=P(),b=Y(),{showToast:a}=L(),{confirm:k}=Z(),{setSuite:w}=ee(),_=f(!0),n=f(!1);G(async()=>{try{await x.loadSuites()}catch{a("Failed to load suites","error")}finally{_.value=!1}});async function i(){try{const l=await x.createSuite({name:"New Suite",description:"",tools:[]});a("Suite created","success"),r(l.suite_id)}catch(l){a(l.message||"Failed to create suite","error")}}function r(l){const o=x.suites.find(y=>y.id===l);o&&w(l,o.name),b.push({name:"ToolEvalEditor",params:{id:l}})}async function c(l){try{await x.exportSuite(l),a("Suite exported","success")}catch{a("Failed to export suite","error")}}async function m(l,o){if(await k("Delete Suite",`Delete "${o}" and all its test cases? This cannot be undone.`,{danger:!0,confirmLabel:"Delete"}))try{await x.deleteSuite(l),a("Suite deleted","success")}catch{a("Failed to delete","error")}}function z(){const l=document.createElement("input");l.type="file",l.accept=".json",l.onchange=async o=>{const y=o.target.files[0];if(y)try{const M=await y.text(),$=JSON.parse(M);if(!$.name||typeof $.name!="string"){a('Invalid JSON: missing "name" field',"error");return}const V=await x.importSuite($);a(`Imported "${$.name}" with ${V.test_cases_created} test cases`,"success"),await x.loadSuites(),r(V.suite_id)}catch(M){a("Failed to import: "+(M.message||"invalid JSON"),"error")}},l.click()}async function S(){try{await x.downloadImportExample()}catch{a("Failed to download example","error")}}async function E(l){await x.loadSuites(),r(l)}return(l,o)=>(u(),p("div",null,[e("div",Pe,[o[6]||(o[6]=e("div",null,[e("h2",{class:"font-display font-bold text-lg text-zinc-100 mb-1"},"Tool Calling Evaluation"),e("p",{class:"text-sm text-zinc-600 font-body"},"Define tool suites, create test cases, and evaluate model accuracy.")],-1)),e("div",qe,[e("button",{onClick:i,class:"run-btn px-4 py-2 rounded-sm text-xs whitespace-nowrap flex items-center gap-2"},[...o[2]||(o[2]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2.5",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),N(" New Suite ",-1)])]),e("button",{onClick:z,class:"px-4 py-2 rounded-sm text-xs font-display whitespace-nowrap flex items-center gap-2 border border-zinc-700 text-zinc-400 hover:text-zinc-200 hover:border-zinc-500 transition-colors"},[...o[3]||(o[3]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),N(" Import Suite ",-1)])]),e("button",{onClick:S,class:"px-4 py-2 rounded-sm text-xs font-display whitespace-nowrap flex items-center gap-2 border border-zinc-700 text-zinc-500 hover:text-zinc-300 hover:border-zinc-500 transition-colors",title:"Download example JSON template for import"},[...o[4]||(o[4]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),N(" Example JSON ",-1)])]),e("button",{onClick:o[0]||(o[0]=y=>n.value=!0),class:"px-4 py-2 rounded-sm text-xs font-display whitespace-nowrap flex items-center gap-2 border border-zinc-700 text-zinc-400 hover:text-zinc-200 hover:border-zinc-500 transition-colors"},[...o[5]||(o[5]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),N(" Import from MCP ",-1)])])])]),_.value?(u(),p("div",Ae,"Loading suites...")):(u(),Q(ve,{key:1,suites:W(x).suites,onSelect:r,onExport:c,onDelete:m},null,8,["suites"])),X(Le,{visible:n.value,onClose:o[1]||(o[1]=y=>n.value=!1),onImported:E},null,8,["visible"])]))}};export{Re as default};

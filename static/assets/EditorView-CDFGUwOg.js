import{b as r,c as i,d as o,t as _,f as m,F as U,A as Z,G as D,k as L,w as re,h as b,v as $,P as B,m as ie,z as W,Q as de,r as h,o as ue,i as J,j as R,B as X,K as ce,q as pe,C as me,M as xe}from"./index-BMBAIBBO.js";import{a as fe,u as ve}from"./useSharedContext-DdThRwA2.js";const be={class:"flex items-center justify-between mb-3"},ye={class:"flex items-center gap-2"},ge={class:"text-xs font-mono text-zinc-600"},ke={class:"flex items-center gap-2"},_e={key:0,class:"text-zinc-600 text-xs font-body"},we={key:1,class:"flex flex-col gap-2"},$e={class:"flex items-center justify-between px-3 py-2 rounded-sm",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)"}},Te={class:"flex-1 min-w-0"},Ce={class:"text-sm font-mono text-zinc-200"},he={class:"text-xs text-zinc-600 ml-2 font-body"},ze={key:0,class:"text-[10px] text-zinc-700 font-mono mt-0.5"},Se={class:"flex gap-2 ml-3 flex-shrink-0"},Ne=["onClick"],je=["onClick"],Ee={__name:"ToolsList",props:{tools:{type:Array,required:!0},suiteId:{type:String,default:""}},emits:["addTool","editTool","deleteTool","importTools","exportTools"],setup(T){function E(g){var e,u;const c=(u=(e=g.function)==null?void 0:e.parameters)==null?void 0:u.properties;return c?Object.keys(c):[]}return(g,c)=>(r(),i("div",null,[o("div",be,[o("div",ye,[c[3]||(c[3]=o("span",{class:"section-label"},"Tools",-1)),o("span",ge,"("+_(T.tools.length)+")",1)]),o("div",ke,[o("button",{onClick:c[0]||(c[0]=e=>g.$emit("importTools")),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 px-2 py-1 rounded-sm border border-zinc-800 hover:border-zinc-600 transition-colors"},"Import JSON"),T.tools.length>0?(r(),i("button",{key:0,onClick:c[1]||(c[1]=e=>g.$emit("exportTools")),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 px-2 py-1 rounded-sm border border-zinc-800 hover:border-zinc-600 transition-colors"},"Export")):m("",!0),o("button",{onClick:c[2]||(c[2]=e=>g.$emit("addTool")),class:"text-[10px] font-display tracking-wider uppercase px-2 py-1 rounded-sm transition-colors",style:{color:"var(--lime)",border:"1px solid rgba(191,255,0,0.2)",background:"rgba(191,255,0,0.06)"}},"+ Add Tool")])]),T.tools.length?(r(),i("div",we,[(r(!0),i(U,null,Z(T.tools,(e,u)=>{var p,n;return r(),i(U,{key:u},[o("div",$e,[o("div",Te,[o("span",Ce,_(((p=e.function)==null?void 0:p.name)||"unnamed"),1),o("span",he,_(((n=e.function)==null?void 0:n.description)||""),1),E(e).length?(r(),i("div",ze," params: "+_(E(e).join(", ")),1)):m("",!0)]),o("div",Se,[o("button",{onClick:t=>g.$emit("editTool",u),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Edit",8,Ne),o("button",{onClick:t=>g.$emit("deleteTool",u),class:"text-[10px] font-display tracking-wider uppercase text-zinc-700 hover:text-red-400"},"Delete",8,je)])]),D(g.$slots,"editor",{index:u})],64)}),128))])):(r(),i("div",_e," No tools defined yet. ")),D(g.$slots,"add-editor")]))}},Me={class:"flex items-center justify-between mb-3"},Oe={class:"flex items-center gap-2"},Ae={class:"text-xs font-mono text-zinc-600"},Ve={key:0,class:"text-zinc-600 text-xs font-body"},Ue={key:1,class:"flex flex-col gap-2"},Je={class:"flex items-start justify-between px-3 py-2 rounded-sm",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)"}},Re={class:"flex-1 min-w-0"},De={class:"text-sm text-zinc-300 font-body mb-0.5"},Le={key:0,class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm ml-2",style:{color:"var(--lime)",background:"rgba(191,255,0,0.08)",border:"1px solid rgba(191,255,0,0.15)"}},Be={key:1,class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm ml-2",style:{color:"#38BDF8",background:"rgba(56,189,248,0.08)",border:"1px solid rgba(56,189,248,0.15)"},title:"Model should NOT call any tool (irrelevance test)"},qe=["title"],Fe={class:"text-xs font-mono text-zinc-500"},Pe={key:0,class:"ml-1"},Ie={class:"flex gap-2 ml-3 flex-shrink-0 mt-1"},He=["onClick"],Ge=["onClick"],Ke={__name:"TestCasesList",props:{testCases:{type:Array,required:!0},tools:{type:Array,default:()=>[]}},emits:["addCase","editCase","deleteCase"],setup(T){function E(e,u){return e?e.length>u?e.slice(0,u)+"...":e:""}function g(e){return e==null?"(no tool call)":Array.isArray(e)?e.join(" | "):e}function c(e){return!e||typeof e!="object"?"":Object.entries(e).map(([u,p])=>`${u}=${JSON.stringify(p)}`).join(", ")}return(e,u)=>(r(),i("div",null,[o("div",Me,[o("div",Oe,[u[1]||(u[1]=o("span",{class:"section-label"},"Test Cases",-1)),o("span",Ae,"("+_(T.testCases.length)+")",1)]),o("button",{onClick:u[0]||(u[0]=p=>e.$emit("addCase")),class:"text-[10px] font-display tracking-wider uppercase px-2 py-1 rounded-sm transition-colors",style:{color:"var(--lime)",border:"1px solid rgba(191,255,0,0.2)",background:"rgba(191,255,0,0.06)"}},"+ Add Test Case")]),T.testCases.length?(r(),i("div",Ue,[(r(!0),i(U,null,Z(T.testCases,(p,n)=>{var t;return r(),i(U,{key:p.id||n},[o("div",Je,[o("div",Re,[o("div",De,[L(" #"+_(n+1)+' "'+_(E(p.prompt,80))+'" ',1),p.multi_turn?(r(),i("span",Le,"MULTI-TURN")):m("",!0),p.should_call_tool===!1?(r(),i("span",Be,"IRRELEVANCE")):m("",!0),(t=p.scoring_config)!=null&&t.mode&&p.scoring_config.mode!=="exact"?(r(),i("span",{key:2,class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm ml-2",style:{color:"#60A5FA",background:"rgba(96,165,250,0.08)",border:"1px solid rgba(96,165,250,0.15)"},title:"Scoring: "+p.scoring_config.mode},_(p.scoring_config.mode.replace("_"," ").toUpperCase()),9,qe)):m("",!0)]),o("div",Fe,[L(" Expected: "+_(g(p.expected_tool))+" ",1),p.expected_params?(r(),i("span",Pe," ("+_(c(p.expected_params))+") ",1)):m("",!0)])]),o("div",Ie,[o("button",{onClick:a=>e.$emit("editCase",p.id),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Edit",8,He),o("button",{onClick:a=>e.$emit("deleteCase",p.id),class:"text-[10px] font-display tracking-wider uppercase text-zinc-700 hover:text-red-400"},"Delete",8,Ge)])]),D(e.$slots,"editor",{caseItem:p,index:n})],64)}),128))])):(r(),i("div",Ve," No test cases defined yet. ")),D(e.$slots,"add-editor")]))}},Qe={class:"card rounded-md p-5"},We={class:"flex items-center justify-between mb-4"},Xe={class:"section-label"},Ye={class:"mb-4"},Ze={class:"mb-4"},et={class:"flex items-center gap-2 cursor-pointer"},tt={key:0,class:"text-[10px] text-zinc-600 font-body mt-0.5 ml-5"},ot={key:0,class:"mb-4"},st={class:"flex items-center gap-3 mb-1"},lt={class:"flex items-center gap-1.5 text-xs text-zinc-500 cursor-pointer"},nt=["disabled"],at={key:1,class:"mb-4"},rt={class:"mb-4"},it={key:2,class:"mb-4"},dt={class:"flex items-center gap-3"},ut={key:0,class:"flex items-center gap-1"},ct={class:"mb-4"},pt={class:"flex items-center gap-2 cursor-pointer"},mt={key:3,class:"mb-4 pl-4",style:{"border-left":"2px solid var(--border-subtle)"}},xt={class:"flex gap-4 mb-3"},ft={class:"mb-3"},vt={class:"mt-3"},bt={key:4,class:"text-xs mb-3",style:{color:"var(--coral)"}},yt={class:"flex justify-end gap-2"},Y={__name:"TestCaseForm",props:{testCase:{type:Object,default:null},editing:{type:Boolean,default:!1}},emits:["save","cancel"],setup(T,{emit:E}){const g=T,c=E,e=de({prompt:"",expectedTool:"",noTool:!1,shouldCallTool:!0,expectedParams:"",scoringMode:"exact",epsilon:.01,category:"",multiTurn:!1,maxRounds:5,optimalHops:2,prerequisites:"",mockResponses:"",argumentSource:"user"}),u=h("");re(()=>g.testCase,n=>{if(!n)return;e.prompt=n.prompt||"",e.shouldCallTool=n.should_call_tool!==!1;const t=n.expected_tool===null||n.expected_tool===void 0;e.noTool=t,t?e.expectedTool="":Array.isArray(n.expected_tool)?e.expectedTool=n.expected_tool.join(", "):e.expectedTool=n.expected_tool||"",e.expectedParams=n.expected_params?JSON.stringify(n.expected_params,null,2):"";const a=n.scoring_config||{};e.scoringMode=a.mode||"exact",e.epsilon=a.epsilon??.01,e.category=n.category||"",e.multiTurn=!!n.multi_turn,e.maxRounds=n.max_rounds||5,e.optimalHops=n.optimal_hops||2,e.prerequisites=(n.valid_prerequisites||[]).join(", "),e.mockResponses=n.mock_responses?JSON.stringify(n.mock_responses,null,2):"",e.argumentSource=n.argument_source||"user"},{immediate:!0});function p(){u.value="";const n=e.prompt.trim();if(!n){u.value="Prompt is required";return}let t=null;if(e.shouldCallTool&&!e.noTool){const x=e.expectedTool.trim();if(!x){u.value='Expected tool is required (or uncheck "Model should call a tool")';return}if(x.includes(",")){if(t=x.split(",").map(k=>k.trim()).filter(Boolean),!t.length){u.value="Enter at least one tool name";return}}else t=x}let a=null;if(e.shouldCallTool){const x=e.expectedParams.trim();if(x)try{if(a=JSON.parse(x),typeof a!="object"||Array.isArray(a)){u.value="Expected params must be a JSON object";return}}catch(k){u.value="Invalid JSON in expected params: "+k.message;return}}const y={prompt:n,expected_tool:t,expected_params:a,should_call_tool:e.shouldCallTool};if(e.category.trim()&&(y.category=e.category.trim()),e.shouldCallTool&&e.scoringMode&&e.scoringMode!=="exact"){const x={mode:e.scoringMode};e.scoringMode==="numeric_tolerance"&&(x.epsilon=e.epsilon||.01),y.scoring_config=x}else y.scoring_config=null;if(e.multiTurn){y.multi_turn=!0,y.max_rounds=e.maxRounds||5,y.optimal_hops=e.optimalHops||2;const x=e.prerequisites.trim();y.valid_prerequisites=x?x.split(",").map(N=>N.trim()).filter(Boolean):[];const k=e.mockResponses.trim();if(k)try{y.mock_responses=JSON.parse(k)}catch(N){u.value="Invalid JSON in mock responses: "+N.message;return}y.argument_source=e.argumentSource||"user"}else y.multi_turn=!1;c("save",y)}return(n,t)=>(r(),i("div",Qe,[o("div",We,[o("span",Xe,_(T.editing?"Edit Test Case":"New Test Case"),1),o("button",{onClick:t[0]||(t[0]=a=>n.$emit("cancel")),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Cancel")]),o("div",Ye,[t[16]||(t[16]=o("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"User Message",-1)),b(o("textarea",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.prompt=a),rows:"3",class:"w-full px-3 py-2 rounded-sm text-sm text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace","font-size":"12px",resize:"vertical"},placeholder:"Enter the user prompt..."},null,512),[[$,e.prompt]])]),o("div",Ze,[o("label",et,[b(o("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=a=>e.shouldCallTool=a),class:"accent-lime-400"},null,512),[[B,e.shouldCallTool]]),t[17]||(t[17]=o("span",{class:"text-xs font-display tracking-wider uppercase text-zinc-500"},"Model should call a tool",-1))]),e.shouldCallTool?m("",!0):(r(),i("p",tt," Irrelevance test — correct answer is to NOT call any tool (abstain). "))]),e.shouldCallTool?(r(),i("div",ot,[o("div",st,[t[19]||(t[19]=o("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500"},"Expected Tool",-1)),o("label",lt,[b(o("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=a=>e.noTool=a),class:"accent-lime-400"},null,512),[[B,e.noTool]]),t[18]||(t[18]=o("span",{class:"text-[10px]"},"No tool expected",-1))])]),b(o("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>e.expectedTool=a),disabled:e.noTool,class:"w-full px-3 py-1.5 rounded-sm text-sm font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"tool_name (comma-separated for alternatives)"},null,8,nt),[[$,e.expectedTool]])])):m("",!0),e.shouldCallTool?(r(),i("div",at,[t[20]||(t[20]=o("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Expected Parameters (JSON)",-1)),b(o("textarea",{"onUpdate:modelValue":t[5]||(t[5]=a=>e.expectedParams=a),rows:"3",class:"w-full px-3 py-2 rounded-sm text-sm text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace","font-size":"12px",resize:"vertical"},placeholder:'{"city": "Paris"}'},null,512),[[$,e.expectedParams]])])):m("",!0),o("div",rt,[t[21]||(t[21]=o("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Category (optional)",-1)),b(o("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>e.category=a),class:"w-full px-3 py-1.5 rounded-sm text-sm font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"e.g. retrieval, math, calendar, nested",list:"category-suggestions"},null,512),[[$,e.category]]),t[22]||(t[22]=ie('<datalist id="category-suggestions"><option value="retrieval"></option><option value="math"></option><option value="calendar"></option><option value="nested"></option><option value="multi-step"></option><option value="filtering"></option><option value="creation"></option></datalist>',1))]),e.shouldCallTool?(r(),i("div",it,[t[25]||(t[25]=o("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Scoring Mode",-1)),o("div",dt,[b(o("select",{"onUpdate:modelValue":t[7]||(t[7]=a=>e.scoringMode=a),class:"text-xs font-mono px-3 py-1.5 rounded-sm",style:{background:"var(--surface)",border:"1px solid var(--border-subtle)",color:"#A1A1AA",outline:"none",width:"180px"}},[...t[23]||(t[23]=[o("option",{value:"exact"},"Exact Match",-1),o("option",{value:"subset"},"Subset Match",-1),o("option",{value:"numeric_tolerance"},"Numeric Tolerance",-1),o("option",{value:"case_insensitive"},"Case Insensitive",-1)])],512),[[W,e.scoringMode]]),e.scoringMode==="numeric_tolerance"?(r(),i("div",ut,[t[24]||(t[24]=o("span",{class:"text-[10px] text-zinc-600"},"Epsilon:",-1)),b(o("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>e.epsilon=a),type:"number",step:"0.001",min:"0",class:"w-20 px-2 py-1 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,512),[[$,e.epsilon,void 0,{number:!0}]])])):m("",!0)])])):m("",!0),o("div",ct,[o("label",pt,[b(o("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=a=>e.multiTurn=a),class:"accent-lime-400"},null,512),[[B,e.multiTurn]]),t[26]||(t[26]=o("span",{class:"text-xs font-display tracking-wider uppercase text-zinc-500"},"Multi-Turn",-1))])]),e.multiTurn?(r(),i("div",mt,[o("div",xt,[o("div",null,[t[27]||(t[27]=o("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Max Rounds",-1)),b(o("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>e.maxRounds=a),type:"number",min:"1",max:"20",class:"w-16 px-2 py-1 rounded-sm text-xs font-mono text-zinc-200 text-center",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,512),[[$,e.maxRounds,void 0,{number:!0}]])]),o("div",null,[t[28]||(t[28]=o("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Optimal Hops",-1)),b(o("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>e.optimalHops=a),type:"number",min:"1",max:"20",class:"w-16 px-2 py-1 rounded-sm text-xs font-mono text-zinc-200 text-center",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,512),[[$,e.optimalHops,void 0,{number:!0}]])])]),o("div",ft,[t[29]||(t[29]=o("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Valid Prerequisites (comma-separated)",-1)),b(o("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>e.prerequisites=a),class:"w-full px-3 py-1.5 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"tool_a, tool_b"},null,512),[[$,e.prerequisites]])]),o("div",null,[t[30]||(t[30]=o("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Mock Responses (JSON)",-1)),b(o("textarea",{"onUpdate:modelValue":t[13]||(t[13]=a=>e.mockResponses=a),rows:"3",class:"w-full px-3 py-2 rounded-sm text-xs text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace",resize:"vertical"},placeholder:'{"tool_a": {"status": "ok", "data": []}}'},null,512),[[$,e.mockResponses]])]),o("div",vt,[t[32]||(t[32]=o("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Argument Source",-1)),b(o("select",{"onUpdate:modelValue":t[14]||(t[14]=a=>e.argumentSource=a),class:"text-xs font-mono px-3 py-1.5 rounded-sm",style:{background:"var(--surface)",border:"1px solid var(--border-subtle)",color:"#A1A1AA",outline:"none",width:"220px"}},[...t[31]||(t[31]=[o("option",{value:"user"},"user (default — args from user message)",-1),o("option",{value:"previous_tool"},"previous_tool (args from prior tool output)",-1),o("option",{value:"inferred"},"inferred (args from conversation context)",-1)])],512),[[W,e.argumentSource]]),t[33]||(t[33]=o("p",{class:"text-[10px] text-zinc-600 font-body mt-0.5"}," Describes how arguments for the next tool call should be sourced. ",-1))])])):m("",!0),u.value?(r(),i("div",bt,_(u.value),1)):m("",!0),o("div",yt,[o("button",{onClick:t[15]||(t[15]=a=>n.$emit("cancel")),class:"modal-btn modal-btn-cancel text-xs"},"Cancel"),o("button",{onClick:p,class:"modal-btn modal-btn-confirm text-xs"},"Save")])]))}},gt={class:"flex items-center justify-between mb-4"},kt={key:0,class:"text-center text-zinc-600 text-sm font-body py-8"},_t={class:"card rounded-md p-5 mb-6"},wt={class:"flex items-center gap-4 mb-3"},$t={class:"flex-1"},Tt={key:0,class:"flex items-center gap-3 px-4 py-2.5 rounded-md mb-6",style:{background:"rgba(168,85,247,0.06)",border:"1px solid rgba(168,85,247,0.2)"}},Ct={class:"text-xs font-body text-zinc-400 flex-1 truncate"},ht={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},zt={class:"card rounded-md p-5"},St={key:0,class:"mt-2 mb-2"},Nt={class:"flex items-center justify-between mb-2"},jt={key:0,class:"text-xs mt-1",style:{color:"var(--coral)"}},Et={class:"flex justify-end gap-2 mt-2"},Mt={key:0,class:"mt-4"},Ot={class:"flex items-center justify-between mb-2"},At={key:0,class:"text-xs mt-1",style:{color:"var(--coral)"}},Vt={class:"flex justify-end gap-2 mt-2"},Ut={class:"card rounded-md p-5"},Jt={key:0,class:"mt-2 mb-2"},Rt={key:0,class:"mt-4"},Bt={__name:"EditorView",setup(T){const E=me(),g=pe(),c=fe(),{showToast:e}=ce(),{confirm:u}=xe(),{setSuite:p}=ve(),n=X(()=>E.params.id),t=X(()=>c.currentSuite),a=h(!0),y=h(""),x=h(""),k=h(!1),N=h(-1),M=h(""),z=h(""),A=h(!1),O=h(null),V=h(null);ue(async()=>{var l,s;try{await c.loadSuite(n.value),y.value=((l=t.value)==null?void 0:l.name)||"",x.value=((s=t.value)==null?void 0:s.description)||"",t.value&&p(t.value.id,t.value.name)}catch{e("Failed to load suite","error"),g.push({name:"ToolEvalSuites"})}finally{a.value=!1}});function ee(l,s){return l?l.length>s?l.slice(0,s)+"...":l:""}async function q(){const l=y.value.trim();if(!l){e("Name is required","error");return}try{await c.updateSuite(n.value,{name:l,description:x.value.trim()}),t.value&&(t.value.name=l,t.value.description=x.value.trim(),p(t.value.id,l))}catch{e("Failed to save","error")}}async function te(){try{await c.patchSuite(n.value,{system_prompt:""}),t.value&&(t.value.system_prompt=null),e("System prompt cleared","success")}catch{e("Failed to clear system prompt","error")}}function F(l){N.value=l,z.value="",l>=0?M.value=JSON.stringify(t.value.tools[l],null,2):M.value=JSON.stringify({type:"function",function:{name:"my_tool",description:"Description of what this tool does",parameters:{type:"object",properties:{},required:[]}}},null,2),k.value=!0}async function P(){var d,f;z.value="";let l;try{l=JSON.parse(M.value.trim())}catch(C){z.value="Invalid JSON: "+C.message;return}if(!l||typeof l!="object"){z.value="Tool must be a JSON object";return}if(l.type!=="function"){z.value='tool.type must be "function"';return}if(!((d=l.function)!=null&&d.name)){z.value="tool.function.name is required";return}const s=[...((f=t.value)==null?void 0:f.tools)||[]];N.value>=0?s[N.value]=l:s.push(l);try{await c.updateSuite(n.value,{tools:s}),t.value.tools=s,k.value=!1,e("Tool saved","success")}catch{e("Failed to save tools","error")}}async function oe(l){var C,v,w,S;const s=((w=(v=(C=t.value)==null?void 0:C.tools)==null?void 0:v[l])==null?void 0:w.function)||{};if(!await u("Delete Tool",`Delete "${s.name||"unnamed"}"?`,{danger:!0,confirmLabel:"Delete"}))return;const f=[...((S=t.value)==null?void 0:S.tools)||[]];f.splice(l,1);try{await c.updateSuite(n.value,{tools:f}),t.value.tools=f,e("Tool deleted","success")}catch{e("Failed to delete tool","error")}}function se(){var f;const l=((f=t.value)==null?void 0:f.tools)||[];if(!l.length){e("No tools to export","error");return}const s=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),d=document.createElement("a");d.href=URL.createObjectURL(s),d.download=`${(t.value.name||"tools").replace(/[^a-z0-9]+/gi,"_").toLowerCase()}_tools.json`,d.click(),URL.revokeObjectURL(d.href)}function le(){if(!t.value)return;const l=t.value.tools||[],s=t.value.test_cases||[];if(!s.length){e("No test cases to export","error");return}const d=s.map((v,w)=>{const S={id:v.id||`case_${w+1}`,question:[[{role:"user",content:v.prompt||""}]],function:l.map(j=>{var G,K,Q;return{name:((G=j.function)==null?void 0:G.name)||"",description:((K=j.function)==null?void 0:K.description)||"",parameters:((Q=j.function)==null?void 0:Q.parameters)||{}}})};return v.should_call_tool!==!1&&v.expected_tool?S.ground_truth=[{name:Array.isArray(v.expected_tool)?v.expected_tool[0]:v.expected_tool,arguments:v.expected_params||{}}]:v.should_call_tool===!1&&(S.ground_truth=[]),v.category&&(S.category=v.category),S}),f=new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),C=document.createElement("a");C.href=URL.createObjectURL(f),C.download=`${(t.value.name||"suite").replace(/[^a-z0-9]+/gi,"_").toLowerCase()}_bfcl.json`,C.click(),URL.revokeObjectURL(C.href),e(`Exported ${s.length} test case${s.length>1?"s":""} in BFCL format`,"success")}function ne(){const l=document.createElement("input");l.type="file",l.accept=".json",l.onchange=async s=>{var f,C;const d=s.target.files[0];if(d)try{const v=await d.text(),w=JSON.parse(v);if(!Array.isArray(w)||!w.length){e("Must be a non-empty JSON array of tools","error");return}for(let j=0;j<w.length;j++)if(w[j].type!=="function"||!((f=w[j].function)!=null&&f.name)){e(`Tool ${j+1}: must have type "function" and function.name`,"error");return}const S=[...((C=t.value)==null?void 0:C.tools)||[],...w];await c.updateSuite(n.value,{tools:S}),t.value.tools=S,e(`Imported ${w.length} tool${w.length>1?"s":""}`,"success")}catch(v){e("Failed to import: "+(v.message||"invalid JSON"),"error")}},l.click()}function I(l){var s;l?(O.value=l,V.value=(((s=t.value)==null?void 0:s.test_cases)||[]).find(d=>d.id===l)||null):(O.value=null,V.value=null),A.value=!0}async function H(l){try{O.value?(await c.updateTestCase(n.value,O.value,l),e("Test case updated","success")):(await c.createTestCase(n.value,l),e("Test case created","success")),await c.loadSuite(n.value),A.value=!1,O.value=null,V.value=null}catch(s){e(s.message||"Failed to save","error")}}async function ae(l){if(await u("Delete Test Case","Delete this test case? This cannot be undone.",{danger:!0,confirmLabel:"Delete"}))try{await c.deleteTestCase(n.value,l),t.value&&(t.value.test_cases=(t.value.test_cases||[]).filter(d=>d.id!==l)),e("Test case deleted","success")}catch{e("Failed to delete","error")}}return(l,s)=>(r(),i("div",null,[o("div",gt,[o("button",{onClick:s[0]||(s[0]=d=>l.$router.push({name:"ToolEvalSuites"})),class:"text-xs font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 inline-flex items-center gap-1"},[...s[13]||(s[13]=[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19l-7-7 7-7"})],-1),L(" Back to Suites ",-1)])]),t.value?(r(),i("button",{key:0,onClick:le,class:"text-[10px] font-display tracking-wider uppercase px-3 py-1.5 rounded-sm inline-flex items-center gap-1.5",style:{background:"rgba(56,189,248,0.08)",border:"1px solid rgba(56,189,248,0.2)",color:"#38BDF8"},title:"Export test cases in BFCL-compatible JSON format"},[...s[14]||(s[14]=[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),L(" Export BFCL ",-1)])])):m("",!0)]),a.value?(r(),i("div",kt,"Loading suite...")):t.value?(r(),i(U,{key:1},[o("div",_t,[o("div",wt,[o("div",$t,[s[15]||(s[15]=o("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Suite Name",-1)),b(o("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>y.value=d),onBlur:q,class:"w-full px-3 py-1.5 rounded-sm text-sm font-body text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"Suite Name"},null,544),[[$,y.value]])])]),o("div",null,[s[16]||(s[16]=o("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Description",-1)),b(o("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>x.value=d),onBlur:q,class:"w-full px-3 py-1.5 rounded-sm text-sm font-body text-zinc-400",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"Optional description"},null,544),[[$,x.value]])])]),t.value.system_prompt?(r(),i("div",Tt,[s[17]||(s[17]=o("span",{class:"text-[10px] font-display font-medium tracking-wider uppercase px-2 py-0.5 rounded-sm",style:{background:"rgba(168,85,247,0.15)",color:"#A855F7"}},"System Prompt",-1)),o("span",Ct,_(ee(t.value.system_prompt,80)),1),o("button",{onClick:te,class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 hover:text-red-400 flex-shrink-0"},"Clear")])):m("",!0),o("div",ht,[o("div",zt,[J(Ee,{tools:t.value.tools||[],"suite-id":n.value,onAddTool:s[9]||(s[9]=d=>F(-1)),onEditTool:F,onDeleteTool:oe,onImportTools:ne,onExportTools:se},{editor:R(({index:d})=>[k.value&&N.value===d?(r(),i("div",St,[o("div",Nt,[s[18]||(s[18]=o("span",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500"},"Edit Tool",-1)),o("button",{onClick:s[3]||(s[3]=f=>k.value=!1),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Cancel")]),b(o("textarea",{"onUpdate:modelValue":s[4]||(s[4]=f=>M.value=f),rows:"12",class:"w-full px-3 py-2 rounded-sm text-xs text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace",resize:"vertical"}},null,512),[[$,M.value]]),z.value?(r(),i("div",jt,_(z.value),1)):m("",!0),o("div",Et,[o("button",{onClick:s[5]||(s[5]=f=>k.value=!1),class:"modal-btn modal-btn-cancel text-xs"},"Cancel"),o("button",{onClick:P,class:"modal-btn modal-btn-confirm text-xs"},"Save Tool")])])):m("",!0)]),"add-editor":R(()=>[k.value&&N.value<0?(r(),i("div",Mt,[o("div",Ot,[s[19]||(s[19]=o("span",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500"},"New Tool",-1)),o("button",{onClick:s[6]||(s[6]=d=>k.value=!1),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Cancel")]),b(o("textarea",{"onUpdate:modelValue":s[7]||(s[7]=d=>M.value=d),rows:"12",class:"w-full px-3 py-2 rounded-sm text-xs text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace",resize:"vertical"}},null,512),[[$,M.value]]),z.value?(r(),i("div",At,_(z.value),1)):m("",!0),o("div",Vt,[o("button",{onClick:s[8]||(s[8]=d=>k.value=!1),class:"modal-btn modal-btn-cancel text-xs"},"Cancel"),o("button",{onClick:P,class:"modal-btn modal-btn-confirm text-xs"},"Save Tool")])])):m("",!0)]),_:1},8,["tools","suite-id"])]),o("div",Ut,[J(Ke,{"test-cases":t.value.test_cases||[],tools:t.value.tools||[],onAddCase:s[12]||(s[12]=d=>I(null)),onEditCase:I,onDeleteCase:ae},{editor:R(({caseItem:d})=>[A.value&&O.value===d.id?(r(),i("div",Jt,[J(Y,{"test-case":V.value,editing:!0,onSave:H,onCancel:s[10]||(s[10]=f=>A.value=!1)},null,8,["test-case"])])):m("",!0)]),"add-editor":R(()=>[A.value&&!O.value?(r(),i("div",Rt,[J(Y,{"test-case":V.value,editing:!1,onSave:H,onCancel:s[11]||(s[11]=d=>A.value=!1)},null,8,["test-case"])])):m("",!0)]),_:1},8,["test-cases","tools"])])])],64)):m("",!0)]))}};export{Bt as default};

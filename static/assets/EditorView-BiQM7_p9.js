import{b as r,c as i,d as t,t as g,f as m,F as U,x as K,C as D,k as F,w as oe,h as f,v as T,P as q,D as se,Q as le,r as w,o as ne,i as A,j as R,B as Q,J as ae,q as re,s as ie,M as de}from"./index-DdRTlIgb.js";import{a as ue,u as ce}from"./useSharedContext-Ck8vzsgc.js";const pe={class:"flex items-center justify-between mb-3"},me={class:"flex items-center gap-2"},xe={class:"text-xs font-mono text-zinc-600"},ve={class:"flex items-center gap-2"},fe={key:0,class:"text-zinc-600 text-xs font-body"},be={key:1,class:"flex flex-col gap-2"},ye={class:"flex items-center justify-between px-3 py-2 rounded-sm",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)"}},ge={class:"flex-1 min-w-0"},ke={class:"text-sm font-mono text-zinc-200"},_e={class:"text-xs text-zinc-600 ml-2 font-body"},Te={key:0,class:"text-[10px] text-zinc-700 font-mono mt-0.5"},$e={class:"flex gap-2 ml-3 flex-shrink-0"},we=["onClick"],Ce=["onClick"],he={__name:"ToolsList",props:{tools:{type:Array,required:!0},suiteId:{type:String,default:""}},emits:["addTool","editTool","deleteTool","importTools","exportTools"],setup(_){function z(b){var e,u;const c=(u=(e=b.function)==null?void 0:e.parameters)==null?void 0:u.properties;return c?Object.keys(c):[]}return(b,c)=>(r(),i("div",null,[t("div",pe,[t("div",me,[c[3]||(c[3]=t("span",{class:"section-label"},"Tools",-1)),t("span",xe,"("+g(_.tools.length)+")",1)]),t("div",ve,[t("button",{onClick:c[0]||(c[0]=e=>b.$emit("importTools")),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 px-2 py-1 rounded-sm border border-zinc-800 hover:border-zinc-600 transition-colors"},"Import JSON"),_.tools.length>0?(r(),i("button",{key:0,onClick:c[1]||(c[1]=e=>b.$emit("exportTools")),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 px-2 py-1 rounded-sm border border-zinc-800 hover:border-zinc-600 transition-colors"},"Export")):m("",!0),t("button",{onClick:c[2]||(c[2]=e=>b.$emit("addTool")),class:"text-[10px] font-display tracking-wider uppercase px-2 py-1 rounded-sm transition-colors",style:{color:"var(--lime)",border:"1px solid rgba(191,255,0,0.2)",background:"rgba(191,255,0,0.06)"}},"+ Add Tool")])]),_.tools.length?(r(),i("div",be,[(r(!0),i(U,null,K(_.tools,(e,u)=>{var p,n;return r(),i(U,{key:u},[t("div",ye,[t("div",ge,[t("span",ke,g(((p=e.function)==null?void 0:p.name)||"unnamed"),1),t("span",_e,g(((n=e.function)==null?void 0:n.description)||""),1),z(e).length?(r(),i("div",Te," params: "+g(z(e).join(", ")),1)):m("",!0)]),t("div",$e,[t("button",{onClick:o=>b.$emit("editTool",u),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Edit",8,we),t("button",{onClick:o=>b.$emit("deleteTool",u),class:"text-[10px] font-display tracking-wider uppercase text-zinc-700 hover:text-red-400"},"Delete",8,Ce)])]),D(b.$slots,"editor",{index:u})],64)}),128))])):(r(),i("div",fe," No tools defined yet. ")),D(b.$slots,"add-editor")]))}},ze={class:"flex items-center justify-between mb-3"},Se={class:"flex items-center gap-2"},Ne={class:"text-xs font-mono text-zinc-600"},Me={key:0,class:"text-zinc-600 text-xs font-body"},Ee={key:1,class:"flex flex-col gap-2"},je={class:"flex items-start justify-between px-3 py-2 rounded-sm",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)"}},Oe={class:"flex-1 min-w-0"},Ve={class:"text-sm text-zinc-300 font-body mb-0.5"},Je={key:0,class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm ml-2",style:{color:"var(--lime)",background:"rgba(191,255,0,0.08)",border:"1px solid rgba(191,255,0,0.15)"}},Ue={key:1,class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm ml-2",style:{color:"#38BDF8",background:"rgba(56,189,248,0.08)",border:"1px solid rgba(56,189,248,0.15)"},title:"Model should NOT call any tool (irrelevance test)"},Ae=["title"],Re={class:"text-xs font-mono text-zinc-500"},De={key:0,class:"ml-1"},qe={class:"flex gap-2 ml-3 flex-shrink-0 mt-1"},Fe=["onClick"],Be=["onClick"],Le={__name:"TestCasesList",props:{testCases:{type:Array,required:!0},tools:{type:Array,default:()=>[]}},emits:["addCase","editCase","deleteCase"],setup(_){function z(e,u){return e?e.length>u?e.slice(0,u)+"...":e:""}function b(e){return e==null?"(no tool call)":Array.isArray(e)?e.join(" | "):e}function c(e){return!e||typeof e!="object"?"":Object.entries(e).map(([u,p])=>`${u}=${JSON.stringify(p)}`).join(", ")}return(e,u)=>(r(),i("div",null,[t("div",ze,[t("div",Se,[u[1]||(u[1]=t("span",{class:"section-label"},"Test Cases",-1)),t("span",Ne,"("+g(_.testCases.length)+")",1)]),t("button",{onClick:u[0]||(u[0]=p=>e.$emit("addCase")),class:"text-[10px] font-display tracking-wider uppercase px-2 py-1 rounded-sm transition-colors",style:{color:"var(--lime)",border:"1px solid rgba(191,255,0,0.2)",background:"rgba(191,255,0,0.06)"}},"+ Add Test Case")]),_.testCases.length?(r(),i("div",Ee,[(r(!0),i(U,null,K(_.testCases,(p,n)=>{var o;return r(),i(U,{key:p.id||n},[t("div",je,[t("div",Oe,[t("div",Ve,[F(" #"+g(n+1)+' "'+g(z(p.prompt,80))+'" ',1),p.multi_turn?(r(),i("span",Je,"MULTI-TURN")):m("",!0),p.should_call_tool===!1?(r(),i("span",Ue,"IRRELEVANCE")):m("",!0),(o=p.scoring_config)!=null&&o.mode&&p.scoring_config.mode!=="exact"?(r(),i("span",{key:2,class:"text-[9px] font-display tracking-wider uppercase px-1.5 py-0.5 rounded-sm ml-2",style:{color:"#60A5FA",background:"rgba(96,165,250,0.08)",border:"1px solid rgba(96,165,250,0.15)"},title:"Scoring: "+p.scoring_config.mode},g(p.scoring_config.mode.replace("_"," ").toUpperCase()),9,Ae)):m("",!0)]),t("div",Re,[F(" Expected: "+g(b(p.expected_tool))+" ",1),p.expected_params?(r(),i("span",De," ("+g(c(p.expected_params))+") ",1)):m("",!0)])]),t("div",qe,[t("button",{onClick:a=>e.$emit("editCase",p.id),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Edit",8,Fe),t("button",{onClick:a=>e.$emit("deleteCase",p.id),class:"text-[10px] font-display tracking-wider uppercase text-zinc-700 hover:text-red-400"},"Delete",8,Be)])]),D(e.$slots,"editor",{caseItem:p,index:n})],64)}),128))])):(r(),i("div",Me," No test cases defined yet. ")),D(e.$slots,"add-editor")]))}},Pe={class:"card rounded-md p-5"},Ie={class:"flex items-center justify-between mb-4"},He={class:"section-label"},Qe={class:"mb-4"},Ge={class:"mb-4"},Ke={class:"flex items-center gap-2 cursor-pointer"},We={key:0,class:"text-[10px] text-zinc-600 font-body mt-0.5 ml-5"},Xe={key:0,class:"mb-4"},Ye={class:"flex items-center gap-3 mb-1"},Ze={class:"flex items-center gap-1.5 text-xs text-zinc-500 cursor-pointer"},et=["disabled"],tt={key:1,class:"mb-4"},ot={key:2,class:"mb-4"},st={class:"flex items-center gap-3"},lt={key:0,class:"flex items-center gap-1"},nt={class:"mb-4"},at={class:"flex items-center gap-2 cursor-pointer"},rt={key:3,class:"mb-4 pl-4",style:{"border-left":"2px solid var(--border-subtle)"}},it={class:"flex gap-4 mb-3"},dt={class:"mb-3"},ut={key:4,class:"text-xs mb-3",style:{color:"var(--coral)"}},ct={class:"flex justify-end gap-2"},G={__name:"TestCaseForm",props:{testCase:{type:Object,default:null},editing:{type:Boolean,default:!1}},emits:["save","cancel"],setup(_,{emit:z}){const b=_,c=z,e=le({prompt:"",expectedTool:"",noTool:!1,shouldCallTool:!0,expectedParams:"",scoringMode:"exact",epsilon:.01,multiTurn:!1,maxRounds:5,optimalHops:2,prerequisites:"",mockResponses:""}),u=w("");oe(()=>b.testCase,n=>{if(!n)return;e.prompt=n.prompt||"",e.shouldCallTool=n.should_call_tool!==!1;const o=n.expected_tool===null||n.expected_tool===void 0;e.noTool=o,o?e.expectedTool="":Array.isArray(n.expected_tool)?e.expectedTool=n.expected_tool.join(", "):e.expectedTool=n.expected_tool||"",e.expectedParams=n.expected_params?JSON.stringify(n.expected_params,null,2):"";const a=n.scoring_config||{};e.scoringMode=a.mode||"exact",e.epsilon=a.epsilon??.01,e.multiTurn=!!n.multi_turn,e.maxRounds=n.max_rounds||5,e.optimalHops=n.optimal_hops||2,e.prerequisites=(n.valid_prerequisites||[]).join(", "),e.mockResponses=n.mock_responses?JSON.stringify(n.mock_responses,null,2):""},{immediate:!0});function p(){u.value="";const n=e.prompt.trim();if(!n){u.value="Prompt is required";return}let o=null;if(e.shouldCallTool&&!e.noTool){const x=e.expectedTool.trim();if(!x){u.value='Expected tool is required (or uncheck "Model should call a tool")';return}if(x.includes(",")){if(o=x.split(",").map(y=>y.trim()).filter(Boolean),!o.length){u.value="Enter at least one tool name";return}}else o=x}let a=null;if(e.shouldCallTool){const x=e.expectedParams.trim();if(x)try{if(a=JSON.parse(x),typeof a!="object"||Array.isArray(a)){u.value="Expected params must be a JSON object";return}}catch(y){u.value="Invalid JSON in expected params: "+y.message;return}}const k={prompt:n,expected_tool:o,expected_params:a,should_call_tool:e.shouldCallTool};if(e.shouldCallTool&&e.scoringMode&&e.scoringMode!=="exact"){const x={mode:e.scoringMode};e.scoringMode==="numeric_tolerance"&&(x.epsilon=e.epsilon||.01),k.scoring_config=x}else k.scoring_config=null;if(e.multiTurn){k.multi_turn=!0,k.max_rounds=e.maxRounds||5,k.optimal_hops=e.optimalHops||2;const x=e.prerequisites.trim();k.valid_prerequisites=x?x.split(",").map(h=>h.trim()).filter(Boolean):[];const y=e.mockResponses.trim();if(y)try{k.mock_responses=JSON.parse(y)}catch(h){u.value="Invalid JSON in mock responses: "+h.message;return}}else k.multi_turn=!1;c("save",k)}return(n,o)=>(r(),i("div",Pe,[t("div",Ie,[t("span",He,g(_.editing?"Edit Test Case":"New Test Case"),1),t("button",{onClick:o[0]||(o[0]=a=>n.$emit("cancel")),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Cancel")]),t("div",Qe,[o[14]||(o[14]=t("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"User Message",-1)),f(t("textarea",{"onUpdate:modelValue":o[1]||(o[1]=a=>e.prompt=a),rows:"3",class:"w-full px-3 py-2 rounded-sm text-sm text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace","font-size":"12px",resize:"vertical"},placeholder:"Enter the user prompt..."},null,512),[[T,e.prompt]])]),t("div",Ge,[t("label",Ke,[f(t("input",{type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=a=>e.shouldCallTool=a),class:"accent-lime-400"},null,512),[[q,e.shouldCallTool]]),o[15]||(o[15]=t("span",{class:"text-xs font-display tracking-wider uppercase text-zinc-500"},"Model should call a tool",-1))]),e.shouldCallTool?m("",!0):(r(),i("p",We," Irrelevance test â€” correct answer is to NOT call any tool (abstain). "))]),e.shouldCallTool?(r(),i("div",Xe,[t("div",Ye,[o[17]||(o[17]=t("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500"},"Expected Tool",-1)),t("label",Ze,[f(t("input",{type:"checkbox","onUpdate:modelValue":o[3]||(o[3]=a=>e.noTool=a),class:"accent-lime-400"},null,512),[[q,e.noTool]]),o[16]||(o[16]=t("span",{class:"text-[10px]"},"No tool expected",-1))])]),f(t("input",{"onUpdate:modelValue":o[4]||(o[4]=a=>e.expectedTool=a),disabled:e.noTool,class:"w-full px-3 py-1.5 rounded-sm text-sm font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"tool_name (comma-separated for alternatives)"},null,8,et),[[T,e.expectedTool]])])):m("",!0),e.shouldCallTool?(r(),i("div",tt,[o[18]||(o[18]=t("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Expected Parameters (JSON)",-1)),f(t("textarea",{"onUpdate:modelValue":o[5]||(o[5]=a=>e.expectedParams=a),rows:"3",class:"w-full px-3 py-2 rounded-sm text-sm text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace","font-size":"12px",resize:"vertical"},placeholder:'{"city": "Paris"}'},null,512),[[T,e.expectedParams]])])):m("",!0),e.shouldCallTool?(r(),i("div",ot,[o[21]||(o[21]=t("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Scoring Mode",-1)),t("div",st,[f(t("select",{"onUpdate:modelValue":o[6]||(o[6]=a=>e.scoringMode=a),class:"text-xs font-mono px-3 py-1.5 rounded-sm",style:{background:"var(--surface)",border:"1px solid var(--border-subtle)",color:"#A1A1AA",outline:"none",width:"180px"}},[...o[19]||(o[19]=[t("option",{value:"exact"},"Exact Match",-1),t("option",{value:"subset"},"Subset Match",-1),t("option",{value:"numeric_tolerance"},"Numeric Tolerance",-1),t("option",{value:"case_insensitive"},"Case Insensitive",-1)])],512),[[se,e.scoringMode]]),e.scoringMode==="numeric_tolerance"?(r(),i("div",lt,[o[20]||(o[20]=t("span",{class:"text-[10px] text-zinc-600"},"Epsilon:",-1)),f(t("input",{"onUpdate:modelValue":o[7]||(o[7]=a=>e.epsilon=a),type:"number",step:"0.001",min:"0",class:"w-20 px-2 py-1 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,512),[[T,e.epsilon,void 0,{number:!0}]])])):m("",!0)])])):m("",!0),t("div",nt,[t("label",at,[f(t("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=a=>e.multiTurn=a),class:"accent-lime-400"},null,512),[[q,e.multiTurn]]),o[22]||(o[22]=t("span",{class:"text-xs font-display tracking-wider uppercase text-zinc-500"},"Multi-Turn",-1))])]),e.multiTurn?(r(),i("div",rt,[t("div",it,[t("div",null,[o[23]||(o[23]=t("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Max Rounds",-1)),f(t("input",{"onUpdate:modelValue":o[9]||(o[9]=a=>e.maxRounds=a),type:"number",min:"1",max:"20",class:"w-16 px-2 py-1 rounded-sm text-xs font-mono text-zinc-200 text-center",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,512),[[T,e.maxRounds,void 0,{number:!0}]])]),t("div",null,[o[24]||(o[24]=t("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Optimal Hops",-1)),f(t("input",{"onUpdate:modelValue":o[10]||(o[10]=a=>e.optimalHops=a),type:"number",min:"1",max:"20",class:"w-16 px-2 py-1 rounded-sm text-xs font-mono text-zinc-200 text-center",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,512),[[T,e.optimalHops,void 0,{number:!0}]])])]),t("div",dt,[o[25]||(o[25]=t("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Valid Prerequisites (comma-separated)",-1)),f(t("input",{"onUpdate:modelValue":o[11]||(o[11]=a=>e.prerequisites=a),class:"w-full px-3 py-1.5 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"tool_a, tool_b"},null,512),[[T,e.prerequisites]])]),t("div",null,[o[26]||(o[26]=t("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase mb-1 block"},"Mock Responses (JSON)",-1)),f(t("textarea",{"onUpdate:modelValue":o[12]||(o[12]=a=>e.mockResponses=a),rows:"3",class:"w-full px-3 py-2 rounded-sm text-xs text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace",resize:"vertical"},placeholder:'{"tool_a": {"status": "ok", "data": []}}'},null,512),[[T,e.mockResponses]])])])):m("",!0),u.value?(r(),i("div",ut,g(u.value),1)):m("",!0),t("div",ct,[t("button",{onClick:o[13]||(o[13]=a=>n.$emit("cancel")),class:"modal-btn modal-btn-cancel text-xs"},"Cancel"),t("button",{onClick:p,class:"modal-btn modal-btn-confirm text-xs"},"Save")])]))}},pt={key:0,class:"text-center text-zinc-600 text-sm font-body py-8"},mt={class:"card rounded-md p-5 mb-6"},xt={class:"flex items-center gap-4 mb-3"},vt={class:"flex-1"},ft={key:0,class:"flex items-center gap-3 px-4 py-2.5 rounded-md mb-6",style:{background:"rgba(168,85,247,0.06)",border:"1px solid rgba(168,85,247,0.2)"}},bt={class:"text-xs font-body text-zinc-400 flex-1 truncate"},yt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},gt={class:"card rounded-md p-5"},kt={key:0,class:"mt-2 mb-2"},_t={class:"flex items-center justify-between mb-2"},Tt={key:0,class:"text-xs mt-1",style:{color:"var(--coral)"}},$t={class:"flex justify-end gap-2 mt-2"},wt={key:0,class:"mt-4"},Ct={class:"flex items-center justify-between mb-2"},ht={key:0,class:"text-xs mt-1",style:{color:"var(--coral)"}},zt={class:"flex justify-end gap-2 mt-2"},St={class:"card rounded-md p-5"},Nt={key:0,class:"mt-2 mb-2"},Mt={key:0,class:"mt-4"},Ot={__name:"EditorView",setup(_){const z=ie(),b=re(),c=ue(),{showToast:e}=ae(),{confirm:u}=de(),{setSuite:p}=ce(),n=Q(()=>z.params.id),o=Q(()=>c.currentSuite),a=w(!0),k=w(""),x=w(""),y=w(!1),h=w(-1),S=w(""),C=w(""),E=w(!1),N=w(null),O=w(null);ne(async()=>{var l,s;try{await c.loadSuite(n.value),k.value=((l=o.value)==null?void 0:l.name)||"",x.value=((s=o.value)==null?void 0:s.description)||"",o.value&&p(o.value.id,o.value.name)}catch{e("Failed to load suite","error"),b.push({name:"ToolEvalSuites"})}finally{a.value=!1}});function W(l,s){return l?l.length>s?l.slice(0,s)+"...":l:""}async function B(){const l=k.value.trim();if(!l){e("Name is required","error");return}try{await c.updateSuite(n.value,{name:l,description:x.value.trim()}),o.value&&(o.value.name=l,o.value.description=x.value.trim(),p(o.value.id,l))}catch{e("Failed to save","error")}}async function X(){try{await c.patchSuite(n.value,{system_prompt:""}),o.value&&(o.value.system_prompt=null),e("System prompt cleared","success")}catch{e("Failed to clear system prompt","error")}}function L(l){h.value=l,C.value="",l>=0?S.value=JSON.stringify(o.value.tools[l],null,2):S.value=JSON.stringify({type:"function",function:{name:"my_tool",description:"Description of what this tool does",parameters:{type:"object",properties:{},required:[]}}},null,2),y.value=!0}async function P(){var d,v;C.value="";let l;try{l=JSON.parse(S.value.trim())}catch(M){C.value="Invalid JSON: "+M.message;return}if(!l||typeof l!="object"){C.value="Tool must be a JSON object";return}if(l.type!=="function"){C.value='tool.type must be "function"';return}if(!((d=l.function)!=null&&d.name)){C.value="tool.function.name is required";return}const s=[...((v=o.value)==null?void 0:v.tools)||[]];h.value>=0?s[h.value]=l:s.push(l);try{await c.updateSuite(n.value,{tools:s}),o.value.tools=s,y.value=!1,e("Tool saved","success")}catch{e("Failed to save tools","error")}}async function Y(l){var M,j,$,V;const s=(($=(j=(M=o.value)==null?void 0:M.tools)==null?void 0:j[l])==null?void 0:$.function)||{};if(!await u("Delete Tool",`Delete "${s.name||"unnamed"}"?`,{danger:!0,confirmLabel:"Delete"}))return;const v=[...((V=o.value)==null?void 0:V.tools)||[]];v.splice(l,1);try{await c.updateSuite(n.value,{tools:v}),o.value.tools=v,e("Tool deleted","success")}catch{e("Failed to delete tool","error")}}function Z(){var v;const l=((v=o.value)==null?void 0:v.tools)||[];if(!l.length){e("No tools to export","error");return}const s=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),d=document.createElement("a");d.href=URL.createObjectURL(s),d.download=`${(o.value.name||"tools").replace(/[^a-z0-9]+/gi,"_").toLowerCase()}_tools.json`,d.click(),URL.revokeObjectURL(d.href)}function ee(){const l=document.createElement("input");l.type="file",l.accept=".json",l.onchange=async s=>{var v,M;const d=s.target.files[0];if(d)try{const j=await d.text(),$=JSON.parse(j);if(!Array.isArray($)||!$.length){e("Must be a non-empty JSON array of tools","error");return}for(let J=0;J<$.length;J++)if($[J].type!=="function"||!((v=$[J].function)!=null&&v.name)){e(`Tool ${J+1}: must have type "function" and function.name`,"error");return}const V=[...((M=o.value)==null?void 0:M.tools)||[],...$];await c.updateSuite(n.value,{tools:V}),o.value.tools=V,e(`Imported ${$.length} tool${$.length>1?"s":""}`,"success")}catch(j){e("Failed to import: "+(j.message||"invalid JSON"),"error")}},l.click()}function I(l){var s;l?(N.value=l,O.value=(((s=o.value)==null?void 0:s.test_cases)||[]).find(d=>d.id===l)||null):(N.value=null,O.value=null),E.value=!0}async function H(l){try{N.value?(await c.updateTestCase(n.value,N.value,l),e("Test case updated","success")):(await c.createTestCase(n.value,l),e("Test case created","success")),await c.loadSuite(n.value),E.value=!1,N.value=null,O.value=null}catch(s){e(s.message||"Failed to save","error")}}async function te(l){if(await u("Delete Test Case","Delete this test case? This cannot be undone.",{danger:!0,confirmLabel:"Delete"}))try{await c.deleteTestCase(n.value,l),o.value&&(o.value.test_cases=(o.value.test_cases||[]).filter(d=>d.id!==l)),e("Test case deleted","success")}catch{e("Failed to delete","error")}}return(l,s)=>(r(),i("div",null,[t("button",{onClick:s[0]||(s[0]=d=>l.$router.push({name:"ToolEvalSuites"})),class:"text-xs font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 mb-4 inline-flex items-center gap-1"},[...s[13]||(s[13]=[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19l-7-7 7-7"})],-1),F(" Back to Suites ",-1)])]),a.value?(r(),i("div",pt,"Loading suite...")):o.value?(r(),i(U,{key:1},[t("div",mt,[t("div",xt,[t("div",vt,[s[14]||(s[14]=t("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Suite Name",-1)),f(t("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>k.value=d),onBlur:B,class:"w-full px-3 py-1.5 rounded-sm text-sm font-body text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"Suite Name"},null,544),[[T,k.value]])])]),t("div",null,[s[15]||(s[15]=t("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Description",-1)),f(t("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>x.value=d),onBlur:B,class:"w-full px-3 py-1.5 rounded-sm text-sm font-body text-zinc-400",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"Optional description"},null,544),[[T,x.value]])])]),o.value.system_prompt?(r(),i("div",ft,[s[16]||(s[16]=t("span",{class:"text-[10px] font-display font-medium tracking-wider uppercase px-2 py-0.5 rounded-sm",style:{background:"rgba(168,85,247,0.15)",color:"#A855F7"}},"System Prompt",-1)),t("span",bt,g(W(o.value.system_prompt,80)),1),t("button",{onClick:X,class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 hover:text-red-400 flex-shrink-0"},"Clear")])):m("",!0),t("div",yt,[t("div",gt,[A(he,{tools:o.value.tools||[],"suite-id":n.value,onAddTool:s[9]||(s[9]=d=>L(-1)),onEditTool:L,onDeleteTool:Y,onImportTools:ee,onExportTools:Z},{editor:R(({index:d})=>[y.value&&h.value===d?(r(),i("div",kt,[t("div",_t,[s[17]||(s[17]=t("span",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500"},"Edit Tool",-1)),t("button",{onClick:s[3]||(s[3]=v=>y.value=!1),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Cancel")]),f(t("textarea",{"onUpdate:modelValue":s[4]||(s[4]=v=>S.value=v),rows:"12",class:"w-full px-3 py-2 rounded-sm text-xs text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace",resize:"vertical"}},null,512),[[T,S.value]]),C.value?(r(),i("div",Tt,g(C.value),1)):m("",!0),t("div",$t,[t("button",{onClick:s[5]||(s[5]=v=>y.value=!1),class:"modal-btn modal-btn-cancel text-xs"},"Cancel"),t("button",{onClick:P,class:"modal-btn modal-btn-confirm text-xs"},"Save Tool")])])):m("",!0)]),"add-editor":R(()=>[y.value&&h.value<0?(r(),i("div",wt,[t("div",Ct,[s[18]||(s[18]=t("span",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500"},"New Tool",-1)),t("button",{onClick:s[6]||(s[6]=d=>y.value=!1),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Cancel")]),f(t("textarea",{"onUpdate:modelValue":s[7]||(s[7]=d=>S.value=d),rows:"12",class:"w-full px-3 py-2 rounded-sm text-xs text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none","font-family":"'Space Mono',monospace",resize:"vertical"}},null,512),[[T,S.value]]),C.value?(r(),i("div",ht,g(C.value),1)):m("",!0),t("div",zt,[t("button",{onClick:s[8]||(s[8]=d=>y.value=!1),class:"modal-btn modal-btn-cancel text-xs"},"Cancel"),t("button",{onClick:P,class:"modal-btn modal-btn-confirm text-xs"},"Save Tool")])])):m("",!0)]),_:1},8,["tools","suite-id"])]),t("div",St,[A(Le,{"test-cases":o.value.test_cases||[],tools:o.value.tools||[],onAddCase:s[12]||(s[12]=d=>I(null)),onEditCase:I,onDeleteCase:te},{editor:R(({caseItem:d})=>[E.value&&N.value===d.id?(r(),i("div",Nt,[A(G,{"test-case":O.value,editing:!0,onSave:H,onCancel:s[10]||(s[10]=v=>E.value=!1)},null,8,["test-case"])])):m("",!0)]),"add-editor":R(()=>[E.value&&!N.value?(r(),i("div",Mt,[A(G,{"test-case":O.value,editing:!1,onSave:H,onCancel:s[11]||(s[11]=d=>E.value=!1)},null,8,["test-case"])])):m("",!0)]),_:1},8,["test-cases","tools"])])])],64)):m("",!0)]))}};export{Ot as default};

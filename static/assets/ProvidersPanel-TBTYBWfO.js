import{Q as E,r as S,w as R,b as p,c,d as e,t as b,h as w,v as h,F as T,A as U,f as I,k as K,l as J,s as M,M as Y,K as L,y as B,e as q,B as j,D as Q,a3 as W,g as X,a0 as Z,o as G,i as H}from"./index-BqpQFpv6.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"px-5 py-4"},te={class:"flex items-center justify-between mb-4"},oe={class:"flex items-center gap-3"},se={class:"text-[13px] font-medium text-zinc-200 font-body"},le={class:"text-[9px] font-mono text-zinc-700"},ie={class:"flex gap-2"},ne={key:0},de={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ae={id:"dl-model-edit"},re=["value"],pe={class:"flex gap-1.5 mt-2 flex-wrap"},ue=["onClick"],ce={class:"mt-3"},me={key:0,class:"text-[10px] text-zinc-700 font-body"},ve=["onClick"],_e={class:"mt-3"},ye={class:"space-y-1"},fe={key:0,class:"text-[10px] text-zinc-700 font-body"},xe={class:"text-[10px] font-mono text-zinc-500"},be=["onUpdate:modelValue"],ke=["onClick"],ge={class:"mt-4 pt-3",style:{"border-top":"1px solid var(--border-subtle)"}},we={__name:"ModelCardSettings",props:{model:{type:Object,required:!0},providerKey:{type:String,required:!0},prefix:{type:String,default:""},discoveredModels:{type:Array,default:()=>[]}},emits:["save","delete"],setup(y,{emit:C}){const k=[4096,8192,16384,32768,65536,131072,2e5],m=["4K","8K","16K","32K","64K","128K","200K"],D=new Set(["model_id","display_name","context_window","max_output_tokens","skip_params","input_cost_per_mtok","output_cost_per_mtok","system_prompt"]),a=y,f=C,{showToast:n}=L(),{inputModal:$,multiFieldModal:z}=Y(),_=S(!1),x=S(""),P=S(!0),l=E({model_id:a.model.model_id,display_name:a.model.display_name,context_window:a.model.context_window||128e3,max_output_tokens:a.model.max_output_tokens||null,input_cost_per_mtok:a.model.input_cost_per_mtok??null,output_cost_per_mtok:a.model.output_cost_per_mtok??null,skip_params:[...a.model.skip_params||[]],system_prompt:a.model.system_prompt||""}),r=S(Object.entries(a.model).filter(([d])=>!D.has(d)).map(([d,o])=>({key:d,value:o})));R(()=>a.model,d=>{l.model_id=d.model_id,l.display_name=d.display_name,l.context_window=d.context_window||128e3,l.max_output_tokens=d.max_output_tokens||null,l.input_cost_per_mtok=d.input_cost_per_mtok??null,l.output_cost_per_mtok=d.output_cost_per_mtok??null,l.skip_params=[...d.skip_params||[]],l.system_prompt=d.system_prompt||"",r.value=Object.entries(d).filter(([o])=>!D.has(o)).map(([o,i])=>({key:o,value:i}))},{deep:!0});async function F(){const d={};r.value.forEach(A=>{d[A.key]=A.value});const o={};l.input_cost_per_mtok!=null&&l.input_cost_per_mtok!==""&&(o.input_cost_per_mtok=parseFloat(l.input_cost_per_mtok)),l.output_cost_per_mtok!=null&&l.output_cost_per_mtok!==""&&(o.output_cost_per_mtok=parseFloat(l.output_cost_per_mtok));const i={provider_key:a.providerKey,model_id:a.model.model_id,new_model_id:l.model_id||a.model.model_id,display_name:l.display_name||"",context_window:parseInt(l.context_window)||null,max_output_tokens:parseInt(l.max_output_tokens)||null,skip_params:l.skip_params,system_prompt:l.system_prompt||null},g={...d,...o};Object.keys(g).length&&(i.custom_fields=g);try{const A=await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(A.ok)x.value="Saved",P.value=!0,setTimeout(()=>{x.value=""},3e3),f("save");else{const O=await A.json();x.value=O.error||"Save failed",P.value=!1}}catch{x.value="Network error",P.value=!1}}async function N(){const d=await $("Add Skip Param","Parameter name (e.g., temperature)"),o=typeof d=="object"?d==null?void 0:d.value:d;!o||!o.trim()||(l.skip_params.includes(o.trim())||l.skip_params.push(o.trim()),await t())}function v(d){l.skip_params=l.skip_params.filter(o=>o!==d),t()}async function t(){try{await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:a.providerKey,model_id:a.model.model_id,skip_params:l.skip_params})}),f("save")}catch{n("Failed to save skip params","error")}}async function s(){var g;const d=await z("Add Custom Field",[{key:"name",label:"Field Name",placeholder:"e.g., pricing_tier"},{key:"value",label:"Value",placeholder:"e.g., standard"}]);if(!d)return;const o=(g=d.name)==null?void 0:g.trim(),i=d.value;if(o){r.value.push({key:o,value:i});try{await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:a.providerKey,model_id:a.model.model_id,custom_fields:{[o]:i}})}),f("save")}catch{n("Failed to add field","error")}}}async function u(d){r.value=r.value.filter(o=>o.key!==d);try{await M("/api/config/model",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:a.providerKey,model_id:a.model.model_id,custom_fields:{[d]:null}})}),f("save")}catch{n("Failed to remove field","error")}}return(d,o)=>(p(),c("div",ee,[e("div",te,[e("div",oe,[e("div",se,b(l.display_name||y.model.display_name),1),e("span",le,b(y.model.model_id),1)]),e("div",ie,[e("button",{onClick:o[0]||(o[0]=i=>_.value=!_.value),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 transition-colors"},b(_.value?"Collapse":"Edit"),1),e("button",{onClick:F,class:"lime-btn"},"Save"),e("button",{onClick:o[1]||(o[1]=i=>d.$emit("delete",y.model)),class:"text-[11px] font-display tracking-wider uppercase px-2 py-1.5 rounded-sm text-zinc-600 hover:text-red-400 transition-colors",style:{border:"1px solid var(--border-subtle)"}},"×")])]),_.value?(p(),c("div",ne,[e("div",de,[e("div",null,[o[10]||(o[10]=e("label",{class:"field-label"},"Model ID",-1)),w(e("input",{"onUpdate:modelValue":o[2]||(o[2]=i=>l.model_id=i),class:"settings-input",list:"dl-model-edit",onFocus:o[3]||(o[3]=i=>{var g,A;return(A=(g=d.$parent)==null?void 0:g.$emit)==null?void 0:A.call(g,"loadDiscovery",y.providerKey)})},null,544),[[h,l.model_id]]),e("datalist",ae,[(p(!0),c(T,null,U(y.discoveredModels,i=>(p(),c("option",{key:i.id,value:i.id},b(i.display_name),9,re))),128))])]),e("div",null,[o[11]||(o[11]=e("label",{class:"field-label"},"Display Name",-1)),w(e("input",{"onUpdate:modelValue":o[4]||(o[4]=i=>l.display_name=i),class:"settings-input"},null,512),[[h,l.display_name]])]),e("div",null,[o[12]||(o[12]=e("label",{class:"field-label"},"Context Window",-1)),w(e("input",{"onUpdate:modelValue":o[5]||(o[5]=i=>l.context_window=i),type:"number",class:"settings-input"},null,512),[[h,l.context_window,void 0,{number:!0}]]),e("div",pe,[(p(),c(T,null,U(k,(i,g)=>e("button",{key:i,onClick:A=>l.context_window=i,class:"text-[9px] font-mono px-2 py-0.5 rounded-sm text-zinc-600 hover:text-zinc-400 transition-colors",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)"}},b(m[g]),9,ue)),64))])]),e("div",null,[o[13]||(o[13]=e("label",{class:"field-label"},"Max Output Tokens",-1)),w(e("input",{"onUpdate:modelValue":o[6]||(o[6]=i=>l.max_output_tokens=i),type:"number",placeholder:"Default",class:"settings-input"},null,512),[[h,l.max_output_tokens,void 0,{number:!0}]])]),e("div",null,[o[14]||(o[14]=e("label",{class:"field-label"},"Input $/1M tokens",-1)),w(e("input",{"onUpdate:modelValue":o[7]||(o[7]=i=>l.input_cost_per_mtok=i),type:"number",step:"0.001",placeholder:"e.g. 2.00",class:"settings-input"},null,512),[[h,l.input_cost_per_mtok,void 0,{number:!0}]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"field-label"},"Output $/1M tokens",-1)),w(e("input",{"onUpdate:modelValue":o[8]||(o[8]=i=>l.output_cost_per_mtok=i),type:"number",step:"0.001",placeholder:"e.g. 8.00",class:"settings-input"},null,512),[[h,l.output_cost_per_mtok,void 0,{number:!0}]])])]),e("div",ce,[o[16]||(o[16]=e("span",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase"},"Skip Params: ",-1)),l.skip_params.length===0?(p(),c("span",me,"none")):I("",!0),(p(!0),c(T,null,U(l.skip_params,i=>(p(),c("span",{key:i,class:"text-[10px] font-mono text-zinc-400 px-1.5 py-0.5 rounded-sm inline-flex items-center gap-1 mr-1",style:{background:"rgba(255,255,255,0.04)"}},[K(b(i)+" ",1),e("button",{onClick:g=>v(i),class:"text-zinc-600 hover:text-red-400"},"×",8,ve)]))),128)),e("button",{onClick:N,class:"text-[10px] font-mono text-zinc-500 hover:text-zinc-300 ml-2 px-1.5 py-0.5 rounded-sm",style:{border:"1px solid var(--border-subtle)"}},"+ add")]),e("div",_e,[o[17]||(o[17]=e("span",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Custom Fields",-1)),e("div",ye,[r.value.length===0?(p(),c("div",fe,"none")):I("",!0),(p(!0),c(T,null,U(r.value,i=>(p(),c("div",{key:i.key,class:"flex items-center gap-2"},[e("span",xe,b(i.key)+":",1),w(e("input",{"onUpdate:modelValue":g=>i.value=g,class:"px-2 py-1 rounded-sm text-[11px] font-mono text-zinc-300 flex-1",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"}},null,8,be),[[h,i.value]]),e("button",{onClick:g=>u(i.key),class:"text-zinc-600 hover:text-red-400 text-xs"},"×",8,ke)]))),128))]),e("button",{onClick:s,class:"text-[10px] font-mono text-zinc-500 hover:text-zinc-300 mt-1 px-1.5 py-0.5 rounded-sm",style:{border:"1px solid var(--border-subtle)"}},"+ add field")]),e("div",ge,[o[18]||(o[18]=e("label",{class:"field-label"},"System Prompt",-1)),o[19]||(o[19]=e("p",{class:"text-[10px] text-zinc-700 font-body mb-2"},"Custom system prompt prepended to all benchmarks and evals for this model. Leave empty for default behavior.",-1)),w(e("textarea",{"onUpdate:modelValue":o[9]||(o[9]=i=>l.system_prompt=i),rows:"3",class:"w-full px-3 py-2 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none",resize:"vertical"},placeholder:"e.g. You are a helpful assistant. Always respond in JSON format."},null,512),[[h,l.system_prompt]])])])):I("",!0),x.value?(p(),c("div",{key:1,class:"mt-2 text-[11px] font-body",style:J(`color:${P.value?"var(--lime)":"var(--coral)"}`)},b(x.value),5)):I("",!0)]))}},he=V(we,[["__scopeId","data-v-051ba591"]]),$e={class:"card rounded-md overflow-hidden"},Ce={class:"px-5 py-3 flex items-center justify-between",style:{"border-bottom":"1px solid var(--border-subtle)"}},ze={class:"flex items-center gap-3"},Se={class:"text-zinc-600 text-xs font-body"},Pe={class:"text-[9px] font-mono text-zinc-700"},De={key:0,class:"text-[9px] font-mono px-1.5 py-0.5 rounded-sm",style:{background:"rgba(56,189,248,0.08)",color:"#38BDF8",border:"1px solid rgba(56,189,248,0.2)"}},Me={class:"flex gap-2"},Ie={key:0,class:"px-5 py-3",style:{"border-bottom":"1px solid var(--border-subtle)",background:"rgba(191,255,0,0.02)"}},Ae={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-2"},Fe={class:"flex items-center gap-3"},Te={class:"divide-y",style:{"border-color":"var(--border-subtle)"}},Ue={class:"px-5 py-3",style:{"border-top":"1px solid var(--border-subtle)"}},Ne={key:0,class:"mt-3"},Oe={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-2"},je={class:"flex items-center gap-0"},Ve={key:0,class:"text-[11px] font-mono px-2 py-2 rounded-l-sm flex-shrink-0",style:{background:"rgba(56,189,248,0.08)",color:"#38BDF8",border:"1px solid rgba(56,189,248,0.2)","border-right":"none"}},Ke=["placeholder"],Ee={id:"dl-add-model"},Be=["value"],Je={__name:"ProviderCard",props:{provider:{type:Object,required:!0},discoveredModels:{type:Array,default:()=>[]}},emits:["refresh","delete","deleteModel","fetch","loadDiscovery"],setup(y,{emit:C}){const k=y,m=C,{showToast:D}=L(),a=j(()=>k.provider.models||[]),f=j(()=>Q(k.provider.display_name)),n=j(()=>{const v=k.provider.model_id_prefix;return v||$(a.value)});function $(v){if(!v||v.length===0)return"";const t=v.map(d=>d.model_id||d.id||""),s=t[0].indexOf("/");if(s<1)return"";const u=t[0].substring(0,s);return t.every(d=>d.startsWith(u+"/"))?u:""}const z=S(!1),_=E({display_name:k.provider.display_name,model_id_prefix:k.provider.model_id_prefix||"",api_base:k.provider.api_base||"",api_key_env:k.provider.api_key_env||""}),x=S(null);R(()=>k.provider,v=>{_.display_name=v.display_name,_.model_id_prefix=v.model_id_prefix||"",_.api_base=v.api_base||"",_.api_key_env=v.api_key_env||""},{deep:!0});async function P(){try{const v=await M("/api/config/provider",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:k.provider.provider_key,display_name:_.display_name,api_base:_.api_base,api_key_env:_.api_key_env,model_id_prefix:_.model_id_prefix})});if(v.ok)x.value={ok:!0,msg:"Saved"},setTimeout(()=>{x.value=null},3e3),m("refresh");else{const t=await v.json();x.value={ok:!1,msg:t.error||"Failed"}}}catch{x.value={ok:!1,msg:"Network error"}}}const l=S(!1),r=E({id:"",display_name:"",context_window:128e3});function F(){if(!r.display_name){const t=r.id;r.display_name=t.includes("/")?t.split("/").pop():t}const v=k.discoveredModels.find(t=>t.id===r.id);v&&(r.display_name=v.display_name)}async function N(){const v=r.id.trim();if(v)try{const t=await M("/api/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:k.provider.provider_key,id:v,display_name:r.display_name.trim()||"",context_window:r.context_window||128e3})});if(t.ok)r.id="",r.display_name="",r.context_window=128e3,l.value=!1,m("refresh");else{const s=await t.json();D(s.error||"Failed to add model","error")}}catch{D("Network error","error")}}return(v,t)=>(p(),c("div",$e,[e("div",Ce,[e("div",ze,[e("span",{class:"badge",style:J(`background:${f.value.bg};color:${f.value.text};border:1px solid ${f.value.border}`)},b(y.provider.display_name),5),e("span",Se,b(a.value.length)+" model"+b(a.value.length!==1?"s":""),1),e("span",Pe,b(y.provider.provider_key),1),n.value?(p(),c("span",De,"prefix: "+b(n.value)+"/",1)):I("",!0)]),e("div",Me,[e("button",{onClick:t[0]||(t[0]=s=>v.$emit("fetch",y.provider.provider_key)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 transition-colors"},"Fetch"),e("button",{onClick:t[1]||(t[1]=s=>z.value=!z.value),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300 transition-colors"},"Edit"),e("button",{onClick:t[2]||(t[2]=s=>v.$emit("delete",y.provider)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 hover:text-red-400 transition-colors"},"Del")])]),z.value?(p(),c("div",Ie,[e("div",Ae,[e("div",null,[t[14]||(t[14]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Display Name",-1)),w(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>_.display_name=s),class:"settings-input"},null,512),[[h,_.display_name]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Model ID Prefix",-1)),w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>_.model_id_prefix=s),placeholder:"Optional",class:"settings-input"},null,512),[[h,_.model_id_prefix]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"API Base",-1)),w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>_.api_base=s),placeholder:"https://...",class:"settings-input"},null,512),[[h,_.api_base]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"API Key Name",-1)),w(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>_.api_key_env=s),placeholder:"e.g. OPENAI_API_KEY",class:"settings-input"},null,512),[[h,_.api_key_env]])])]),e("div",Fe,[e("button",{onClick:P,class:"lime-btn"},"Save Provider"),x.value?(p(),c("span",{key:0,class:"text-[11px] font-body",style:J(`color:${x.value.ok?"var(--lime)":"var(--coral)"}`)},b(x.value.msg),5)):I("",!0)])])):I("",!0),e("div",Te,[(p(!0),c(T,null,U(a.value,s=>(p(),B(he,{key:s.model_id,model:s,"provider-key":y.provider.provider_key,prefix:n.value,"discovered-models":y.discoveredModels,onSave:t[7]||(t[7]=u=>v.$emit("refresh")),onDelete:t[8]||(t[8]=u=>v.$emit("deleteModel",{providerKey:y.provider.provider_key,model:u}))},null,8,["model","provider-key","prefix","discovered-models"]))),128))]),e("div",Ue,[e("button",{onClick:t[9]||(t[9]=s=>l.value=!l.value),class:"lime-btn"},"+ Add Model"),l.value?(p(),c("div",Ne,[e("div",Oe,[e("div",null,[t[18]||(t[18]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Model ID",-1)),e("div",je,[n.value?(p(),c("span",Ve,b(n.value)+"/",1)):I("",!0),w(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>r.id=s),placeholder:n.value?"model-name":"provider/model-name",class:q(["settings-input",n.value?"rounded-l-none":""]),list:"dl-add-model",onFocus:t[11]||(t[11]=s=>v.$emit("loadDiscovery",y.provider.provider_key)),onInput:F},null,42,Ke),[[h,r.id]]),e("datalist",Ee,[(p(!0),c(T,null,U(y.discoveredModels,s=>(p(),c("option",{key:s.id,value:s.id},b(s.display_name),9,Be))),128))])])]),e("div",null,[t[19]||(t[19]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Display Name",-1)),w(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>r.display_name=s),placeholder:"Auto from ID",class:"settings-input"},null,512),[[h,r.display_name]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"text-[10px] text-zinc-600 font-display tracking-wider uppercase block mb-1"},"Context Window",-1)),w(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>r.context_window=s),type:"number",class:"settings-input"},null,512),[[h,r.context_window,void 0,{number:!0}]])])]),e("button",{onClick:N,class:"lime-btn"},"Add")])):I("",!0)])]))}},Le=V(Je,[["__scopeId","data-v-07ae1d8e"]]),Re={class:"card rounded-md p-5 mt-3"},Ye={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3"},qe={class:"flex gap-3"},Qe={__name:"AddProviderForm",emits:["submit","cancel"],setup(y,{emit:C}){const k=C,m=E({display_name:"",provider_key:"",model_id_prefix:"",api_base:"",api_key_env:""});function D(){const f=W(m.display_name);m.provider_key=f,m.api_key_env=f.toUpperCase().replace(/-/g,"_")+"_API_KEY"}function a(){k("submit",{...m}),m.display_name="",m.provider_key="",m.model_id_prefix="",m.api_base="",m.api_key_env=""}return(f,n)=>(p(),c("div",Re,[e("div",Ye,[e("div",null,[n[6]||(n[6]=e("label",{class:"field-label"},"Display Name",-1)),w(e("input",{"onUpdate:modelValue":n[0]||(n[0]=$=>m.display_name=$),onInput:D,placeholder:"My Provider",class:"settings-input"},null,544),[[h,m.display_name]])]),e("div",null,[n[7]||(n[7]=e("label",{class:"field-label"},[K("Provider Key "),e("span",{class:"text-zinc-700 normal-case"},"(auto-derived, editable)")],-1)),w(e("input",{"onUpdate:modelValue":n[1]||(n[1]=$=>m.provider_key=$),placeholder:"auto_generated",class:"settings-input"},null,512),[[h,m.provider_key]])]),e("div",null,[n[8]||(n[8]=e("label",{class:"field-label"},[K("Model ID Prefix "),e("span",{class:"text-zinc-700 normal-case"},"(e.g. lm_studio)")],-1)),w(e("input",{"onUpdate:modelValue":n[2]||(n[2]=$=>m.model_id_prefix=$),placeholder:"Optional -- prepended to model IDs",class:"settings-input"},null,512),[[h,m.model_id_prefix]])]),e("div",null,[n[9]||(n[9]=e("label",{class:"field-label"},"API Base",-1)),w(e("input",{"onUpdate:modelValue":n[3]||(n[3]=$=>m.api_base=$),placeholder:"https://api.example.com/v1",class:"settings-input"},null,512),[[h,m.api_base]])]),e("div",null,[n[10]||(n[10]=e("label",{class:"field-label"},[K("API Key Name "),e("span",{class:"text-zinc-700 normal-case"},"(auto-derived)")],-1)),w(e("input",{"onUpdate:modelValue":n[4]||(n[4]=$=>m.api_key_env=$),placeholder:"e.g. OPENAI_API_KEY",class:"settings-input"},null,512),[[h,m.api_key_env]])])]),e("div",qe,[e("button",{onClick:a,class:"lime-btn"},"Create Provider"),e("button",{onClick:n[5]||(n[5]=$=>f.$emit("cancel")),class:"text-[11px] font-display tracking-wider uppercase text-zinc-600 hover:text-zinc-400 px-3 py-1.5 transition-colors"},"Cancel")])]))}},We=V(Qe,[["__scopeId","data-v-6fb76034"]]),Xe={class:"card rounded-md p-5 w-full max-w-lg max-h-[70vh] flex flex-col",style:{border:"1px solid var(--border-subtle)"}},Ze={class:"flex items-center justify-between mb-3"},Ge={class:"font-display text-sm tracking-wide text-zinc-200"},He={class:"overflow-y-auto flex-1 mb-3"},et=["value","checked","disabled","onChange"],tt={class:"text-xs font-mono text-zinc-300"},ot={key:0,class:"text-[10px] text-zinc-500"},st={key:1,class:"text-[9px] text-zinc-600 ml-auto"},lt=["disabled"],it={__name:"DiscoveredModelsDialog",props:{visible:{type:Boolean,default:!1},models:{type:Array,default:()=>[]},existingModelIds:{type:Array,default:()=>[]}},emits:["close","add"],setup(y,{expose:C,emit:k}){const m=y,D=k,a=S(new Set),f=S(!1),n=j(()=>new Set(m.existingModelIds));function $(P,l){l.target.checked?a.value.add(P):a.value.delete(P),a.value=new Set(a.value)}function z(){a.value=new Set,D("close")}async function _(){const P=Array.from(a.value).map(l=>m.models[l]);P.length!==0&&(f.value=!0,D("add",P))}function x(){a.value=new Set,f.value=!1}return C({reset:x}),(P,l)=>(p(),B(Z,{to:"body"},[y.visible?(p(),c("div",{key:0,class:"modal-overlay",onClick:X(z,["self"])},[e("div",Xe,[e("div",Ze,[e("span",Ge,b(y.models.length)+" models available",1),e("button",{onClick:z,class:"text-zinc-500 hover:text-zinc-300 text-xs cursor-pointer"},"Close")]),e("div",He,[(p(!0),c(T,null,U(y.models,(r,F)=>(p(),c("label",{key:r.id,class:q(["flex items-center gap-2 py-1.5 px-2 rounded hover:bg-white/5 cursor-pointer",n.value.has(r.id)?"opacity-40":""])},[e("input",{type:"checkbox",value:F,checked:n.value.has(r.id)||a.value.has(F),disabled:n.value.has(r.id),onChange:N=>$(F,N),class:"accent-lime-400"},null,40,et),e("span",tt,b(r.id),1),r.display_name!==r.id?(p(),c("span",ot,b(r.display_name),1)):I("",!0),n.value.has(r.id)?(p(),c("span",st,"already added")):I("",!0)],2))),128))]),e("button",{onClick:_,disabled:f.value,class:"lime-btn self-end"},b(f.value?"Adding...":"Add Selected"),9,lt)])])):I("",!0)]))}},nt=V(it,[["__scopeId","data-v-9eb79053"]]),dt={key:0,class:"text-zinc-600 text-sm font-body"},at={key:1,class:"text-red-400 text-xs font-body"},rt={key:2,class:"space-y-4"},pt={__name:"ProvidersPanel",setup(y){const{showToast:C}=L(),{confirm:k}=Y(),m=S(null),D=S(!0),a=S(""),f=S(!1),n=S({}),$=S(null),z=S({visible:!1,models:[],existingIds:[],providerKey:""}),_=j(()=>{var t;return(t=m.value)!=null&&t.providers?Object.entries(m.value.providers).map(([s,u])=>({display_name:s,provider_key:u.provider_key,models:u.models||[],api_base:u.api_base||"",api_key_env:u.api_key_env||"",model_id_prefix:u.model_id_prefix||""})):[]});async function x(){try{const t=await M("/api/config");m.value=await t.json(),a.value=""}catch{a.value="Failed to load config."}finally{D.value=!1}}async function P(t){if(await k("Delete Provider",`Delete <strong>${t.display_name}</strong> and its ${t.models.length} model(s)?`,{danger:!0,confirmLabel:"Delete"}))try{await M("/api/config/provider",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:t.provider_key})}),await x()}catch{C("Failed to delete provider","error")}}async function l({providerKey:t,model:s}){if(await k("Remove Model",`Remove model <strong>${s.display_name}</strong>?`,{danger:!0,confirmLabel:"Remove"}))try{await M("/api/config/model",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:t,model_id:s.model_id})}),await x()}catch{C("Failed to delete model","error")}}async function r(t){if(!t.provider_key){C("Provider key is required","error");return}try{const s=await M("/api/config/provider",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(s.ok)f.value=!1,await x();else{const u=await s.json();C(u.error||"Failed to add provider","error")}}catch{C("Network error","error")}}async function F(t){if(!n.value[t])try{const u=await(await M(`/api/models/discover?provider_key=${encodeURIComponent(t)}`)).json();u.models&&(n.value[t]=u.models)}catch{}}async function N(t){var s,u;try{const o=await(await M(`/api/models/discover?provider_key=${encodeURIComponent(t)}`)).json();if(o.error){C(o.error,"error");return}const i=o.models||[];if(i.length===0){C("No models found","error");return}n.value[t]=i;const g=_.value.find(O=>O.provider_key===t),A=((g==null?void 0:g.models)||[]).map(O=>O.model_id);z.value={visible:!0,models:i,existingIds:A,providerKey:t},(u=(s=$.value)==null?void 0:s.reset)==null||u.call(s)}catch(d){C("Failed to fetch models: "+d.message,"error")}}async function v(t){const s=z.value.providerKey;for(const u of t)await M("/api/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider_key:s,id:u.id,display_name:u.display_name})});z.value.visible=!1,await x(),C(`Added ${t.length} model(s)`,"success")}return G(x),(t,s)=>(p(),c("div",null,[D.value?(p(),c("div",dt,"Loading config...")):a.value?(p(),c("div",at,b(a.value),1)):(p(),c("div",rt,[(p(!0),c(T,null,U(_.value,u=>(p(),B(Le,{key:u.provider_key,provider:u,"discovered-models":n.value[u.provider_key]||[],onRefresh:x,onDelete:P,onDeleteModel:l,onFetch:N,onLoadDiscovery:F},null,8,["provider","discovered-models"]))),128)),e("div",null,[e("button",{onClick:s[0]||(s[0]=u=>f.value=!f.value),class:"lime-btn"},"+ Add Provider"),f.value?(p(),B(We,{key:0,onSubmit:r,onCancel:s[1]||(s[1]=u=>f.value=!1)})):I("",!0)])])),H(nt,{ref_key:"discoveryDialogRef",ref:$,visible:z.value.visible,models:z.value.models,"existing-model-ids":z.value.existingIds,onClose:s[2]||(s[2]=u=>z.value.visible=!1),onAdd:v},null,8,["visible","models","existing-model-ids"])]))}},mt=V(pt,[["__scopeId","data-v-ee52447d"]]);export{mt as default};

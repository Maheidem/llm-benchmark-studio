import{o as q,c as r,d as e,h as C,v as z,t as i,f as w,F,A as T,x as V,K as R,r as u,q as H,b as l,k as O,l as L,O as B}from"./index-BHukJGVM.js";import{u as G}from"./promptLibrary-DunVHlaD.js";import{u as J}from"./useSharedContext-BbSTP2tH.js";const Q={class:"flex items-center justify-between mb-6"},W={key:0,class:"card rounded-md p-5 mb-6"},X={class:"mb-3"},Y={class:"mb-3"},Z={key:0,class:"text-xs mb-3",style:{color:"var(--coral)"}},ee={class:"flex justify-end gap-2"},te=["disabled"],oe={key:1,class:"card rounded-md p-5 mb-6",style:{border:"1px solid rgba(56,189,248,0.2)"}},se={class:"flex items-center justify-between mb-3"},ne={class:"grid grid-cols-2 gap-4"},re={class:"text-[10px] font-display tracking-wider uppercase text-zinc-600 mb-1"},le={class:"ml-2 text-zinc-700"},ae={class:"text-[10px] font-mono text-zinc-400 p-2 rounded-sm overflow-x-auto whitespace-pre-wrap break-all",style:{background:"rgba(0,0,0,0.25)",border:"1px solid var(--border-subtle)","max-height":"200px","overflow-y":"auto"}},ie={key:2,class:"text-[10px] text-zinc-600 font-body mb-4"},de={key:3,class:"text-xs text-zinc-600 font-body text-center py-8"},ce={key:4,class:"text-xs text-zinc-600 font-body text-center py-8"},ue={key:5,class:"space-y-3"},pe={class:"flex items-start gap-3"},xe=["onClick","title"],be={key:0,class:"w-2.5 h-2.5",fill:"none",stroke:"#38BDF8","stroke-width":"3",viewBox:"0 0 24 24"},ve={class:"flex-1 min-w-0"},me={class:"flex items-center gap-2 mb-1 flex-wrap"},fe={class:"text-[10px] font-mono text-zinc-600"},ye={key:0,class:"flex items-center gap-1"},ge=["onKeyup"],ke=["onClick"],_e=["onClick"],he=["onClick"],we={class:"text-[10px] text-zinc-700 font-body ml-auto"},Ce={class:"text-[10px] text-zinc-600 font-body truncate pr-2"},ze={class:"flex items-center gap-2 flex-shrink-0"},Ve=["onClick"],Le=["onClick"],Se=["onClick"],Be={__name:"PromptLibrary",setup($e){const D=H(),c=G(),{setSystemPrompt:j,setConfig:A}=J(),{showToast:d}=R(),b=u(!1),p=u(""),v=u(""),x=u(""),k=u(!1),m=u(null),_=u(""),n=u([]);q(async()=>{try{await c.loadVersions()}catch{d("Failed to load prompt library","error")}});async function M(){if(x.value="",!p.value.trim()){x.value="Prompt text is required";return}k.value=!0;try{await c.saveVersion(p.value.trim(),v.value.trim()||null),d("Prompt version saved","success"),b.value=!1,p.value="",v.value=""}catch(s){x.value=s.message||"Failed to save"}finally{k.value=!1}}function S(s){m.value=s.id,_.value=s.label||""}async function $(s){try{await c.updateVersion(s,_.value.trim()||null),m.value=null,d("Label updated","success")}catch{d("Failed to update label","error")}}async function N(s){if(confirm(`Delete this prompt version${s.label?` "${s.label}"`:""}?`))try{await c.deleteVersion(s.id),n.value=n.value.filter(o=>o!==s.id),d("Version deleted","success")}catch{d("Failed to delete version","error")}}function U(s){j("_global",s.prompt_text),A({lastUpdatedBy:"prompt_library"}),d("Prompt loaded into tuner context","success"),D.push({name:"PromptTunerConfig"})}async function E(s){try{await navigator.clipboard.writeText(s),d("Copied to clipboard","success")}catch{d("Failed to copy","error")}}function K(s){n.value.includes(s)?n.value=n.value.filter(o=>o!==s):n.value.length<2?n.value=[...n.value,s]:n.value=[n.value[1],s]}function h(s){return c.versions.find(o=>o.id===s)}function I(s){return s==="tuner"||s==="prompt_tuner"?"background:rgba(168,85,247,0.1);color:#A855F7;":"background:rgba(255,255,255,0.04);color:#71717A;"}function P(s){return s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}return(s,o)=>(l(),r("div",null,[e("div",Q,[o[8]||(o[8]=e("div",null,[e("h2",{class:"font-display font-bold text-lg text-zinc-100 mb-1"},"Prompt Library"),e("p",{class:"text-sm text-zinc-600 font-body"},"Saved system prompt versions. Load into tuner or compare side-by-side.")],-1)),e("button",{onClick:o[0]||(o[0]=t=>b.value=!b.value),class:"text-[10px] font-display tracking-wider uppercase px-3 py-1.5 rounded-sm",style:{background:"rgba(191,255,0,0.08)",border:"1px solid rgba(191,255,0,0.2)",color:"var(--lime)"}},"+ Save New")]),b.value?(l(),r("div",W,[e("div",X,[o[9]||(o[9]=e("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Prompt Text",-1)),C(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=t=>p.value=t),rows:"4",class:"w-full px-3 py-2 rounded-sm text-xs font-body text-zinc-200 resize-y",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"Enter system prompt..."},null,512),[[z,p.value]])]),e("div",Y,[o[10]||(o[10]=e("label",{class:"text-xs font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Label (optional)",-1)),C(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>v.value=t),class:"w-full px-3 py-1.5 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none"},placeholder:"e.g. v1-tool-focused"},null,512),[[z,v.value]])]),x.value?(l(),r("div",Z,i(x.value),1)):w("",!0),e("div",ee,[e("button",{onClick:o[3]||(o[3]=t=>{b.value=!1,p.value="",v.value="",x.value=""}),class:"modal-btn modal-btn-cancel text-xs"},"Cancel"),e("button",{onClick:M,disabled:k.value,class:"modal-btn modal-btn-confirm text-xs"},i(k.value?"Saving...":"Save"),9,te)])])):w("",!0),n.value.length===2?(l(),r("div",oe,[e("div",se,[o[11]||(o[11]=e("span",{class:"text-xs font-display tracking-wider uppercase text-zinc-400"},"Comparing 2 Versions",-1)),e("button",{onClick:o[4]||(o[4]=t=>n.value=[]),class:"text-[10px] text-zinc-500 hover:text-zinc-300 font-display tracking-wider uppercase"},"Clear")]),e("div",ne,[(l(!0),r(F,null,T(n.value,t=>{var f,y,g,a;return l(),r("div",{key:t},[e("div",re,[O(i(((f=h(t))==null?void 0:f.label)||`Version ${((y=h(t))==null?void 0:y.version_number)||"?"}`)+" ",1),e("span",le,i(P((g=h(t))==null?void 0:g.created_at)),1)]),e("pre",ae,i(((a=h(t))==null?void 0:a.prompt_text)||""),1)])}),128))])])):n.value.length===1?(l(),r("div",ie," Select one more version to compare. ")):w("",!0),V(c).loading?(l(),r("div",de,"Loading...")):V(c).versions.length===0?(l(),r("div",ce," No saved prompts yet. Save a version above or run a prompt tuning job. ")):(l(),r("div",ue,[(l(!0),r(F,null,T(V(c).versions,t=>{var f,y,g;return l(),r("div",{key:t.id,class:"card rounded-md px-5 py-4",style:L(n.value.includes(t.id)?"border:1px solid rgba(56,189,248,0.3);":"")},[e("div",pe,[e("button",{onClick:a=>K(t.id),class:"mt-0.5 flex-shrink-0 w-4 h-4 rounded-sm border flex items-center justify-center transition-colors",style:L(n.value.includes(t.id)?"border-color:rgba(56,189,248,0.6);background:rgba(56,189,248,0.15);":"border-color:var(--border-subtle);background:transparent;"),title:n.value.includes(t.id)?"Remove from diff":"Add to diff"},[n.value.includes(t.id)?(l(),r("svg",be,[...o[12]||(o[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)])])):w("",!0)],12,xe),e("div",ve,[e("div",me,[e("span",fe,"#"+i(t.version_number||((f=t.id)==null?void 0:f.slice(0,6))),1),m.value===t.id?(l(),r("div",ye,[C(e("input",{"onUpdate:modelValue":o[5]||(o[5]=a=>_.value=a),class:"px-2 py-0.5 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.04)",border:"1px solid var(--border-subtle)",outline:"none",width:"160px"},onKeyup:[B(a=>$(t.id),["enter"]),o[6]||(o[6]=B(a=>m.value=null,["escape"]))]},null,40,ge),[[z,_.value]]),e("button",{onClick:a=>$(t.id),class:"text-[10px] text-lime-400 font-display tracking-wider uppercase"},"Save",8,ke),e("button",{onClick:o[7]||(o[7]=a=>m.value=null),class:"text-[10px] text-zinc-500 font-display tracking-wider uppercase"},"Cancel")])):t.label?(l(),r("span",{key:1,class:"text-xs font-mono text-zinc-300 cursor-pointer hover:text-zinc-100",onClick:a=>S(t),title:"Click to edit label"},i(t.label),9,_e)):(l(),r("button",{key:2,onClick:a=>S(t),class:"text-[10px] text-zinc-600 hover:text-zinc-400 font-display tracking-wider uppercase"},"+ label",8,he)),e("span",{class:"text-[10px] px-1.5 py-0.5 rounded-sm font-body",style:L(I(t.source))},i(t.source||"manual"),5),e("span",we,i(P(t.created_at)),1)]),e("div",Ce,i((y=t.prompt_text)==null?void 0:y.substring(0,120))+i(((g=t.prompt_text)==null?void 0:g.length)>120?"...":""),1)]),e("div",ze,[e("button",{onClick:a=>U(t),class:"text-[10px] font-display tracking-wider uppercase px-2 py-1 rounded-sm",style:{background:"rgba(168,85,247,0.08)",border:"1px solid rgba(168,85,247,0.2)",color:"#A855F7"},title:"Load into Prompt Tuner"},"Load",8,Ve),e("button",{onClick:a=>E(t.prompt_text),class:"text-[10px] font-display tracking-wider uppercase px-2 py-1 rounded-sm",style:{border:"1px solid var(--border-subtle)",color:"#71717A"},title:"Copy to clipboard"},"Copy",8,Le),e("button",{onClick:a=>N(t),class:"text-[10px] text-zinc-600 hover:text-red-400 transition-colors px-1",title:"Delete version"},[...o[13]||(o[13]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Se)])])],4)}),128))]))]))}};export{Be as default};

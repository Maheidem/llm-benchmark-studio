import{o as U,c as r,d as t,h as n,z as g,F as V,A as P,v as y,P as A,l as D,t as k,f as F,s as b,r as v,Q as J,K as N,b as i}from"./index-DPrAhrhg.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={key:0,class:"text-zinc-600 text-sm font-body"},R={key:1,class:"space-y-6"},q={class:"card rounded-md overflow-hidden"},B={class:"px-5 py-4 space-y-4"},L=["value"],$={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},K={class:"flex items-center gap-3 pt-4"},E={class:"flex items-center gap-2 cursor-pointer"},Q={__name:"JudgePanel",setup(G){const{showToast:w}=N(),_=v(!0),d=v(""),u=v(!0);let f=null;const o=J({default_judge_model:"",default_judge_provider_key:"",default_mode:"post_eval",custom_instructions_template:"",score_override_policy:"always_allow",auto_judge_after_eval:!1,concurrency:4}),j=v([]);async function C(){_.value=!0;try{const e=await(await b("/api/config")).json(),l=[];for(const[s,p]of Object.entries(e.providers||{})){const T=p.provider_key||s,z=Array.isArray(p)?p:p.models||[];for(const m of z){const S=T+"::"+m.model_id;l.push({value:S,label:`${m.display_name||m.model_id} (${s})`})}}j.value=l;const x=await b("/api/settings/judge");if(x.ok){const s=await x.json();o.default_judge_model=s.default_judge_model||"",o.default_judge_provider_key=s.default_judge_provider_key||"",o.default_mode=s.default_mode||"post_eval",o.custom_instructions_template=s.custom_instructions_template||"",o.score_override_policy=s.score_override_policy||"always_allow",o.auto_judge_after_eval=!!s.auto_judge_after_eval,o.concurrency=s.concurrency||4}}catch{w("Failed to load settings","error")}finally{_.value=!1}}function a(){f&&clearTimeout(f),f=setTimeout(M,500)}async function M(){const c={default_judge_model:o.default_judge_model||null,default_judge_provider_key:o.default_judge_provider_key||null,default_mode:o.default_mode,custom_instructions_template:o.custom_instructions_template,score_override_policy:o.score_override_policy,auto_judge_after_eval:o.auto_judge_after_eval,concurrency:parseInt(o.concurrency)||4};try{(await b("/api/settings/judge",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).ok?(d.value="Saved",u.value=!0,setTimeout(()=>{d.value=""},3e3)):(d.value="Failed to save",u.value=!1)}catch{d.value="Network error",u.value=!1}}return U(C),(c,e)=>(i(),r("div",null,[_.value?(i(),r("div",O,"Loading settings...")):(i(),r("div",R,[t("div",q,[e[19]||(e[19]=t("div",{class:"px-5 py-3",style:{"border-bottom":"1px solid var(--border-subtle)"}},[t("span",{class:"section-label"},"Judge Model")],-1)),t("div",B,[t("div",null,[e[8]||(e[8]=t("label",{class:"field-label"},"Default Judge Model",-1)),n(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.default_judge_model=l),onChange:a,class:"settings-select"},[e[7]||(e[7]=t("option",{value:""},"-- Select a model --",-1)),(i(!0),r(V,null,P(j.value,l=>(i(),r("option",{key:l.value,value:l.value},k(l.label),9,L))),128))],544),[[g,o.default_judge_model]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"field-label"},"Default Judge Provider Key",-1)),n(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>o.default_judge_provider_key=l),type:"text",onChange:a,class:"settings-input",placeholder:"e.g. openai, anthropic, lm_studio"},null,544),[[y,o.default_judge_provider_key]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"field-label"},"Default Mode",-1)),n(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.default_mode=l),onChange:a,class:"settings-select"},[...e[10]||(e[10]=[t("option",{value:"post_eval"},"Post-evaluation (after each eval run)",-1),t("option",{value:"live_inline"},"Live inline",-1)])],544),[[g,o.default_mode]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"field-label"},"Score Override Policy",-1)),n(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.score_override_policy=l),onChange:a,class:"settings-select"},[...e[12]||(e[12]=[t("option",{value:"always_allow"},"Always Allow",-1),t("option",{value:"require_confirmation"},"Require Confirmation",-1),t("option",{value:"never"},"Never",-1)])],544),[[g,o.score_override_policy]]),e[14]||(e[14]=t("p",{class:"text-[10px] text-zinc-700 font-body mt-1"},"Controls whether the judge can override automated scores when it detects functional equivalence.",-1))]),t("div",$,[t("div",K,[t("label",E,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=l=>o.auto_judge_after_eval=l),onChange:a,class:"accent-lime-400"},null,544),[[A,o.auto_judge_after_eval]]),e[15]||(e[15]=t("span",{class:"text-xs font-body text-zinc-300"},"Auto-judge after eval",-1))])]),t("div",null,[e[16]||(e[16]=t("label",{class:"field-label"},"Concurrency",-1)),n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.concurrency=l),type:"number",min:"1",max:"20",onChange:a,class:"settings-input"},null,544),[[y,o.concurrency,void 0,{number:!0}]])])]),t("div",null,[e[17]||(e[17]=t("label",{class:"field-label"},"Custom Instructions Template",-1)),e[18]||(e[18]=t("p",{class:"text-[10px] text-zinc-700 font-body mb-2"},"Additional instructions appended to the judge system prompt. Used as default for new judge runs.",-1)),n(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.custom_instructions_template=l),onInput:a,rows:"4",class:"w-full px-3 py-2 rounded-sm text-xs font-mono text-zinc-200",style:{background:"rgba(255,255,255,0.02)",border:"1px solid var(--border-subtle)",outline:"none",resize:"vertical"},placeholder:"e.g. Focus on correctness over style. Penalize hallucinations heavily."},null,544),[[y,o.custom_instructions_template]])])])]),d.value?(i(),r("div",{key:0,class:"text-[11px] font-body",style:D(`color:${u.value?"var(--lime)":"var(--coral)"}`)},k(d.value),5)):F("",!0)]))]))}},X=I(Q,[["__scopeId","data-v-0172893e"]]);export{X as default};

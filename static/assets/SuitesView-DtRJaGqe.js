import{b as d,c as p,d as e,t as x,f as S,F,A as L,r as b,N as J,B as U,h as T,v as D,O as P,l as K,P as O,k as N,g as R,Q as H,K as A,o as Q,y as G,x as W,i as X,q as Y,M as Z}from"./index-DPrAhrhg.js";import{a as q,u as ee}from"./useSharedContext-D76pLMoU.js";const te={class:"card rounded-md overflow-hidden"},se={class:"w-full text-sm results-table"},oe={style:{"border-bottom":"1px solid var(--border-subtle)"}},ne={key:0},le={class:"px-5 py-3"},ae=["onClick"],ie={class:"px-5 py-3 text-center font-mono text-xs text-zinc-500"},re={class:"px-5 py-3 text-center font-mono text-xs text-zinc-500"},ce={class:"px-5 py-3 text-right text-xs text-zinc-600 font-body"},ue={class:"px-5 py-3 text-right"},de={class:"flex items-center justify-end gap-3"},pe=["onClick"],me=["onClick"],ve={__name:"SuiteTable",props:{suites:{type:Array,required:!0}},emits:["select","clone","delete","export"],setup(E){const m=E,y=b("name"),l=b(!0);function g(a){y.value===a?l.value=!l.value:(y.value=a,l.value=a==="name")}const _=U(()=>{const a=[...m.suites];return a.sort((r,i)=>{const c=r[y.value]??"",v=i[y.value]??"";return typeof c=="string"?l.value?c.localeCompare(v):v.localeCompare(c):l.value?c-v:v-c}),a});function C(a){return a?J(a):""}return(a,r)=>(d(),p("div",te,[e("table",se,[e("thead",null,[e("tr",oe,[e("th",{class:"px-5 py-3 text-left section-label cursor-pointer",onClick:r[0]||(r[0]=i=>g("name"))}," Name "+x(y.value==="name"?l.value?"▲":"▼":""),1),e("th",{class:"px-5 py-3 text-center section-label cursor-pointer",onClick:r[1]||(r[1]=i=>g("tool_count"))}," Tools "+x(y.value==="tool_count"?l.value?"▲":"▼":""),1),e("th",{class:"px-5 py-3 text-center section-label cursor-pointer",onClick:r[2]||(r[2]=i=>g("test_case_count"))}," Cases "+x(y.value==="test_case_count"?l.value?"▲":"▼":""),1),r[3]||(r[3]=e("th",{class:"px-5 py-3 text-right section-label"},"Last Updated",-1)),r[4]||(r[4]=e("th",{class:"px-5 py-3 text-right section-label"},null,-1))])]),e("tbody",null,[E.suites.length?S("",!0):(d(),p("tr",ne,[...r[5]||(r[5]=[e("td",{colspan:"5",class:"px-5 py-8 text-center text-zinc-600 text-sm font-body"},' No tool suites yet. Click "New Suite" to create one. ',-1)])])),(d(!0),p(F,null,L(_.value,i=>(d(),p("tr",{key:i.id},[e("td",le,[e("button",{onClick:c=>a.$emit("select",i.id),class:"text-zinc-200 hover:text-white font-body text-sm underline decoration-zinc-700 hover:decoration-zinc-400 transition-colors"},x(i.name||"Untitled"),9,ae)]),e("td",ie,x(i.tool_count||0),1),e("td",re,x(i.test_case_count||0),1),e("td",ce,x(C(i.updated_at)),1),e("td",ue,[e("div",de,[e("button",{onClick:c=>a.$emit("export",i.id),class:"text-zinc-700 hover:text-emerald-400 transition-colors text-xs font-display tracking-wider uppercase"},"Export",8,pe),e("button",{onClick:c=>a.$emit("delete",i.id,i.name),class:"text-zinc-700 hover:text-red-400 transition-colors text-xs font-display tracking-wider uppercase"},"Delete",8,me)])])]))),128))])])]))}},xe={class:"modal-box",style:{"max-width":"640px","max-height":"80vh","overflow-y":"auto"}},fe={class:"flex items-center justify-between mb-4"},be={key:0},ye={class:"mb-3"},he={key:0,class:"text-xs mb-3",style:{color:"var(--coral)"}},ke={key:1,class:"text-xs text-zinc-500 mb-3"},we={class:"modal-buttons"},ge=["disabled"],_e={key:1},Ce={class:"text-xs text-zinc-500 mb-3 font-body"},$e={class:"mb-3"},ze={class:"mb-3"},Se={class:"flex items-center gap-2 mb-3"},Be={class:"space-y-2 mb-4",style:{"max-height":"300px","overflow-y":"auto"}},Me=["onUpdate:modelValue"],Ie={class:"flex-1 min-w-0"},Ne={class:"text-sm text-zinc-200 font-mono"},Ee={class:"text-xs text-zinc-500 mt-0.5"},Ve={key:0,class:"text-xs text-zinc-600 mt-1"},Te={class:"text-zinc-500"},je={class:"text-zinc-700"},De={key:0},Fe={class:"flex items-center gap-2 mb-4 text-xs text-zinc-500 cursor-pointer"},Le={class:"modal-buttons"},Oe=["disabled"],Ue={__name:"McpImportModal",props:{visible:{type:Boolean,default:!1}},emits:["close","imported"],setup(E,{emit:m}){const y=m,l=q(),{showToast:g}=A(),_=b(1),C=b(""),a=b(""),r=b(!1),i=b(""),c=b([]),v=H({}),B=b(""),M=b(""),V=b(!0),I=b(!1),s=U(()=>Object.values(v).filter(Boolean).length);async function o(){const u=C.value.trim();if(!u){a.value="Enter a server URL";return}a.value="",r.value=!0;try{const t=await l.mcpDiscover(u);c.value=t.tools||[],i.value=`Connected to: ${t.server_name} (${t.tool_count} tool${t.tool_count!==1?"s":""} found)`,c.value.forEach((w,j)=>{v[j]=!0});const n=c.value.slice(0,3).map(w=>w.name),z=c.value.length>3?"...":"";B.value=`MCP: ${n.join(", ")}${z}`,M.value=`Imported from MCP server: ${u}`,_.value=2}catch(t){a.value=t.message||"Connection failed"}finally{r.value=!1}}function f(u){c.value.forEach((t,n)=>{v[n]=u})}function h(u){const t=(u.inputSchema||{}).properties||{},n=(u.inputSchema||{}).required||[];return Object.entries(t).map(([z,w])=>({name:z,type:w.type||"?",required:n.includes(z)}))}async function k(){const u=c.value.filter((t,n)=>v[n]);if(!u.length){g("Select at least one tool","error");return}I.value=!0;try{const t=await l.mcpImport({suite_name:B.value.trim(),suite_description:M.value.trim(),tools:u,generate_test_cases:V.value});g(`Imported ${t.tools_imported} tool(s)${t.test_cases_generated?` with ${t.test_cases_generated} test case(s)`:""}`,"success"),y("imported",t.suite_id),y("close"),$()}catch(t){g("Import failed: "+t.message,"error")}finally{I.value=!1}}function $(){_.value=1,C.value="",a.value="",c.value=[],Object.keys(v).forEach(u=>delete v[u]),B.value="",M.value=""}return(u,t)=>E.visible?(d(),p("div",{key:0,class:"modal-overlay",onClick:t[9]||(t[9]=R(n=>u.$emit("close"),["self"]))},[e("div",xe,[e("div",fe,[t[10]||(t[10]=e("div",{class:"modal-title"},"Import from MCP Server",-1)),e("button",{onClick:t[0]||(t[0]=n=>u.$emit("close")),class:"text-zinc-600 hover:text-zinc-400 text-lg"},"×")]),_.value===1?(d(),p("div",be,[t[11]||(t[11]=e("div",{class:"modal-message"},"Enter the URL of an MCP-compatible server to discover available tools.",-1)),e("div",ye,[T(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>C.value=n),class:"modal-input",placeholder:"https://your-server.com/mcp",onKeydown:P(o,["enter"])},null,544),[[D,C.value]])]),a.value?(d(),p("div",he,x(a.value),1)):S("",!0),r.value?(d(),p("div",ke,"Connecting...")):S("",!0),e("div",we,[e("button",{onClick:t[2]||(t[2]=n=>u.$emit("close")),class:"modal-btn modal-btn-cancel"},"Cancel"),e("button",{onClick:o,disabled:r.value,class:"modal-btn modal-btn-confirm"},x(r.value?"Connecting...":"Connect"),9,ge)])])):S("",!0),_.value===2?(d(),p("div",_e,[e("div",Ce,x(i.value),1),e("div",$e,[t[12]||(t[12]=e("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Suite Name",-1)),T(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>B.value=n),class:"modal-input",style:{"margin-bottom":"8px"}},null,512),[[D,B.value]])]),e("div",ze,[t[13]||(t[13]=e("label",{class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 mb-1 block"},"Description",-1)),T(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>M.value=n),class:"modal-input",style:{"margin-bottom":"8px"}},null,512),[[D,M.value]])]),e("div",Se,[e("button",{onClick:t[5]||(t[5]=n=>f(!0)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Select All"),e("button",{onClick:t[6]||(t[6]=n=>f(!1)),class:"text-[10px] font-display tracking-wider uppercase text-zinc-500 hover:text-zinc-300"},"Deselect All")]),e("div",Be,[(d(!0),p(F,null,L(c.value,(n,z)=>(d(),p("label",{key:z,class:"flex gap-3 p-3 rounded cursor-pointer",style:K([{border:"1px solid var(--border-subtle)"},{background:v[z]?"rgba(191,255,0,0.04)":"transparent"}])},[T(e("input",{type:"checkbox","onUpdate:modelValue":w=>v[z]=w,class:"mt-1 accent-lime-400"},null,8,Me),[[O,v[z]]]),e("div",Ie,[e("div",Ne,x(n.name),1),e("div",Ee,x(n.description),1),h(n).length?(d(),p("div",Ve,[t[14]||(t[14]=N(" Params: ",-1)),(d(!0),p(F,null,L(h(n),(w,j)=>(d(),p("span",{key:j},[e("span",Te,x(w.name),1),e("span",je," ("+x(w.type)+x(w.required?", required":", optional")+")",1),j<h(n).length-1?(d(),p("span",De,", ")):S("",!0)]))),128))])):S("",!0)])],4))),128))]),e("label",Fe,[T(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=n=>V.value=n),class:"accent-lime-400"},null,512),[[O,V.value]]),t[15]||(t[15]=e("span",null,"Auto-generate test cases",-1))]),e("div",Le,[e("button",{onClick:t[8]||(t[8]=n=>_.value=1),class:"modal-btn modal-btn-cancel"},"Back"),e("button",{onClick:k,disabled:I.value||s.value===0,class:"modal-btn modal-btn-confirm"},x(I.value?"Importing...":`Import ${s.value} Tool${s.value!==1?"s":""}`),9,Oe)])])):S("",!0)])])):S("",!0)}},Ae={class:"flex items-center justify-between mb-6"},qe={class:"flex items-center gap-2 flex-wrap"},Je={key:0,class:"text-center text-zinc-600 text-sm font-body py-8"},Re={__name:"SuitesView",setup(E){const m=q(),y=Y(),{showToast:l}=A(),{confirm:g}=Z(),{setSuite:_}=ee(),C=b(!0),a=b(!1);Q(async()=>{try{await m.loadSuites()}catch{l("Failed to load suites","error")}finally{C.value=!1}});async function r(){try{const s=await m.createSuite({name:"New Suite",description:"",tools:[]});l("Suite created","success"),i(s.suite_id)}catch(s){l(s.message||"Failed to create suite","error")}}function i(s){const o=m.suites.find(f=>f.id===s);o&&_(s,o.name),y.push({name:"ToolEvalEditor",params:{id:s}})}async function c(s){try{await m.exportSuite(s),l("Suite exported","success")}catch{l("Failed to export suite","error")}}async function v(s,o){if(await g("Delete Suite",`Delete "${o}" and all its test cases? This cannot be undone.`,{danger:!0,confirmLabel:"Delete"}))try{await m.deleteSuite(s),l("Suite deleted","success")}catch{l("Failed to delete","error")}}function B(){const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=async o=>{const f=o.target.files[0];if(f)try{const h=await f.text(),k=JSON.parse(h);if(!k.name||typeof k.name!="string"){l('Invalid JSON: missing "name" field',"error");return}const $=await m.importSuite(k);l(`Imported "${k.name}" with ${$.test_cases_created} test cases`,"success"),await m.loadSuites(),i($.suite_id)}catch(h){l("Failed to import: "+(h.message||"invalid JSON"),"error")}},s.click()}function M(){const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=async o=>{const f=o.target.files[0];if(f)try{const h=await f.text(),k=JSON.parse(h),$=Array.isArray(k)?k:[k];if(!$.length||!$[0].function&&!$[0].question){l('Invalid BFCL format: expected "function" and "question" fields',"error");return}const u=f.name.replace(/\.json$/i,""),t=await m.importBfclSuite($,u);l(`Imported BFCL suite with ${t.test_cases_created} test cases`,"success"),await m.loadSuites(),i(t.suite_id)}catch(h){l("Failed to import BFCL: "+(h.message||"invalid JSON"),"error")}},s.click()}async function V(){try{await m.downloadImportExample()}catch{l("Failed to download example","error")}}async function I(s){await m.loadSuites(),i(s)}return(s,o)=>(d(),p("div",null,[e("div",Ae,[o[7]||(o[7]=e("div",null,[e("h2",{class:"font-display font-bold text-lg text-zinc-100 mb-1"},"Tool Calling Evaluation"),e("p",{class:"text-sm text-zinc-600 font-body"},"Define tool suites, create test cases, and evaluate model accuracy.")],-1)),e("div",qe,[e("button",{onClick:r,class:"run-btn px-4 py-2 rounded-sm text-xs whitespace-nowrap flex items-center gap-2"},[...o[2]||(o[2]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2.5",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),N(" New Suite ",-1)])]),e("button",{onClick:B,class:"px-4 py-2 rounded-sm text-xs font-display whitespace-nowrap flex items-center gap-2 border border-zinc-700 text-zinc-400 hover:text-zinc-200 hover:border-zinc-500 transition-colors"},[...o[3]||(o[3]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),N(" Import Suite ",-1)])]),e("button",{onClick:M,class:"px-4 py-2 rounded-sm text-xs font-display whitespace-nowrap flex items-center gap-2 border border-zinc-700 text-zinc-400 hover:text-zinc-200 hover:border-zinc-500 transition-colors"},[...o[4]||(o[4]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),N(" Import BFCL ",-1)])]),e("button",{onClick:V,class:"px-4 py-2 rounded-sm text-xs font-display whitespace-nowrap flex items-center gap-2 border border-zinc-700 text-zinc-500 hover:text-zinc-300 hover:border-zinc-500 transition-colors",title:"Download example JSON template for import"},[...o[5]||(o[5]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),N(" Example JSON ",-1)])]),e("button",{onClick:o[0]||(o[0]=f=>a.value=!0),class:"px-4 py-2 rounded-sm text-xs font-display whitespace-nowrap flex items-center gap-2 border border-zinc-700 text-zinc-400 hover:text-zinc-200 hover:border-zinc-500 transition-colors"},[...o[6]||(o[6]=[e("svg",{class:"w-3.5 h-3.5 shrink-0",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),N(" Import from MCP ",-1)])])])]),C.value?(d(),p("div",Je,"Loading suites...")):(d(),G(ve,{key:1,suites:W(m).suites,onSelect:i,onExport:c,onDelete:v},null,8,["suites"])),X(Ue,{visible:a.value,onClose:o[1]||(o[1]=f=>a.value=!1),onImported:I},null,8,["visible"])]))}};export{Re as default};
